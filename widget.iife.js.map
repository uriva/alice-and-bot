{"version":3,"file":"widget.iife.js","sources":["../../node_modules/.deno/preact@10.26.7/node_modules/preact/dist/preact.module.js","../../node_modules/.deno/preact@10.26.7/node_modules/preact/jsx-runtime/dist/jsxRuntime.module.js","../../node_modules/.deno/preact@10.26.7/node_modules/preact/hooks/dist/hooks.module.js","../../node_modules/.deno/@instantdb+core@0.19.5/node_modules/@instantdb/core/dist/esm/utils/weakHash.js","../../node_modules/.deno/mutative@1.2.0/node_modules/mutative/dist/mutative.esm.mjs","../../node_modules/.deno/@instantdb+core@0.19.5/node_modules/@instantdb/core/dist/esm/utils/object.js","../../node_modules/.deno/@instantdb+core@0.19.5/node_modules/@instantdb/core/dist/esm/store.js","../../node_modules/.deno/@instantdb+core@0.19.5/node_modules/@instantdb/core/dist/esm/datalog.js","../../node_modules/.deno/uuid@9.0.1/node_modules/uuid/dist/esm-browser/rng.js","../../node_modules/.deno/uuid@9.0.1/node_modules/uuid/dist/esm-browser/stringify.js","../../node_modules/.deno/uuid@9.0.1/node_modules/uuid/dist/esm-browser/native.js","../../node_modules/.deno/uuid@9.0.1/node_modules/uuid/dist/esm-browser/v4.js","../../node_modules/.deno/@instantdb+core@0.19.5/node_modules/@instantdb/core/dist/esm/utils/uuid.js","../../node_modules/.deno/@instantdb+core@0.19.5/node_modules/@instantdb/core/dist/esm/instaql.js","../../node_modules/.deno/@instantdb+core@0.19.5/node_modules/@instantdb/core/dist/esm/instatx.js","../../node_modules/.deno/@instantdb+core@0.19.5/node_modules/@instantdb/core/dist/esm/instaml.js","../../node_modules/.deno/@instantdb+core@0.19.5/node_modules/@instantdb/core/dist/esm/IndexedDBStorage.js","../../node_modules/.deno/@instantdb+core@0.19.5/node_modules/@instantdb/core/dist/esm/WindowNetworkListener.js","../../node_modules/.deno/@instantdb+core@0.19.5/node_modules/@instantdb/core/dist/esm/utils/fetch.js","../../node_modules/.deno/@instantdb+core@0.19.5/node_modules/@instantdb/core/dist/esm/authAPI.js","../../node_modules/.deno/@instantdb+core@0.19.5/node_modules/@instantdb/core/dist/esm/StorageAPI.js","../../node_modules/.deno/@instantdb+core@0.19.5/node_modules/@instantdb/core/dist/esm/utils/flags.js","../../node_modules/.deno/@instantdb+core@0.19.5/node_modules/@instantdb/core/dist/esm/utils/pick.js","../../node_modules/.deno/@instantdb+core@0.19.5/node_modules/@instantdb/core/dist/esm/presence.js","../../node_modules/.deno/@instantdb+core@0.19.5/node_modules/@instantdb/core/dist/esm/utils/Deferred.js","../../node_modules/.deno/@instantdb+core@0.19.5/node_modules/@instantdb/core/dist/esm/utils/PersistedObject.js","../../node_modules/.deno/@instantdb+core@0.19.5/node_modules/@instantdb/core/dist/esm/model/instaqlResult.js","../../node_modules/.deno/@instantdb+core@0.19.5/node_modules/@instantdb/core/dist/esm/utils/linkIndex.js","../../node_modules/.deno/@instantdb+core@0.19.5/node_modules/@instantdb/core/dist/esm/version.js","../../node_modules/.deno/@instantdb+core@0.19.5/node_modules/@instantdb/core/dist/esm/utils/log.js","../../node_modules/.deno/@instantdb+core@0.19.5/node_modules/@instantdb/core/dist/esm/Reactor.js","../../node_modules/.deno/@instantdb+core@0.19.5/node_modules/@instantdb/core/dist/esm/schemaTypes.js","../../node_modules/.deno/@instantdb+core@0.19.5/node_modules/@instantdb/core/dist/esm/schema.js","../../node_modules/.deno/@instantdb+core@0.19.5/node_modules/@instantdb/core/dist/esm/devtool.js","../../node_modules/.deno/@instantdb+core@0.19.5/node_modules/@instantdb/core/dist/esm/index.js","../../node_modules/.deno/preact@10.26.7/node_modules/preact/compat/dist/compat.module.js","../../node_modules/.deno/@instantdb+react@0.19.5/node_modules/@instantdb/react/dist/esm/useQuery.js","../../node_modules/.deno/@instantdb+react@0.19.5/node_modules/@instantdb/react/dist/esm/useTimeout.js","../../node_modules/.deno/@instantdb+react@0.19.5/node_modules/@instantdb/react/dist/esm/InstantReactRoom.js","../../node_modules/.deno/@instantdb+react@0.19.5/node_modules/@instantdb/react/dist/esm/InstantReactAbstractDatabase.js","../../node_modules/.deno/@instantdb+react@0.19.5/node_modules/@instantdb/react/dist/esm/InstantReactWebDatabase.js","../../node_modules/.deno/@instantdb+react@0.19.5/node_modules/@instantdb/react/dist/esm/version.js","../../node_modules/.deno/@instantdb+react@0.19.5/node_modules/@instantdb/react/dist/esm/init.js","../../node_modules/.deno/zod@3.22.4/node_modules/zod/lib/index.mjs","../../backend/src/api.ts","../../clients/react/src/hooks.ts","../../node_modules/.deno/gamla@124.0.0/node_modules/gamla/esm/src/promise.js","../../node_modules/.deno/gamla@124.0.0/node_modules/gamla/esm/src/array.js","../../node_modules/.deno/gamla@124.0.0/node_modules/gamla/esm/src/reduce.js","../../node_modules/.deno/gamla@124.0.0/node_modules/gamla/esm/src/trace.js","../../node_modules/.deno/gamla@124.0.0/node_modules/gamla/esm/src/composition.js","../../node_modules/.deno/gamla@124.0.0/node_modules/gamla/esm/src/map.js","../../node_modules/.deno/gamla@124.0.0/node_modules/gamla/esm/src/juxt.js","../../node_modules/.deno/gamla@124.0.0/node_modules/gamla/esm/src/filter.js","../../node_modules/.deno/gamla@124.0.0/node_modules/gamla/esm/deps/jsr.io/@noble/hashes/1.7.2/src/utils.js","../../node_modules/.deno/gamla@124.0.0/node_modules/gamla/esm/deps/jsr.io/@std/encoding/1.0.9/_common16.js","../../node_modules/.deno/gamla@124.0.0/node_modules/gamla/esm/deps/jsr.io/@std/encoding/1.0.9/hex.js","../../node_modules/.deno/gamla@124.0.0/node_modules/gamla/esm/src/mapping.js","../../node_modules/.deno/safe-stable-stringify@2.5.0/node_modules/safe-stable-stringify/index.js","../../node_modules/.deno/safe-stable-stringify@2.5.0/node_modules/safe-stable-stringify/esm/wrapper.js","../../node_modules/.deno/base64-js@1.5.1/node_modules/base64-js/index.js","../../node_modules/.deno/ieee754@1.2.1/node_modules/ieee754/index.js","../../node_modules/.deno/buffer@6.0.3/node_modules/buffer/index.js","../../protocol/src/crypto.ts","../../protocol/src/api.ts","../../clients/react/src/design.tsx","../../clients/react/src/abstractChatBox.tsx","../../clients/react/src/main.tsx","../../instant.schema.ts","../../mod.ts","../src/widget.tsx","../src/entry.tsx"],"sourcesContent":["var n,l,u,t,i,r,o,e,f,c,s,a,h,p={},y=[],v=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,w=Array.isArray;function d(n,l){for(var u in l)n[u]=l[u];return n}function g(n){n&&n.parentNode&&n.parentNode.removeChild(n)}function _(l,u,t){var i,r,o,e={};for(o in u)\"key\"==o?i=u[o]:\"ref\"==o?r=u[o]:e[o]=u[o];if(arguments.length>2&&(e.children=arguments.length>3?n.call(arguments,2):t),\"function\"==typeof l&&null!=l.defaultProps)for(o in l.defaultProps)null==e[o]&&(e[o]=l.defaultProps[o]);return m(l,e,i,r,null)}function m(n,t,i,r,o){var e={type:n,props:t,key:i,ref:r,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:null==o?++u:o,__i:-1,__u:0};return null==o&&null!=l.vnode&&l.vnode(e),e}function b(){return{current:null}}function k(n){return n.children}function x(n,l){this.props=n,this.context=l}function S(n,l){if(null==l)return n.__?S(n.__,n.__i+1):null;for(var u;l<n.__k.length;l++)if(null!=(u=n.__k[l])&&null!=u.__e)return u.__e;return\"function\"==typeof n.type?S(n):null}function C(n){var l,u;if(null!=(n=n.__)&&null!=n.__c){for(n.__e=n.__c.base=null,l=0;l<n.__k.length;l++)if(null!=(u=n.__k[l])&&null!=u.__e){n.__e=n.__c.base=u.__e;break}return C(n)}}function M(n){(!n.__d&&(n.__d=!0)&&i.push(n)&&!$.__r++||r!=l.debounceRendering)&&((r=l.debounceRendering)||o)($)}function $(){for(var n,u,t,r,o,f,c,s=1;i.length;)i.length>s&&i.sort(e),n=i.shift(),s=i.length,n.__d&&(t=void 0,o=(r=(u=n).__v).__e,f=[],c=[],u.__P&&((t=d({},r)).__v=r.__v+1,l.vnode&&l.vnode(t),O(u.__P,t,r,u.__n,u.__P.namespaceURI,32&r.__u?[o]:null,f,null==o?S(r):o,!!(32&r.__u),c),t.__v=r.__v,t.__.__k[t.__i]=t,z(f,t,c),t.__e!=o&&C(t)));$.__r=0}function I(n,l,u,t,i,r,o,e,f,c,s){var a,h,v,w,d,g,_=t&&t.__k||y,m=l.length;for(f=P(u,l,_,f,m),a=0;a<m;a++)null!=(v=u.__k[a])&&(h=-1==v.__i?p:_[v.__i]||p,v.__i=a,g=O(n,v,h,i,r,o,e,f,c,s),w=v.__e,v.ref&&h.ref!=v.ref&&(h.ref&&q(h.ref,null,v),s.push(v.ref,v.__c||w,v)),null==d&&null!=w&&(d=w),4&v.__u||h.__k===v.__k?f=A(v,f,n):\"function\"==typeof v.type&&void 0!==g?f=g:w&&(f=w.nextSibling),v.__u&=-7);return u.__e=d,f}function P(n,l,u,t,i){var r,o,e,f,c,s=u.length,a=s,h=0;for(n.__k=new Array(i),r=0;r<i;r++)null!=(o=l[r])&&\"boolean\"!=typeof o&&\"function\"!=typeof o?(f=r+h,(o=n.__k[r]=\"string\"==typeof o||\"number\"==typeof o||\"bigint\"==typeof o||o.constructor==String?m(null,o,null,null,null):w(o)?m(k,{children:o},null,null,null):null==o.constructor&&o.__b>0?m(o.type,o.props,o.key,o.ref?o.ref:null,o.__v):o).__=n,o.__b=n.__b+1,e=null,-1!=(c=o.__i=L(o,u,f,a))&&(a--,(e=u[c])&&(e.__u|=2)),null==e||null==e.__v?(-1==c&&(i>s?h--:i<s&&h++),\"function\"!=typeof o.type&&(o.__u|=4)):c!=f&&(c==f-1?h--:c==f+1?h++:(c>f?h--:h++,o.__u|=4))):n.__k[r]=null;if(a)for(r=0;r<s;r++)null!=(e=u[r])&&0==(2&e.__u)&&(e.__e==t&&(t=S(e)),B(e,e));return t}function A(n,l,u){var t,i;if(\"function\"==typeof n.type){for(t=n.__k,i=0;t&&i<t.length;i++)t[i]&&(t[i].__=n,l=A(t[i],l,u));return l}n.__e!=l&&(l&&n.type&&!u.contains(l)&&(l=S(n)),u.insertBefore(n.__e,l||null),l=n.__e);do{l=l&&l.nextSibling}while(null!=l&&8==l.nodeType);return l}function H(n,l){return l=l||[],null==n||\"boolean\"==typeof n||(w(n)?n.some(function(n){H(n,l)}):l.push(n)),l}function L(n,l,u,t){var i,r,o=n.key,e=n.type,f=l[u];if(null===f&&null==n.key||f&&o==f.key&&e==f.type&&0==(2&f.__u))return u;if(t>(null!=f&&0==(2&f.__u)?1:0))for(i=u-1,r=u+1;i>=0||r<l.length;){if(i>=0){if((f=l[i])&&0==(2&f.__u)&&o==f.key&&e==f.type)return i;i--}if(r<l.length){if((f=l[r])&&0==(2&f.__u)&&o==f.key&&e==f.type)return r;r++}}return-1}function T(n,l,u){\"-\"==l[0]?n.setProperty(l,null==u?\"\":u):n[l]=null==u?\"\":\"number\"!=typeof u||v.test(l)?u:u+\"px\"}function j(n,l,u,t,i){var r,o;n:if(\"style\"==l)if(\"string\"==typeof u)n.style.cssText=u;else{if(\"string\"==typeof t&&(n.style.cssText=t=\"\"),t)for(l in t)u&&l in u||T(n.style,l,\"\");if(u)for(l in u)t&&u[l]==t[l]||T(n.style,l,u[l])}else if(\"o\"==l[0]&&\"n\"==l[1])r=l!=(l=l.replace(f,\"$1\")),o=l.toLowerCase(),l=o in n||\"onFocusOut\"==l||\"onFocusIn\"==l?o.slice(2):l.slice(2),n.l||(n.l={}),n.l[l+r]=u,u?t?u.u=t.u:(u.u=c,n.addEventListener(l,r?a:s,r)):n.removeEventListener(l,r?a:s,r);else{if(\"http://www.w3.org/2000/svg\"==i)l=l.replace(/xlink(H|:h)/,\"h\").replace(/sName$/,\"s\");else if(\"width\"!=l&&\"height\"!=l&&\"href\"!=l&&\"list\"!=l&&\"form\"!=l&&\"tabIndex\"!=l&&\"download\"!=l&&\"rowSpan\"!=l&&\"colSpan\"!=l&&\"role\"!=l&&\"popover\"!=l&&l in n)try{n[l]=null==u?\"\":u;break n}catch(n){}\"function\"==typeof u||(null==u||!1===u&&\"-\"!=l[4]?n.removeAttribute(l):n.setAttribute(l,\"popover\"==l&&1==u?\"\":u))}}function F(n){return function(u){if(this.l){var t=this.l[u.type+n];if(null==u.t)u.t=c++;else if(u.t<t.u)return;return t(l.event?l.event(u):u)}}}function O(n,u,t,i,r,o,e,f,c,s){var a,h,p,y,v,_,m,b,S,C,M,$,P,A,H,L,T,j=u.type;if(null!=u.constructor)return null;128&t.__u&&(c=!!(32&t.__u),o=[f=u.__e=t.__e]),(a=l.__b)&&a(u);n:if(\"function\"==typeof j)try{if(b=u.props,S=\"prototype\"in j&&j.prototype.render,C=(a=j.contextType)&&i[a.__c],M=a?C?C.props.value:a.__:i,t.__c?m=(h=u.__c=t.__c).__=h.__E:(S?u.__c=h=new j(b,M):(u.__c=h=new x(b,M),h.constructor=j,h.render=D),C&&C.sub(h),h.props=b,h.state||(h.state={}),h.context=M,h.__n=i,p=h.__d=!0,h.__h=[],h._sb=[]),S&&null==h.__s&&(h.__s=h.state),S&&null!=j.getDerivedStateFromProps&&(h.__s==h.state&&(h.__s=d({},h.__s)),d(h.__s,j.getDerivedStateFromProps(b,h.__s))),y=h.props,v=h.state,h.__v=u,p)S&&null==j.getDerivedStateFromProps&&null!=h.componentWillMount&&h.componentWillMount(),S&&null!=h.componentDidMount&&h.__h.push(h.componentDidMount);else{if(S&&null==j.getDerivedStateFromProps&&b!==y&&null!=h.componentWillReceiveProps&&h.componentWillReceiveProps(b,M),!h.__e&&null!=h.shouldComponentUpdate&&!1===h.shouldComponentUpdate(b,h.__s,M)||u.__v==t.__v){for(u.__v!=t.__v&&(h.props=b,h.state=h.__s,h.__d=!1),u.__e=t.__e,u.__k=t.__k,u.__k.some(function(n){n&&(n.__=u)}),$=0;$<h._sb.length;$++)h.__h.push(h._sb[$]);h._sb=[],h.__h.length&&e.push(h);break n}null!=h.componentWillUpdate&&h.componentWillUpdate(b,h.__s,M),S&&null!=h.componentDidUpdate&&h.__h.push(function(){h.componentDidUpdate(y,v,_)})}if(h.context=M,h.props=b,h.__P=n,h.__e=!1,P=l.__r,A=0,S){for(h.state=h.__s,h.__d=!1,P&&P(u),a=h.render(h.props,h.state,h.context),H=0;H<h._sb.length;H++)h.__h.push(h._sb[H]);h._sb=[]}else do{h.__d=!1,P&&P(u),a=h.render(h.props,h.state,h.context),h.state=h.__s}while(h.__d&&++A<25);h.state=h.__s,null!=h.getChildContext&&(i=d(d({},i),h.getChildContext())),S&&!p&&null!=h.getSnapshotBeforeUpdate&&(_=h.getSnapshotBeforeUpdate(y,v)),L=a,null!=a&&a.type===k&&null==a.key&&(L=N(a.props.children)),f=I(n,w(L)?L:[L],u,t,i,r,o,e,f,c,s),h.base=u.__e,u.__u&=-161,h.__h.length&&e.push(h),m&&(h.__E=h.__=null)}catch(n){if(u.__v=null,c||null!=o)if(n.then){for(u.__u|=c?160:128;f&&8==f.nodeType&&f.nextSibling;)f=f.nextSibling;o[o.indexOf(f)]=null,u.__e=f}else for(T=o.length;T--;)g(o[T]);else u.__e=t.__e,u.__k=t.__k;l.__e(n,u,t)}else null==o&&u.__v==t.__v?(u.__k=t.__k,u.__e=t.__e):f=u.__e=V(t.__e,u,t,i,r,o,e,c,s);return(a=l.diffed)&&a(u),128&u.__u?void 0:f}function z(n,u,t){for(var i=0;i<t.length;i++)q(t[i],t[++i],t[++i]);l.__c&&l.__c(u,n),n.some(function(u){try{n=u.__h,u.__h=[],n.some(function(n){n.call(u)})}catch(n){l.__e(n,u.__v)}})}function N(n){return\"object\"!=typeof n||null==n||n.__b&&n.__b>0?n:w(n)?n.map(N):d({},n)}function V(u,t,i,r,o,e,f,c,s){var a,h,y,v,d,_,m,b=i.props,k=t.props,x=t.type;if(\"svg\"==x?o=\"http://www.w3.org/2000/svg\":\"math\"==x?o=\"http://www.w3.org/1998/Math/MathML\":o||(o=\"http://www.w3.org/1999/xhtml\"),null!=e)for(a=0;a<e.length;a++)if((d=e[a])&&\"setAttribute\"in d==!!x&&(x?d.localName==x:3==d.nodeType)){u=d,e[a]=null;break}if(null==u){if(null==x)return document.createTextNode(k);u=document.createElementNS(o,x,k.is&&k),c&&(l.__m&&l.__m(t,e),c=!1),e=null}if(null==x)b===k||c&&u.data==k||(u.data=k);else{if(e=e&&n.call(u.childNodes),b=i.props||p,!c&&null!=e)for(b={},a=0;a<u.attributes.length;a++)b[(d=u.attributes[a]).name]=d.value;for(a in b)if(d=b[a],\"children\"==a);else if(\"dangerouslySetInnerHTML\"==a)y=d;else if(!(a in k)){if(\"value\"==a&&\"defaultValue\"in k||\"checked\"==a&&\"defaultChecked\"in k)continue;j(u,a,null,d,o)}for(a in k)d=k[a],\"children\"==a?v=d:\"dangerouslySetInnerHTML\"==a?h=d:\"value\"==a?_=d:\"checked\"==a?m=d:c&&\"function\"!=typeof d||b[a]===d||j(u,a,d,b[a],o);if(h)c||y&&(h.__html==y.__html||h.__html==u.innerHTML)||(u.innerHTML=h.__html),t.__k=[];else if(y&&(u.innerHTML=\"\"),I(\"template\"==t.type?u.content:u,w(v)?v:[v],t,i,r,\"foreignObject\"==x?\"http://www.w3.org/1999/xhtml\":o,e,f,e?e[0]:i.__k&&S(i,0),c,s),null!=e)for(a=e.length;a--;)g(e[a]);c||(a=\"value\",\"progress\"==x&&null==_?u.removeAttribute(\"value\"):null!=_&&(_!==u[a]||\"progress\"==x&&!_||\"option\"==x&&_!=b[a])&&j(u,a,_,b[a],o),a=\"checked\",null!=m&&m!=u[a]&&j(u,a,m,b[a],o))}return u}function q(n,u,t){try{if(\"function\"==typeof n){var i=\"function\"==typeof n.__u;i&&n.__u(),i&&null==u||(n.__u=n(u))}else n.current=u}catch(n){l.__e(n,t)}}function B(n,u,t){var i,r;if(l.unmount&&l.unmount(n),(i=n.ref)&&(i.current&&i.current!=n.__e||q(i,null,u)),null!=(i=n.__c)){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(n){l.__e(n,u)}i.base=i.__P=null}if(i=n.__k)for(r=0;r<i.length;r++)i[r]&&B(i[r],u,t||\"function\"!=typeof n.type);t||g(n.__e),n.__c=n.__=n.__e=void 0}function D(n,l,u){return this.constructor(n,u)}function E(u,t,i){var r,o,e,f;t==document&&(t=document.documentElement),l.__&&l.__(u,t),o=(r=\"function\"==typeof i)?null:i&&i.__k||t.__k,e=[],f=[],O(t,u=(!r&&i||t).__k=_(k,null,[u]),o||p,p,t.namespaceURI,!r&&i?[i]:o?null:t.firstChild?n.call(t.childNodes):null,e,!r&&i?i:o?o.__e:t.firstChild,r,f),z(e,u,f)}function G(n,l){E(n,l,G)}function J(l,u,t){var i,r,o,e,f=d({},l.props);for(o in l.type&&l.type.defaultProps&&(e=l.type.defaultProps),u)\"key\"==o?i=u[o]:\"ref\"==o?r=u[o]:f[o]=null==u[o]&&null!=e?e[o]:u[o];return arguments.length>2&&(f.children=arguments.length>3?n.call(arguments,2):t),m(l.type,f,i||l.key,r||l.ref,null)}function K(n){function l(n){var u,t;return this.getChildContext||(u=new Set,(t={})[l.__c]=this,this.getChildContext=function(){return t},this.componentWillUnmount=function(){u=null},this.shouldComponentUpdate=function(n){this.props.value!=n.value&&u.forEach(function(n){n.__e=!0,M(n)})},this.sub=function(n){u.add(n);var l=n.componentWillUnmount;n.componentWillUnmount=function(){u&&u.delete(n),l&&l.call(n)}}),n.children}return l.__c=\"__cC\"+h++,l.__=n,l.Provider=l.__l=(l.Consumer=function(n,l){return n.children(l)}).contextType=l,l}n=y.slice,l={__e:function(n,l,u,t){for(var i,r,o;l=l.__;)if((i=l.__c)&&!i.__)try{if((r=i.constructor)&&null!=r.getDerivedStateFromError&&(i.setState(r.getDerivedStateFromError(n)),o=i.__d),null!=i.componentDidCatch&&(i.componentDidCatch(n,t||{}),o=i.__d),o)return i.__E=i}catch(l){n=l}throw n}},u=0,t=function(n){return null!=n&&null==n.constructor},x.prototype.setState=function(n,l){var u;u=null!=this.__s&&this.__s!=this.state?this.__s:this.__s=d({},this.state),\"function\"==typeof n&&(n=n(d({},u),this.props)),n&&d(u,n),null!=n&&this.__v&&(l&&this._sb.push(l),M(this))},x.prototype.forceUpdate=function(n){this.__v&&(this.__e=!0,n&&this.__h.push(n),M(this))},x.prototype.render=k,i=[],o=\"function\"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,e=function(n,l){return n.__v.__b-l.__v.__b},$.__r=0,f=/(PointerCapture)$|Capture$/i,c=0,s=F(!1),a=F(!0),h=0;export{x as Component,k as Fragment,J as cloneElement,K as createContext,_ as createElement,b as createRef,_ as h,G as hydrate,t as isValidElement,l as options,E as render,H as toChildArray};\n//# sourceMappingURL=preact.module.js.map\n","import{options as r,Fragment as e}from\"preact\";export{Fragment}from\"preact\";var t=/[\"&<]/;function n(r){if(0===r.length||!1===t.test(r))return r;for(var e=0,n=0,o=\"\",f=\"\";n<r.length;n++){switch(r.charCodeAt(n)){case 34:f=\"&quot;\";break;case 38:f=\"&amp;\";break;case 60:f=\"&lt;\";break;default:continue}n!==e&&(o+=r.slice(e,n)),o+=f,e=n+1}return n!==e&&(o+=r.slice(e,n)),o}var o=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,f=0,i=Array.isArray;function u(e,t,n,o,i,u){t||(t={});var a,c,p=t;if(\"ref\"in p)for(c in p={},t)\"ref\"==c?a=t[c]:p[c]=t[c];var l={type:e,props:p,key:n,ref:a,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--f,__i:-1,__u:0,__source:i,__self:u};if(\"function\"==typeof e&&(a=e.defaultProps))for(c in a)void 0===p[c]&&(p[c]=a[c]);return r.vnode&&r.vnode(l),l}function a(r){var t=u(e,{tpl:r,exprs:[].slice.call(arguments,1)});return t.key=t.__v,t}var c={},p=/[A-Z]/g;function l(e,t){if(r.attr){var f=r.attr(e,t);if(\"string\"==typeof f)return f}if(\"ref\"===e||\"key\"===e)return\"\";if(\"style\"===e&&\"object\"==typeof t){var i=\"\";for(var u in t){var a=t[u];if(null!=a&&\"\"!==a){var l=\"-\"==u[0]?u:c[u]||(c[u]=u.replace(p,\"-$&\").toLowerCase()),s=\";\";\"number\"!=typeof a||l.startsWith(\"--\")||o.test(l)||(s=\"px;\"),i=i+l+\":\"+a+s}}return e+'=\"'+i+'\"'}return null==t||!1===t||\"function\"==typeof t||\"object\"==typeof t?\"\":!0===t?e:e+'=\"'+n(t)+'\"'}function s(r){if(null==r||\"boolean\"==typeof r||\"function\"==typeof r)return null;if(\"object\"==typeof r){if(void 0===r.constructor)return r;if(i(r)){for(var e=0;e<r.length;e++)r[e]=s(r[e]);return r}}return n(\"\"+r)}export{u as jsx,l as jsxAttr,u as jsxDEV,s as jsxEscape,a as jsxTemplate,u as jsxs};\n//# sourceMappingURL=jsxRuntime.module.js.map\n","import{options as n}from\"preact\";var t,r,u,i,o=0,f=[],c=n,e=c.__b,a=c.__r,v=c.diffed,l=c.__c,m=c.unmount,s=c.__;function p(n,t){c.__h&&c.__h(r,n,o||t),o=0;var u=r.__H||(r.__H={__:[],__h:[]});return n>=u.__.length&&u.__.push({}),u.__[n]}function d(n){return o=1,h(D,n)}function h(n,u,i){var o=p(t++,2);if(o.t=n,!o.__c&&(o.__=[i?i(u):D(void 0,u),function(n){var t=o.__N?o.__N[0]:o.__[0],r=o.t(t,n);t!==r&&(o.__N=[r,o.__[1]],o.__c.setState({}))}],o.__c=r,!r.__f)){var f=function(n,t,r){if(!o.__c.__H)return!0;var u=o.__c.__H.__.filter(function(n){return!!n.__c});if(u.every(function(n){return!n.__N}))return!c||c.call(this,n,t,r);var i=o.__c.props!==n;return u.forEach(function(n){if(n.__N){var t=n.__[0];n.__=n.__N,n.__N=void 0,t!==n.__[0]&&(i=!0)}}),c&&c.call(this,n,t,r)||i};r.__f=!0;var c=r.shouldComponentUpdate,e=r.componentWillUpdate;r.componentWillUpdate=function(n,t,r){if(this.__e){var u=c;c=void 0,f(n,t,r),c=u}e&&e.call(this,n,t,r)},r.shouldComponentUpdate=f}return o.__N||o.__}function y(n,u){var i=p(t++,3);!c.__s&&C(i.__H,u)&&(i.__=n,i.u=u,r.__H.__h.push(i))}function _(n,u){var i=p(t++,4);!c.__s&&C(i.__H,u)&&(i.__=n,i.u=u,r.__h.push(i))}function A(n){return o=5,T(function(){return{current:n}},[])}function F(n,t,r){o=6,_(function(){if(\"function\"==typeof n){var r=n(t());return function(){n(null),r&&\"function\"==typeof r&&r()}}if(n)return n.current=t(),function(){return n.current=null}},null==r?r:r.concat(n))}function T(n,r){var u=p(t++,7);return C(u.__H,r)&&(u.__=n(),u.__H=r,u.__h=n),u.__}function q(n,t){return o=8,T(function(){return n},t)}function x(n){var u=r.context[n.__c],i=p(t++,9);return i.c=n,u?(null==i.__&&(i.__=!0,u.sub(r)),u.props.value):n.__}function P(n,t){c.useDebugValue&&c.useDebugValue(t?t(n):n)}function b(n){var u=p(t++,10),i=d();return u.__=n,r.componentDidCatch||(r.componentDidCatch=function(n,t){u.__&&u.__(n,t),i[1](n)}),[i[0],function(){i[1](void 0)}]}function g(){var n=p(t++,11);if(!n.__){for(var u=r.__v;null!==u&&!u.__m&&null!==u.__;)u=u.__;var i=u.__m||(u.__m=[0,0]);n.__=\"P\"+i[0]+\"-\"+i[1]++}return n.__}function j(){for(var n;n=f.shift();)if(n.__P&&n.__H)try{n.__H.__h.forEach(z),n.__H.__h.forEach(B),n.__H.__h=[]}catch(t){n.__H.__h=[],c.__e(t,n.__v)}}c.__b=function(n){r=null,e&&e(n)},c.__=function(n,t){n&&t.__k&&t.__k.__m&&(n.__m=t.__k.__m),s&&s(n,t)},c.__r=function(n){a&&a(n),t=0;var i=(r=n.__c).__H;i&&(u===r?(i.__h=[],r.__h=[],i.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(i.__h.forEach(z),i.__h.forEach(B),i.__h=[],t=0)),u=r},c.diffed=function(n){v&&v(n);var t=n.__c;t&&t.__H&&(t.__H.__h.length&&(1!==f.push(t)&&i===c.requestAnimationFrame||((i=c.requestAnimationFrame)||w)(j)),t.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),u=r=null},c.__c=function(n,t){t.some(function(n){try{n.__h.forEach(z),n.__h=n.__h.filter(function(n){return!n.__||B(n)})}catch(r){t.some(function(n){n.__h&&(n.__h=[])}),t=[],c.__e(r,n.__v)}}),l&&l(n,t)},c.unmount=function(n){m&&m(n);var t,r=n.__c;r&&r.__H&&(r.__H.__.forEach(function(n){try{z(n)}catch(n){t=n}}),r.__H=void 0,t&&c.__e(t,r.__v))};var k=\"function\"==typeof requestAnimationFrame;function w(n){var t,r=function(){clearTimeout(u),k&&cancelAnimationFrame(t),setTimeout(n)},u=setTimeout(r,35);k&&(t=requestAnimationFrame(r))}function z(n){var t=r,u=n.__c;\"function\"==typeof u&&(n.__c=void 0,u()),r=t}function B(n){var t=r;n.__c=n.__(),r=t}function C(n,t){return!n||n.length!==t.length||t.some(function(t,r){return t!==n[r]})}function D(n,t){return\"function\"==typeof t?t(n):t}export{q as useCallback,x as useContext,P as useDebugValue,y as useEffect,b as useErrorBoundary,g as useId,F as useImperativeHandle,_ as useLayoutEffect,T as useMemo,h as useReducer,A as useRef,d as useState};\n//# sourceMappingURL=hooks.module.js.map\n","/**\n *\n * Unique Hashing implementation inspired by djb2/fnv1a algorithms,\n * where we are not concerned with the hash being decoded.\n * Focuses on speed while maintaining good hash distribution\n *\n * Note: We could also use something like Murmurhash instead\n * https://github.com/jensyt/imurmurhash-js/blob/master/imurmurhash.js\n *\n * @param {any} input - Value to hash\n * @returns {string} - Hash in hex format\n */\nexport default function weakHash(input) {\n    // Handle primitives without JSON stringify for better performance\n    if (typeof input === 'number') {\n        // Use a larger number space for numeric values\n        return (Math.abs(input * 2654435761) >>> 0).toString(16);\n    }\n    if (typeof input === 'boolean')\n        return input ? '1' : '0';\n    if (input === null)\n        return 'null';\n    if (input === undefined)\n        return 'undefined';\n    // For strings, use FNV-1a algorithm\n    if (typeof input === 'string') {\n        let hash = 0x811c9dc5; // FNV offset basis (32 bit)\n        for (let i = 0; i < input.length; i++) {\n            hash ^= input.charCodeAt(i);\n            hash +=\n                (hash << 1) + (hash << 4) + (hash << 7) + (hash << 8) + (hash << 24);\n            hash = hash >>> 0; // Convert to unsigned 32-bit after each iteration\n        }\n        return hash.toString(16);\n    }\n    // For arrays, hash elements directly\n    if (Array.isArray(input)) {\n        let hash = 0x811c9dc5;\n        for (let i = 0; i < input.length; i++) {\n            // Add array position to hash calculation\n            hash ^= (i + 1) * 2654435761;\n            // Recursively hash array elements\n            const elementHash = weakHash(input[i]);\n            // Mix the element hash into the running hash\n            for (let j = 0; j < elementHash.length; j++) {\n                hash ^= elementHash.charCodeAt(j);\n                hash *= 16777619; // FNV prime (32 bit)\n                hash = hash >>> 0;\n            }\n        }\n        return hash.toString(16);\n    }\n    // For objects, hash keys and values\n    if (typeof input === 'object') {\n        let hash = 0x811c9dc5;\n        const keys = Object.keys(input).sort(); // Sort for consistency\n        for (let i = 0; i < keys.length; i++) {\n            const key = keys[i];\n            // Hash the key using string hash\n            const keyHash = weakHash(key);\n            hash ^= parseInt(keyHash, 16);\n            hash *= 16777619;\n            hash = hash >>> 0;\n            // Hash the value recursively\n            const valueHash = weakHash(input[key]);\n            hash ^= parseInt(valueHash, 16);\n            hash *= 16777619;\n            hash = hash >>> 0;\n        }\n        return hash.toString(16);\n    }\n    // Fallback for other types\n    return weakHash(String(input));\n}\n//# sourceMappingURL=weakHash.js.map","const Operation = {\n    Remove: 'remove',\n    Replace: 'replace',\n    Add: 'add',\n};\n\n// Don't use `Symbol()` just for 3rd party access the draft\nconst PROXY_DRAFT = Symbol.for('__MUTATIVE_PROXY_DRAFT__');\nconst RAW_RETURN_SYMBOL = Symbol('__MUTATIVE_RAW_RETURN_SYMBOL__');\nconst iteratorSymbol = Symbol.iterator;\nconst dataTypes = {\n    mutable: 'mutable',\n    immutable: 'immutable',\n};\n\nconst internal = {};\n\nfunction has(target, key) {\n    return target instanceof Map\n        ? target.has(key)\n        : Object.prototype.hasOwnProperty.call(target, key);\n}\nfunction getDescriptor(target, key) {\n    if (key in target) {\n        let prototype = Reflect.getPrototypeOf(target);\n        while (prototype) {\n            const descriptor = Reflect.getOwnPropertyDescriptor(prototype, key);\n            if (descriptor)\n                return descriptor;\n            prototype = Reflect.getPrototypeOf(prototype);\n        }\n    }\n    return;\n}\nfunction isBaseSetInstance(obj) {\n    return Object.getPrototypeOf(obj) === Set.prototype;\n}\nfunction isBaseMapInstance(obj) {\n    return Object.getPrototypeOf(obj) === Map.prototype;\n}\n\nfunction latest(proxyDraft) {\n    var _a;\n    return (_a = proxyDraft.copy) !== null && _a !== void 0 ? _a : proxyDraft.original;\n}\n/**\n * Check if the value is a draft\n */\nfunction isDraft(target) {\n    return !!getProxyDraft(target);\n}\nfunction getProxyDraft(value) {\n    if (typeof value !== 'object')\n        return null;\n    return value === null || value === void 0 ? void 0 : value[PROXY_DRAFT];\n}\nfunction getValue(value) {\n    var _a;\n    const proxyDraft = getProxyDraft(value);\n    return proxyDraft ? (_a = proxyDraft.copy) !== null && _a !== void 0 ? _a : proxyDraft.original : value;\n}\n/**\n * Check if a value is draftable\n */\nfunction isDraftable(value, options) {\n    if (!value || typeof value !== 'object')\n        return false;\n    let markResult;\n    return (Object.getPrototypeOf(value) === Object.prototype ||\n        Array.isArray(value) ||\n        value instanceof Map ||\n        value instanceof Set ||\n        (!!(options === null || options === void 0 ? void 0 : options.mark) &&\n            ((markResult = options.mark(value, dataTypes)) === dataTypes.immutable ||\n                typeof markResult === 'function')));\n}\nfunction getPath(target, path = []) {\n    if (Object.hasOwnProperty.call(target, 'key')) {\n        // check if the parent is a draft and the original value is not equal to the current value\n        const parentCopy = target.parent.copy;\n        const proxyDraft = getProxyDraft(get(parentCopy, target.key));\n        if (proxyDraft !== null && (proxyDraft === null || proxyDraft === void 0 ? void 0 : proxyDraft.original) !== target.original) {\n            return null;\n        }\n        const isSet = target.parent.type === 3 /* DraftType.Set */;\n        const key = isSet\n            ? Array.from(target.parent.setMap.keys()).indexOf(target.key)\n            : target.key;\n        // check if the key is still in the next state parent\n        if (!((isSet && parentCopy.size > key) || has(parentCopy, key)))\n            return null;\n        path.push(key);\n    }\n    if (target.parent) {\n        return getPath(target.parent, path);\n    }\n    // `target` is root draft.\n    path.reverse();\n    try {\n        // check if the path is valid\n        resolvePath(target.copy, path);\n    }\n    catch (e) {\n        return null;\n    }\n    return path;\n}\nfunction getType(target) {\n    if (Array.isArray(target))\n        return 1 /* DraftType.Array */;\n    if (target instanceof Map)\n        return 2 /* DraftType.Map */;\n    if (target instanceof Set)\n        return 3 /* DraftType.Set */;\n    return 0 /* DraftType.Object */;\n}\nfunction get(target, key) {\n    return getType(target) === 2 /* DraftType.Map */ ? target.get(key) : target[key];\n}\nfunction set(target, key, value) {\n    const type = getType(target);\n    if (type === 2 /* DraftType.Map */) {\n        target.set(key, value);\n    }\n    else {\n        target[key] = value;\n    }\n}\nfunction peek(target, key) {\n    const state = getProxyDraft(target);\n    const source = state ? latest(state) : target;\n    return source[key];\n}\nfunction isEqual(x, y) {\n    if (x === y) {\n        return x !== 0 || 1 / x === 1 / y;\n    }\n    else {\n        return x !== x && y !== y;\n    }\n}\nfunction revokeProxy(proxyDraft) {\n    if (!proxyDraft)\n        return;\n    while (proxyDraft.finalities.revoke.length > 0) {\n        const revoke = proxyDraft.finalities.revoke.pop();\n        revoke();\n    }\n}\n// handle JSON Pointer path with spec https://www.rfc-editor.org/rfc/rfc6901\nfunction escapePath(path, pathAsArray) {\n    return pathAsArray\n        ? path\n        : ['']\n            .concat(path)\n            .map((_item) => {\n            const item = `${_item}`;\n            if (item.indexOf('/') === -1 && item.indexOf('~') === -1)\n                return item;\n            return item.replace(/~/g, '~0').replace(/\\//g, '~1');\n        })\n            .join('/');\n}\nfunction unescapePath(path) {\n    if (Array.isArray(path))\n        return path;\n    return path\n        .split('/')\n        .map((_item) => _item.replace(/~1/g, '/').replace(/~0/g, '~'))\n        .slice(1);\n}\nfunction resolvePath(base, path) {\n    for (let index = 0; index < path.length - 1; index += 1) {\n        const key = path[index];\n        // use `index` in Set draft\n        base = get(getType(base) === 3 /* DraftType.Set */ ? Array.from(base) : base, key);\n        if (typeof base !== 'object') {\n            throw new Error(`Cannot resolve patch at '${path.join('/')}'.`);\n        }\n    }\n    return base;\n}\n\nfunction strictCopy(target) {\n    const copy = Object.create(Object.getPrototypeOf(target));\n    Reflect.ownKeys(target).forEach((key) => {\n        let desc = Reflect.getOwnPropertyDescriptor(target, key);\n        if (desc.enumerable && desc.configurable && desc.writable) {\n            copy[key] = target[key];\n            return;\n        }\n        // for freeze\n        if (!desc.writable) {\n            desc.writable = true;\n            desc.configurable = true;\n        }\n        if (desc.get || desc.set)\n            desc = {\n                configurable: true,\n                writable: true,\n                enumerable: desc.enumerable,\n                value: target[key],\n            };\n        Reflect.defineProperty(copy, key, desc);\n    });\n    return copy;\n}\nconst propIsEnum = Object.prototype.propertyIsEnumerable;\nfunction shallowCopy(original, options) {\n    let markResult;\n    if (Array.isArray(original)) {\n        return Array.prototype.concat.call(original);\n    }\n    else if (original instanceof Set) {\n        if (!isBaseSetInstance(original)) {\n            const SubClass = Object.getPrototypeOf(original).constructor;\n            return new SubClass(original.values());\n        }\n        return Set.prototype.difference\n            ? Set.prototype.difference.call(original, new Set())\n            : new Set(original.values());\n    }\n    else if (original instanceof Map) {\n        if (!isBaseMapInstance(original)) {\n            const SubClass = Object.getPrototypeOf(original).constructor;\n            return new SubClass(original);\n        }\n        return new Map(original);\n    }\n    else if ((options === null || options === void 0 ? void 0 : options.mark) &&\n        ((markResult = options.mark(original, dataTypes)),\n            markResult !== undefined) &&\n        markResult !== dataTypes.mutable) {\n        if (markResult === dataTypes.immutable) {\n            return strictCopy(original);\n        }\n        else if (typeof markResult === 'function') {\n            if ((options.enablePatches || options.enableAutoFreeze)) {\n                throw new Error(`You can't use mark and patches or auto freeze together.`);\n            }\n            return markResult();\n        }\n        throw new Error(`Unsupported mark result: ${markResult}`);\n    }\n    else if (typeof original === 'object' &&\n        Object.getPrototypeOf(original) === Object.prototype) {\n        // For best performance with shallow copies,\n        // don't use `Object.create(Object.getPrototypeOf(obj), Object.getOwnPropertyDescriptors(obj));` by default.\n        const copy = {};\n        Object.keys(original).forEach((key) => {\n            copy[key] = original[key];\n        });\n        Object.getOwnPropertySymbols(original).forEach((key) => {\n            if (propIsEnum.call(original, key)) {\n                copy[key] = original[key];\n            }\n        });\n        return copy;\n    }\n    else {\n        throw new Error(`Please check mark() to ensure that it is a stable marker draftable function.`);\n    }\n}\nfunction ensureShallowCopy(target) {\n    if (target.copy)\n        return;\n    target.copy = shallowCopy(target.original, target.options);\n}\nfunction deepClone(target) {\n    if (!isDraftable(target))\n        return getValue(target);\n    if (Array.isArray(target))\n        return target.map(deepClone);\n    if (target instanceof Map) {\n        const iterable = Array.from(target.entries()).map(([k, v]) => [\n            k,\n            deepClone(v),\n        ]);\n        if (!isBaseMapInstance(target)) {\n            const SubClass = Object.getPrototypeOf(target).constructor;\n            return new SubClass(iterable);\n        }\n        return new Map(iterable);\n    }\n    if (target instanceof Set) {\n        const iterable = Array.from(target).map(deepClone);\n        if (!isBaseSetInstance(target)) {\n            const SubClass = Object.getPrototypeOf(target).constructor;\n            return new SubClass(iterable);\n        }\n        return new Set(iterable);\n    }\n    const copy = Object.create(Object.getPrototypeOf(target));\n    for (const key in target)\n        copy[key] = deepClone(target[key]);\n    return copy;\n}\nfunction cloneIfNeeded(target) {\n    return isDraft(target) ? deepClone(target) : target;\n}\n\nfunction markChanged(proxyDraft) {\n    var _a;\n    proxyDraft.assignedMap = (_a = proxyDraft.assignedMap) !== null && _a !== void 0 ? _a : new Map();\n    if (!proxyDraft.operated) {\n        proxyDraft.operated = true;\n        if (proxyDraft.parent) {\n            markChanged(proxyDraft.parent);\n        }\n    }\n}\n\nfunction throwFrozenError() {\n    throw new Error('Cannot modify frozen object');\n}\nfunction deepFreeze(target, subKey, updatedValues, stack, keys) {\n    {\n        updatedValues = updatedValues !== null && updatedValues !== void 0 ? updatedValues : new WeakMap();\n        stack = stack !== null && stack !== void 0 ? stack : [];\n        keys = keys !== null && keys !== void 0 ? keys : [];\n        const value = updatedValues.has(target)\n            ? updatedValues.get(target)\n            : target;\n        if (stack.length > 0) {\n            const index = stack.indexOf(value);\n            if (value && typeof value === 'object' && index !== -1) {\n                if (stack[0] === value) {\n                    throw new Error(`Forbids circular reference`);\n                }\n                throw new Error(`Forbids circular reference: ~/${keys\n                    .slice(0, index)\n                    .map((key, index) => {\n                    if (typeof key === 'symbol')\n                        return `[${key.toString()}]`;\n                    const parent = stack[index];\n                    if (typeof key === 'object' &&\n                        (parent instanceof Map || parent instanceof Set))\n                        return Array.from(parent.keys()).indexOf(key);\n                    return key;\n                })\n                    .join('/')}`);\n            }\n            stack.push(value);\n            keys.push(subKey);\n        }\n        else {\n            stack.push(value);\n        }\n    }\n    if (Object.isFrozen(target) || isDraft(target)) {\n        {\n            stack.pop();\n            keys.pop();\n        }\n        return;\n    }\n    const type = getType(target);\n    switch (type) {\n        case 2 /* DraftType.Map */:\n            for (const [key, value] of target) {\n                deepFreeze(key, key, updatedValues, stack, keys);\n                deepFreeze(value, key, updatedValues, stack, keys);\n            }\n            target.set = target.clear = target.delete = throwFrozenError;\n            break;\n        case 3 /* DraftType.Set */:\n            for (const value of target) {\n                deepFreeze(value, value, updatedValues, stack, keys);\n            }\n            target.add = target.clear = target.delete = throwFrozenError;\n            break;\n        case 1 /* DraftType.Array */:\n            Object.freeze(target);\n            let index = 0;\n            for (const value of target) {\n                deepFreeze(value, index, updatedValues, stack, keys);\n                index += 1;\n            }\n            break;\n        default:\n            Object.freeze(target);\n            // ignore non-enumerable or symbol properties\n            Object.keys(target).forEach((name) => {\n                const value = target[name];\n                deepFreeze(value, name, updatedValues, stack, keys);\n            });\n    }\n    {\n        stack.pop();\n        keys.pop();\n    }\n}\n\nfunction forEach(target, iter) {\n    const type = getType(target);\n    if (type === 0 /* DraftType.Object */) {\n        Reflect.ownKeys(target).forEach((key) => {\n            iter(key, target[key], target);\n        });\n    }\n    else if (type === 1 /* DraftType.Array */) {\n        let index = 0;\n        for (const entry of target) {\n            iter(index, entry, target);\n            index += 1;\n        }\n    }\n    else {\n        target.forEach((entry, index) => iter(index, entry, target));\n    }\n}\n\nfunction handleValue(target, handledSet, options) {\n    if (isDraft(target) ||\n        !isDraftable(target, options) ||\n        handledSet.has(target) ||\n        Object.isFrozen(target))\n        return;\n    const isSet = target instanceof Set;\n    const setMap = isSet ? new Map() : undefined;\n    handledSet.add(target);\n    forEach(target, (key, value) => {\n        var _a;\n        if (isDraft(value)) {\n            const proxyDraft = getProxyDraft(value);\n            ensureShallowCopy(proxyDraft);\n            // A draft where a child node has been changed, or assigned a value\n            const updatedValue = ((_a = proxyDraft.assignedMap) === null || _a === void 0 ? void 0 : _a.size) || proxyDraft.operated\n                ? proxyDraft.copy\n                : proxyDraft.original;\n            // final update value\n            set(isSet ? setMap : target, key, updatedValue);\n        }\n        else {\n            handleValue(value, handledSet, options);\n        }\n    });\n    if (setMap) {\n        const set = target;\n        const values = Array.from(set);\n        set.clear();\n        values.forEach((value) => {\n            set.add(setMap.has(value) ? setMap.get(value) : value);\n        });\n    }\n}\nfunction finalizeAssigned(proxyDraft, key) {\n    // handle the draftable assigned valuesï¼Œ and the value is not a draft\n    const copy = proxyDraft.type === 3 /* DraftType.Set */ ? proxyDraft.setMap : proxyDraft.copy;\n    if (proxyDraft.finalities.revoke.length > 1 &&\n        proxyDraft.assignedMap.get(key) &&\n        copy) {\n        handleValue(get(copy, key), proxyDraft.finalities.handledSet, proxyDraft.options);\n    }\n}\nfunction finalizeSetValue(target) {\n    if (target.type === 3 /* DraftType.Set */ && target.copy) {\n        target.copy.clear();\n        target.setMap.forEach((value) => {\n            target.copy.add(getValue(value));\n        });\n    }\n}\nfunction finalizePatches(target, generatePatches, patches, inversePatches) {\n    const shouldFinalize = target.operated &&\n        target.assignedMap &&\n        target.assignedMap.size > 0 &&\n        !target.finalized;\n    if (shouldFinalize) {\n        if (patches && inversePatches) {\n            const basePath = getPath(target);\n            if (basePath) {\n                generatePatches(target, basePath, patches, inversePatches);\n            }\n        }\n        target.finalized = true;\n    }\n}\nfunction markFinalization(target, key, value, generatePatches) {\n    const proxyDraft = getProxyDraft(value);\n    if (proxyDraft) {\n        // !case: assign the draft value\n        if (!proxyDraft.callbacks) {\n            proxyDraft.callbacks = [];\n        }\n        proxyDraft.callbacks.push((patches, inversePatches) => {\n            var _a;\n            const copy = target.type === 3 /* DraftType.Set */ ? target.setMap : target.copy;\n            if (isEqual(get(copy, key), value)) {\n                let updatedValue = proxyDraft.original;\n                if (proxyDraft.copy) {\n                    updatedValue = proxyDraft.copy;\n                }\n                finalizeSetValue(target);\n                finalizePatches(target, generatePatches, patches, inversePatches);\n                if (target.options.enableAutoFreeze) {\n                    target.options.updatedValues =\n                        (_a = target.options.updatedValues) !== null && _a !== void 0 ? _a : new WeakMap();\n                    target.options.updatedValues.set(updatedValue, proxyDraft.original);\n                }\n                // final update value\n                set(copy, key, updatedValue);\n            }\n        });\n        if (target.options.enableAutoFreeze) {\n            // !case: assign the draft value in cross draft tree\n            if (proxyDraft.finalities !== target.finalities) {\n                target.options.enableAutoFreeze = false;\n            }\n        }\n    }\n    if (isDraftable(value, target.options)) {\n        // !case: assign the non-draft value\n        target.finalities.draft.push(() => {\n            const copy = target.type === 3 /* DraftType.Set */ ? target.setMap : target.copy;\n            if (isEqual(get(copy, key), value)) {\n                finalizeAssigned(target, key);\n            }\n        });\n    }\n}\n\nfunction generateArrayPatches(proxyState, basePath, patches, inversePatches, pathAsArray) {\n    let { original, assignedMap, options } = proxyState;\n    let copy = proxyState.copy;\n    if (copy.length < original.length) {\n        [original, copy] = [copy, original];\n        [patches, inversePatches] = [inversePatches, patches];\n    }\n    for (let index = 0; index < original.length; index += 1) {\n        if (assignedMap.get(index.toString()) && copy[index] !== original[index]) {\n            const _path = basePath.concat([index]);\n            const path = escapePath(_path, pathAsArray);\n            patches.push({\n                op: Operation.Replace,\n                path,\n                // If it is a draft, it needs to be deep cloned, and it may also be non-draft.\n                value: cloneIfNeeded(copy[index]),\n            });\n            inversePatches.push({\n                op: Operation.Replace,\n                path,\n                // If it is a draft, it needs to be deep cloned, and it may also be non-draft.\n                value: cloneIfNeeded(original[index]),\n            });\n        }\n    }\n    for (let index = original.length; index < copy.length; index += 1) {\n        const _path = basePath.concat([index]);\n        const path = escapePath(_path, pathAsArray);\n        patches.push({\n            op: Operation.Add,\n            path,\n            // If it is a draft, it needs to be deep cloned, and it may also be non-draft.\n            value: cloneIfNeeded(copy[index]),\n        });\n    }\n    if (original.length < copy.length) {\n        // https://www.rfc-editor.org/rfc/rfc6902#appendix-A.4\n        // For performance, here we only generate an operation that replaces the length of the array,\n        // which is inconsistent with JSON Patch specification\n        const { arrayLengthAssignment = true } = options.enablePatches;\n        if (arrayLengthAssignment) {\n            const _path = basePath.concat(['length']);\n            const path = escapePath(_path, pathAsArray);\n            inversePatches.push({\n                op: Operation.Replace,\n                path,\n                value: original.length,\n            });\n        }\n        else {\n            for (let index = copy.length; original.length < index; index -= 1) {\n                const _path = basePath.concat([index - 1]);\n                const path = escapePath(_path, pathAsArray);\n                inversePatches.push({\n                    op: Operation.Remove,\n                    path,\n                });\n            }\n        }\n    }\n}\nfunction generatePatchesFromAssigned({ original, copy, assignedMap }, basePath, patches, inversePatches, pathAsArray) {\n    assignedMap.forEach((assignedValue, key) => {\n        const originalValue = get(original, key);\n        const value = cloneIfNeeded(get(copy, key));\n        const op = !assignedValue\n            ? Operation.Remove\n            : has(original, key)\n                ? Operation.Replace\n                : Operation.Add;\n        if (isEqual(originalValue, value) && op === Operation.Replace)\n            return;\n        const _path = basePath.concat(key);\n        const path = escapePath(_path, pathAsArray);\n        patches.push(op === Operation.Remove ? { op, path } : { op, path, value });\n        inversePatches.push(op === Operation.Add\n            ? { op: Operation.Remove, path }\n            : op === Operation.Remove\n                ? { op: Operation.Add, path, value: originalValue }\n                : { op: Operation.Replace, path, value: originalValue });\n    });\n}\nfunction generateSetPatches({ original, copy }, basePath, patches, inversePatches, pathAsArray) {\n    let index = 0;\n    original.forEach((value) => {\n        if (!copy.has(value)) {\n            const _path = basePath.concat([index]);\n            const path = escapePath(_path, pathAsArray);\n            patches.push({\n                op: Operation.Remove,\n                path,\n                value,\n            });\n            inversePatches.unshift({\n                op: Operation.Add,\n                path,\n                value,\n            });\n        }\n        index += 1;\n    });\n    index = 0;\n    copy.forEach((value) => {\n        if (!original.has(value)) {\n            const _path = basePath.concat([index]);\n            const path = escapePath(_path, pathAsArray);\n            patches.push({\n                op: Operation.Add,\n                path,\n                value,\n            });\n            inversePatches.unshift({\n                op: Operation.Remove,\n                path,\n                value,\n            });\n        }\n        index += 1;\n    });\n}\nfunction generatePatches(proxyState, basePath, patches, inversePatches) {\n    const { pathAsArray = true } = proxyState.options.enablePatches;\n    switch (proxyState.type) {\n        case 0 /* DraftType.Object */:\n        case 2 /* DraftType.Map */:\n            return generatePatchesFromAssigned(proxyState, basePath, patches, inversePatches, pathAsArray);\n        case 1 /* DraftType.Array */:\n            return generateArrayPatches(proxyState, basePath, patches, inversePatches, pathAsArray);\n        case 3 /* DraftType.Set */:\n            return generateSetPatches(proxyState, basePath, patches, inversePatches, pathAsArray);\n    }\n}\n\nlet readable = false;\nconst checkReadable = (value, options, ignoreCheckDraftable = false) => {\n    if (typeof value === 'object' &&\n        value !== null &&\n        (!isDraftable(value, options) || ignoreCheckDraftable) &&\n        !readable) {\n        throw new Error(`Strict mode: Mutable data cannot be accessed directly, please use 'unsafe(callback)' wrap.`);\n    }\n};\n/**\n * `unsafe(callback)` to access mutable data directly in strict mode.\n *\n * ## Example\n *\n * ```ts\n * import { create, unsafe } from '../index';\n *\n * class Foobar {\n *   bar = 1;\n * }\n *\n * const baseState = { foobar: new Foobar() };\n * const state = create(\n *   baseState,\n *   (draft) => {\n *    unsafe(() => {\n *      draft.foobar.bar = 2;\n *    });\n *   },\n *   {\n *     strict: true,\n *   }\n * );\n *\n * expect(state).toBe(baseState);\n * expect(state.foobar).toBe(baseState.foobar);\n * expect(state.foobar.bar).toBe(2);\n * ```\n */\nfunction unsafe(callback) {\n    readable = true;\n    let result;\n    try {\n        result = callback();\n    }\n    finally {\n        readable = false;\n    }\n    return result;\n}\n\nconst mapHandler = {\n    get size() {\n        const current = latest(getProxyDraft(this));\n        return current.size;\n    },\n    has(key) {\n        return latest(getProxyDraft(this)).has(key);\n    },\n    set(key, value) {\n        const target = getProxyDraft(this);\n        const source = latest(target);\n        if (!source.has(key) || !isEqual(source.get(key), value)) {\n            ensureShallowCopy(target);\n            markChanged(target);\n            target.assignedMap.set(key, true);\n            target.copy.set(key, value);\n            markFinalization(target, key, value, generatePatches);\n        }\n        return this;\n    },\n    delete(key) {\n        if (!this.has(key)) {\n            return false;\n        }\n        const target = getProxyDraft(this);\n        ensureShallowCopy(target);\n        markChanged(target);\n        if (target.original.has(key)) {\n            target.assignedMap.set(key, false);\n        }\n        else {\n            target.assignedMap.delete(key);\n        }\n        target.copy.delete(key);\n        return true;\n    },\n    clear() {\n        const target = getProxyDraft(this);\n        if (!this.size)\n            return;\n        ensureShallowCopy(target);\n        markChanged(target);\n        target.assignedMap = new Map();\n        for (const [key] of target.original) {\n            target.assignedMap.set(key, false);\n        }\n        target.copy.clear();\n    },\n    forEach(callback, thisArg) {\n        const target = getProxyDraft(this);\n        latest(target).forEach((_value, _key) => {\n            callback.call(thisArg, this.get(_key), _key, this);\n        });\n    },\n    get(key) {\n        var _a, _b;\n        const target = getProxyDraft(this);\n        const value = latest(target).get(key);\n        const mutable = ((_b = (_a = target.options).mark) === null || _b === void 0 ? void 0 : _b.call(_a, value, dataTypes)) === dataTypes.mutable;\n        if (target.options.strict) {\n            checkReadable(value, target.options, mutable);\n        }\n        if (mutable) {\n            return value;\n        }\n        if (target.finalized || !isDraftable(value, target.options)) {\n            return value;\n        }\n        // drafted or reassigned\n        if (value !== target.original.get(key)) {\n            return value;\n        }\n        const draft = internal.createDraft({\n            original: value,\n            parentDraft: target,\n            key,\n            finalities: target.finalities,\n            options: target.options,\n        });\n        ensureShallowCopy(target);\n        target.copy.set(key, draft);\n        return draft;\n    },\n    keys() {\n        return latest(getProxyDraft(this)).keys();\n    },\n    values() {\n        const iterator = this.keys();\n        return {\n            [iteratorSymbol]: () => this.values(),\n            next: () => {\n                const result = iterator.next();\n                if (result.done)\n                    return result;\n                const value = this.get(result.value);\n                return {\n                    done: false,\n                    value,\n                };\n            },\n        };\n    },\n    entries() {\n        const iterator = this.keys();\n        return {\n            [iteratorSymbol]: () => this.entries(),\n            next: () => {\n                const result = iterator.next();\n                if (result.done)\n                    return result;\n                const value = this.get(result.value);\n                return {\n                    done: false,\n                    value: [result.value, value],\n                };\n            },\n        };\n    },\n    [iteratorSymbol]() {\n        return this.entries();\n    },\n};\nconst mapHandlerKeys = Reflect.ownKeys(mapHandler);\n\nconst getNextIterator = (target, iterator, { isValuesIterator }) => () => {\n    var _a, _b;\n    const result = iterator.next();\n    if (result.done)\n        return result;\n    const key = result.value;\n    let value = target.setMap.get(key);\n    const currentDraft = getProxyDraft(value);\n    const mutable = ((_b = (_a = target.options).mark) === null || _b === void 0 ? void 0 : _b.call(_a, value, dataTypes)) === dataTypes.mutable;\n    if (target.options.strict) {\n        checkReadable(key, target.options, mutable);\n    }\n    if (!mutable &&\n        !currentDraft &&\n        isDraftable(key, target.options) &&\n        !target.finalized &&\n        target.original.has(key)) {\n        // draft a draftable original set item\n        const proxy = internal.createDraft({\n            original: key,\n            parentDraft: target,\n            key,\n            finalities: target.finalities,\n            options: target.options,\n        });\n        target.setMap.set(key, proxy);\n        value = proxy;\n    }\n    else if (currentDraft) {\n        // drafted\n        value = currentDraft.proxy;\n    }\n    return {\n        done: false,\n        value: isValuesIterator ? value : [value, value],\n    };\n};\nconst setHandler = {\n    get size() {\n        const target = getProxyDraft(this);\n        return target.setMap.size;\n    },\n    has(value) {\n        const target = getProxyDraft(this);\n        // reassigned or non-draftable values\n        if (target.setMap.has(value))\n            return true;\n        ensureShallowCopy(target);\n        const valueProxyDraft = getProxyDraft(value);\n        // drafted\n        if (valueProxyDraft && target.setMap.has(valueProxyDraft.original))\n            return true;\n        return false;\n    },\n    add(value) {\n        const target = getProxyDraft(this);\n        if (!this.has(value)) {\n            ensureShallowCopy(target);\n            markChanged(target);\n            target.assignedMap.set(value, true);\n            target.setMap.set(value, value);\n            markFinalization(target, value, value, generatePatches);\n        }\n        return this;\n    },\n    delete(value) {\n        if (!this.has(value)) {\n            return false;\n        }\n        const target = getProxyDraft(this);\n        ensureShallowCopy(target);\n        markChanged(target);\n        const valueProxyDraft = getProxyDraft(value);\n        if (valueProxyDraft && target.setMap.has(valueProxyDraft.original)) {\n            // delete drafted\n            target.assignedMap.set(valueProxyDraft.original, false);\n            return target.setMap.delete(valueProxyDraft.original);\n        }\n        if (!valueProxyDraft && target.setMap.has(value)) {\n            // non-draftable values\n            target.assignedMap.set(value, false);\n        }\n        else {\n            // reassigned\n            target.assignedMap.delete(value);\n        }\n        // delete reassigned or non-draftable values\n        return target.setMap.delete(value);\n    },\n    clear() {\n        if (!this.size)\n            return;\n        const target = getProxyDraft(this);\n        ensureShallowCopy(target);\n        markChanged(target);\n        for (const value of target.original) {\n            target.assignedMap.set(value, false);\n        }\n        target.setMap.clear();\n    },\n    values() {\n        const target = getProxyDraft(this);\n        ensureShallowCopy(target);\n        const iterator = target.setMap.keys();\n        return {\n            [Symbol.iterator]: () => this.values(),\n            next: getNextIterator(target, iterator, { isValuesIterator: true }),\n        };\n    },\n    entries() {\n        const target = getProxyDraft(this);\n        ensureShallowCopy(target);\n        const iterator = target.setMap.keys();\n        return {\n            [Symbol.iterator]: () => this.entries(),\n            next: getNextIterator(target, iterator, {\n                isValuesIterator: false,\n            }),\n        };\n    },\n    keys() {\n        return this.values();\n    },\n    [iteratorSymbol]() {\n        return this.values();\n    },\n    forEach(callback, thisArg) {\n        const iterator = this.values();\n        let result = iterator.next();\n        while (!result.done) {\n            callback.call(thisArg, result.value, result.value, this);\n            result = iterator.next();\n        }\n    },\n};\nif (Set.prototype.difference) {\n    // for compatibility with new Set methods\n    // https://github.com/tc39/proposal-set-methods\n    // And `https://github.com/tc39/proposal-set-methods/blob/main/details.md#symbolspecies` has some details about the `@@species` symbol.\n    // So we can't use SubSet instance constructor to get the constructor of the SubSet instance.\n    Object.assign(setHandler, {\n        intersection(other) {\n            return Set.prototype.intersection.call(new Set(this.values()), other);\n        },\n        union(other) {\n            return Set.prototype.union.call(new Set(this.values()), other);\n        },\n        difference(other) {\n            return Set.prototype.difference.call(new Set(this.values()), other);\n        },\n        symmetricDifference(other) {\n            return Set.prototype.symmetricDifference.call(new Set(this.values()), other);\n        },\n        isSubsetOf(other) {\n            return Set.prototype.isSubsetOf.call(new Set(this.values()), other);\n        },\n        isSupersetOf(other) {\n            return Set.prototype.isSupersetOf.call(new Set(this.values()), other);\n        },\n        isDisjointFrom(other) {\n            return Set.prototype.isDisjointFrom.call(new Set(this.values()), other);\n        },\n    });\n}\nconst setHandlerKeys = Reflect.ownKeys(setHandler);\n\nconst draftsCache = new WeakSet();\nconst proxyHandler = {\n    get(target, key, receiver) {\n        var _a, _b;\n        const copy = (_a = target.copy) === null || _a === void 0 ? void 0 : _a[key];\n        // Improve draft reading performance by caching the draft copy.\n        if (copy && draftsCache.has(copy)) {\n            return copy;\n        }\n        if (key === PROXY_DRAFT)\n            return target;\n        let markResult;\n        if (target.options.mark) {\n            // handle `Uncaught TypeError: Method get Map.prototype.size called on incompatible receiver #<Map>`\n            // or `Uncaught TypeError: Method get Set.prototype.size called on incompatible receiver #<Set>`\n            const value = key === 'size' &&\n                (target.original instanceof Map || target.original instanceof Set)\n                ? Reflect.get(target.original, key)\n                : Reflect.get(target.original, key, receiver);\n            markResult = target.options.mark(value, dataTypes);\n            if (markResult === dataTypes.mutable) {\n                if (target.options.strict) {\n                    checkReadable(value, target.options, true);\n                }\n                return value;\n            }\n        }\n        const source = latest(target);\n        if (source instanceof Map && mapHandlerKeys.includes(key)) {\n            if (key === 'size') {\n                return Object.getOwnPropertyDescriptor(mapHandler, 'size').get.call(target.proxy);\n            }\n            const handle = mapHandler[key];\n            if (handle) {\n                return handle.bind(target.proxy);\n            }\n        }\n        if (source instanceof Set && setHandlerKeys.includes(key)) {\n            if (key === 'size') {\n                return Object.getOwnPropertyDescriptor(setHandler, 'size').get.call(target.proxy);\n            }\n            const handle = setHandler[key];\n            if (handle) {\n                return handle.bind(target.proxy);\n            }\n        }\n        if (!has(source, key)) {\n            const desc = getDescriptor(source, key);\n            return desc\n                ? `value` in desc\n                    ? desc.value\n                    : // !case: support for getter\n                        (_b = desc.get) === null || _b === void 0 ? void 0 : _b.call(target.proxy)\n                : undefined;\n        }\n        const value = source[key];\n        if (target.options.strict) {\n            checkReadable(value, target.options);\n        }\n        if (target.finalized || !isDraftable(value, target.options)) {\n            return value;\n        }\n        // Ensure that the assigned values are not drafted\n        if (value === peek(target.original, key)) {\n            ensureShallowCopy(target);\n            target.copy[key] = createDraft({\n                original: target.original[key],\n                parentDraft: target,\n                key: target.type === 1 /* DraftType.Array */ ? Number(key) : key,\n                finalities: target.finalities,\n                options: target.options,\n            });\n            // !case: support for custom shallow copy function\n            if (typeof markResult === 'function') {\n                const subProxyDraft = getProxyDraft(target.copy[key]);\n                ensureShallowCopy(subProxyDraft);\n                // Trigger a custom shallow copy to update to a new copy\n                markChanged(subProxyDraft);\n                return subProxyDraft.copy;\n            }\n            return target.copy[key];\n        }\n        return value;\n    },\n    set(target, key, value) {\n        var _a;\n        if (target.type === 3 /* DraftType.Set */ || target.type === 2 /* DraftType.Map */) {\n            throw new Error(`Map/Set draft does not support any property assignment.`);\n        }\n        let _key;\n        if (target.type === 1 /* DraftType.Array */ &&\n            key !== 'length' &&\n            !(Number.isInteger((_key = Number(key))) &&\n                _key >= 0 &&\n                (key === 0 || _key === 0 || String(_key) === String(key)))) {\n            throw new Error(`Only supports setting array indices and the 'length' property.`);\n        }\n        const desc = getDescriptor(latest(target), key);\n        if (desc === null || desc === void 0 ? void 0 : desc.set) {\n            // !case: cover the case of setter\n            desc.set.call(target.proxy, value);\n            return true;\n        }\n        const current = peek(latest(target), key);\n        const currentProxyDraft = getProxyDraft(current);\n        if (currentProxyDraft && isEqual(currentProxyDraft.original, value)) {\n            // !case: ignore the case of assigning the original draftable value to a draft\n            target.copy[key] = value;\n            target.assignedMap = (_a = target.assignedMap) !== null && _a !== void 0 ? _a : new Map();\n            target.assignedMap.set(key, false);\n            return true;\n        }\n        // !case: handle new props with value 'undefined'\n        if (isEqual(value, current) &&\n            (value !== undefined || has(target.original, key)))\n            return true;\n        ensureShallowCopy(target);\n        markChanged(target);\n        if (has(target.original, key) && isEqual(value, target.original[key])) {\n            // !case: handle the case of assigning the original non-draftable value to a draft\n            target.assignedMap.delete(key);\n        }\n        else {\n            target.assignedMap.set(key, true);\n        }\n        target.copy[key] = value;\n        markFinalization(target, key, value, generatePatches);\n        return true;\n    },\n    has(target, key) {\n        return key in latest(target);\n    },\n    ownKeys(target) {\n        return Reflect.ownKeys(latest(target));\n    },\n    getOwnPropertyDescriptor(target, key) {\n        const source = latest(target);\n        const descriptor = Reflect.getOwnPropertyDescriptor(source, key);\n        if (!descriptor)\n            return descriptor;\n        return {\n            writable: true,\n            configurable: target.type !== 1 /* DraftType.Array */ || key !== 'length',\n            enumerable: descriptor.enumerable,\n            value: source[key],\n        };\n    },\n    getPrototypeOf(target) {\n        return Reflect.getPrototypeOf(target.original);\n    },\n    setPrototypeOf() {\n        throw new Error(`Cannot call 'setPrototypeOf()' on drafts`);\n    },\n    defineProperty() {\n        throw new Error(`Cannot call 'defineProperty()' on drafts`);\n    },\n    deleteProperty(target, key) {\n        var _a;\n        if (target.type === 1 /* DraftType.Array */) {\n            return proxyHandler.set.call(this, target, key, undefined, target.proxy);\n        }\n        if (peek(target.original, key) !== undefined || key in target.original) {\n            // !case: delete an existing key\n            ensureShallowCopy(target);\n            markChanged(target);\n            target.assignedMap.set(key, false);\n        }\n        else {\n            target.assignedMap = (_a = target.assignedMap) !== null && _a !== void 0 ? _a : new Map();\n            // The original non-existent key has been deleted\n            target.assignedMap.delete(key);\n        }\n        if (target.copy)\n            delete target.copy[key];\n        return true;\n    },\n};\nfunction createDraft(createDraftOptions) {\n    const { original, parentDraft, key, finalities, options } = createDraftOptions;\n    const type = getType(original);\n    const proxyDraft = {\n        type,\n        finalized: false,\n        parent: parentDraft,\n        original,\n        copy: null,\n        proxy: null,\n        finalities,\n        options,\n        // Mapping of draft Set items to their corresponding draft values.\n        setMap: type === 3 /* DraftType.Set */\n            ? new Map(original.entries())\n            : undefined,\n    };\n    // !case: undefined as a draft map key\n    if (key || 'key' in createDraftOptions) {\n        proxyDraft.key = key;\n    }\n    const { proxy, revoke } = Proxy.revocable(type === 1 /* DraftType.Array */ ? Object.assign([], proxyDraft) : proxyDraft, proxyHandler);\n    finalities.revoke.push(revoke);\n    draftsCache.add(proxy);\n    proxyDraft.proxy = proxy;\n    if (parentDraft) {\n        const target = parentDraft;\n        target.finalities.draft.push((patches, inversePatches) => {\n            var _a, _b;\n            const oldProxyDraft = getProxyDraft(proxy);\n            // if target is a Set draft, `setMap` is the real Set copies proxy mapping.\n            let copy = target.type === 3 /* DraftType.Set */ ? target.setMap : target.copy;\n            const draft = get(copy, key);\n            const proxyDraft = getProxyDraft(draft);\n            if (proxyDraft) {\n                // assign the updated value to the copy object\n                let updatedValue = proxyDraft.original;\n                if (proxyDraft.operated) {\n                    updatedValue = getValue(draft);\n                }\n                finalizeSetValue(proxyDraft);\n                finalizePatches(proxyDraft, generatePatches, patches, inversePatches);\n                if (target.options.enableAutoFreeze) {\n                    target.options.updatedValues =\n                        (_a = target.options.updatedValues) !== null && _a !== void 0 ? _a : new WeakMap();\n                    target.options.updatedValues.set(updatedValue, proxyDraft.original);\n                }\n                // final update value\n                set(copy, key, updatedValue);\n            }\n            // !case: handle the deleted key\n            (_b = oldProxyDraft.callbacks) === null || _b === void 0 ? void 0 : _b.forEach((callback) => {\n                callback(patches, inversePatches);\n            });\n        });\n    }\n    else {\n        // !case: handle the root draft\n        const target = getProxyDraft(proxy);\n        target.finalities.draft.push((patches, inversePatches) => {\n            finalizeSetValue(target);\n            finalizePatches(target, generatePatches, patches, inversePatches);\n        });\n    }\n    return proxy;\n}\ninternal.createDraft = createDraft;\nfunction finalizeDraft(result, returnedValue, patches, inversePatches, enableAutoFreeze) {\n    var _a;\n    const proxyDraft = getProxyDraft(result);\n    const original = (_a = proxyDraft === null || proxyDraft === void 0 ? void 0 : proxyDraft.original) !== null && _a !== void 0 ? _a : result;\n    const hasReturnedValue = !!returnedValue.length;\n    if (proxyDraft === null || proxyDraft === void 0 ? void 0 : proxyDraft.operated) {\n        while (proxyDraft.finalities.draft.length > 0) {\n            const finalize = proxyDraft.finalities.draft.pop();\n            finalize(patches, inversePatches);\n        }\n    }\n    const state = hasReturnedValue\n        ? returnedValue[0]\n        : proxyDraft\n            ? proxyDraft.operated\n                ? proxyDraft.copy\n                : proxyDraft.original\n            : result;\n    if (proxyDraft)\n        revokeProxy(proxyDraft);\n    if (enableAutoFreeze) {\n        deepFreeze(state, state, proxyDraft === null || proxyDraft === void 0 ? void 0 : proxyDraft.options.updatedValues);\n    }\n    return [\n        state,\n        patches && hasReturnedValue\n            ? [{ op: Operation.Replace, path: [], value: returnedValue[0] }]\n            : patches,\n        inversePatches && hasReturnedValue\n            ? [{ op: Operation.Replace, path: [], value: original }]\n            : inversePatches,\n    ];\n}\n\nfunction draftify(baseState, options) {\n    var _a;\n    const finalities = {\n        draft: [],\n        revoke: [],\n        handledSet: new WeakSet(),\n    };\n    let patches;\n    let inversePatches;\n    if (options.enablePatches) {\n        patches = [];\n        inversePatches = [];\n    }\n    const isMutable = ((_a = options.mark) === null || _a === void 0 ? void 0 : _a.call(options, baseState, dataTypes)) === dataTypes.mutable ||\n        !isDraftable(baseState, options);\n    const draft = isMutable\n        ? baseState\n        : createDraft({\n            original: baseState,\n            parentDraft: null,\n            finalities,\n            options,\n        });\n    return [\n        draft,\n        (returnedValue = []) => {\n            const [finalizedState, finalizedPatches, finalizedInversePatches] = finalizeDraft(draft, returnedValue, patches, inversePatches, options.enableAutoFreeze);\n            return (options.enablePatches\n                ? [finalizedState, finalizedPatches, finalizedInversePatches]\n                : finalizedState);\n        },\n    ];\n}\n\nfunction handleReturnValue(options) {\n    const { rootDraft, value, useRawReturn = false, isRoot = true } = options;\n    forEach(value, (key, item, source) => {\n        const proxyDraft = getProxyDraft(item);\n        // just handle the draft which is created by the same rootDraft\n        if (proxyDraft &&\n            rootDraft &&\n            proxyDraft.finalities === rootDraft.finalities) {\n            options.isContainDraft = true;\n            const currentValue = proxyDraft.original;\n            // final update value, but just handle return value\n            if (source instanceof Set) {\n                const arr = Array.from(source);\n                source.clear();\n                arr.forEach((_item) => source.add(key === _item ? currentValue : _item));\n            }\n            else {\n                set(source, key, currentValue);\n            }\n        }\n        else if (typeof item === 'object' && item !== null) {\n            options.value = item;\n            options.isRoot = false;\n            handleReturnValue(options);\n        }\n    });\n    if (isRoot) {\n        if (!options.isContainDraft)\n            console.warn(`The return value does not contain any draft, please use 'rawReturn()' to wrap the return value to improve performance.`);\n        if (useRawReturn) {\n            console.warn(`The return value contains drafts, please don't use 'rawReturn()' to wrap the return value.`);\n        }\n    }\n}\nfunction getCurrent(target) {\n    var _a;\n    const proxyDraft = getProxyDraft(target);\n    if (!isDraftable(target, proxyDraft === null || proxyDraft === void 0 ? void 0 : proxyDraft.options))\n        return target;\n    const type = getType(target);\n    if (proxyDraft && !proxyDraft.operated)\n        return proxyDraft.original;\n    let currentValue;\n    function ensureShallowCopy() {\n        currentValue =\n            type === 2 /* DraftType.Map */\n                ? !isBaseMapInstance(target)\n                    ? new (Object.getPrototypeOf(target).constructor)(target)\n                    : new Map(target)\n                : type === 3 /* DraftType.Set */\n                    ? Array.from(proxyDraft.setMap.values())\n                    : shallowCopy(target, proxyDraft === null || proxyDraft === void 0 ? void 0 : proxyDraft.options);\n    }\n    if (proxyDraft) {\n        // It's a proxy draft, let's create a shallow copy eagerly\n        proxyDraft.finalized = true;\n        try {\n            ensureShallowCopy();\n        }\n        finally {\n            proxyDraft.finalized = false;\n        }\n    }\n    else {\n        // It's not a proxy draft, let's use the target directly and let's see\n        // lazily if we need to create a shallow copy\n        currentValue = target;\n    }\n    forEach(currentValue, (key, value) => {\n        if (proxyDraft && isEqual(get(proxyDraft.original, key), value))\n            return;\n        const newValue = getCurrent(value);\n        if (newValue !== value) {\n            if (currentValue === target)\n                ensureShallowCopy();\n            set(currentValue, key, newValue);\n        }\n    });\n    if (type === 3 /* DraftType.Set */) {\n        const value = (_a = proxyDraft === null || proxyDraft === void 0 ? void 0 : proxyDraft.original) !== null && _a !== void 0 ? _a : currentValue;\n        return !isBaseSetInstance(value)\n            ? new (Object.getPrototypeOf(value).constructor)(currentValue)\n            : new Set(currentValue);\n    }\n    return currentValue;\n}\nfunction current(target) {\n    if (!isDraft(target)) {\n        throw new Error(`current() is only used for Draft, parameter: ${target}`);\n    }\n    return getCurrent(target);\n}\n\n/**\n * `makeCreator(options)` to make a creator function.\n *\n * ## Example\n *\n * ```ts\n * import { makeCreator } from '../index';\n *\n * const baseState = { foo: { bar: 'str' }, arr: [] };\n * const create = makeCreator({ enableAutoFreeze: true });\n * const state = create(\n *   baseState,\n *   (draft) => {\n *     draft.foo.bar = 'str2';\n *   },\n * );\n *\n * expect(state).toEqual({ foo: { bar: 'str2' }, arr: [] });\n * expect(state).not.toBe(baseState);\n * expect(state.foo).not.toBe(baseState.foo);\n * expect(state.arr).toBe(baseState.arr);\n * expect(Object.isFrozen(state)).toBeTruthy();\n * ```\n */\nconst makeCreator = (arg) => {\n    if (arg !== undefined &&\n        Object.prototype.toString.call(arg) !== '[object Object]') {\n        throw new Error(`Invalid options: ${String(arg)}, 'options' should be an object.`);\n    }\n    return function create(arg0, arg1, arg2) {\n        var _a, _b, _c;\n        if (typeof arg0 === 'function' && typeof arg1 !== 'function') {\n            return function (base, ...args) {\n                return create(base, (draft) => arg0.call(this, draft, ...args), arg1);\n            };\n        }\n        const base = arg0;\n        const mutate = arg1;\n        let options = arg2;\n        if (typeof arg1 !== 'function') {\n            options = arg1;\n        }\n        if (options !== undefined &&\n            Object.prototype.toString.call(options) !== '[object Object]') {\n            throw new Error(`Invalid options: ${options}, 'options' should be an object.`);\n        }\n        options = Object.assign(Object.assign({}, arg), options);\n        const state = isDraft(base) ? current(base) : base;\n        const mark = Array.isArray(options.mark)\n            ? ((value, types) => {\n                for (const mark of options.mark) {\n                    if (typeof mark !== 'function') {\n                        throw new Error(`Invalid mark: ${mark}, 'mark' should be a function.`);\n                    }\n                    const result = mark(value, types);\n                    if (result) {\n                        return result;\n                    }\n                }\n                return;\n            })\n            : options.mark;\n        const enablePatches = (_a = options.enablePatches) !== null && _a !== void 0 ? _a : false;\n        const strict = (_b = options.strict) !== null && _b !== void 0 ? _b : false;\n        const enableAutoFreeze = (_c = options.enableAutoFreeze) !== null && _c !== void 0 ? _c : false;\n        const _options = {\n            enableAutoFreeze,\n            mark,\n            strict,\n            enablePatches,\n        };\n        if (!isDraftable(state, _options) &&\n            typeof state === 'object' &&\n            state !== null) {\n            throw new Error(`Invalid base state: create() only supports plain objects, arrays, Set, Map or using mark() to mark the state as immutable.`);\n        }\n        const [draft, finalize] = draftify(state, _options);\n        if (typeof arg1 !== 'function') {\n            if (!isDraftable(state, _options)) {\n                throw new Error(`Invalid base state: create() only supports plain objects, arrays, Set, Map or using mark() to mark the state as immutable.`);\n            }\n            return [draft, finalize];\n        }\n        let result;\n        try {\n            result = mutate(draft);\n        }\n        catch (error) {\n            revokeProxy(getProxyDraft(draft));\n            throw error;\n        }\n        const returnValue = (value) => {\n            const proxyDraft = getProxyDraft(draft);\n            if (!isDraft(value)) {\n                if (value !== undefined &&\n                    !isEqual(value, draft) &&\n                    (proxyDraft === null || proxyDraft === void 0 ? void 0 : proxyDraft.operated)) {\n                    throw new Error(`Either the value is returned as a new non-draft value, or only the draft is modified without returning any value.`);\n                }\n                const rawReturnValue = value === null || value === void 0 ? void 0 : value[RAW_RETURN_SYMBOL];\n                if (rawReturnValue) {\n                    const _value = rawReturnValue[0];\n                    if (_options.strict && typeof value === 'object' && value !== null) {\n                        handleReturnValue({\n                            rootDraft: proxyDraft,\n                            value,\n                            useRawReturn: true,\n                        });\n                    }\n                    return finalize([_value]);\n                }\n                if (value !== undefined) {\n                    if (typeof value === 'object' && value !== null) {\n                        handleReturnValue({ rootDraft: proxyDraft, value });\n                    }\n                    return finalize([value]);\n                }\n            }\n            if (value === draft || value === undefined) {\n                return finalize([]);\n            }\n            const returnedProxyDraft = getProxyDraft(value);\n            if (_options === returnedProxyDraft.options) {\n                if (returnedProxyDraft.operated) {\n                    throw new Error(`Cannot return a modified child draft.`);\n                }\n                return finalize([current(value)]);\n            }\n            return finalize([value]);\n        };\n        if (result instanceof Promise) {\n            return result.then(returnValue, (error) => {\n                revokeProxy(getProxyDraft(draft));\n                throw error;\n            });\n        }\n        return returnValue(result);\n    };\n};\n\n/**\n * `create(baseState, callback, options)` to create the next state\n *\n * ## Example\n *\n * ```ts\n * import { create } from '../index';\n *\n * const baseState = { foo: { bar: 'str' }, arr: [] };\n * const state = create(\n *   baseState,\n *   (draft) => {\n *     draft.foo.bar = 'str2';\n *   },\n * );\n *\n * expect(state).toEqual({ foo: { bar: 'str2' }, arr: [] });\n * expect(state).not.toBe(baseState);\n * expect(state.foo).not.toBe(baseState.foo);\n * expect(state.arr).toBe(baseState.arr);\n * ```\n */\nconst create = makeCreator();\n\n/**\n * `apply(state, patches)` to apply patches to state\n *\n * ## Example\n *\n * ```ts\n * import { create, apply } from '../index';\n *\n * const baseState = { foo: { bar: 'str' }, arr: [] };\n * const [state, patches] = create(\n *   baseState,\n *   (draft) => {\n *     draft.foo.bar = 'str2';\n *   },\n *   { enablePatches: true }\n * );\n * expect(state).toEqual({ foo: { bar: 'str2' }, arr: [] });\n * expect(patches).toEqual([{ op: 'replace', path: ['foo', 'bar'], value: 'str2' }]);\n * expect(state).toEqual(apply(baseState, patches));\n * ```\n */\nfunction apply(state, patches, applyOptions) {\n    let i;\n    for (i = patches.length - 1; i >= 0; i -= 1) {\n        const { value, op, path } = patches[i];\n        if ((!path.length && op === Operation.Replace) ||\n            (path === '' && op === Operation.Add)) {\n            state = value;\n            break;\n        }\n    }\n    if (i > -1) {\n        patches = patches.slice(i + 1);\n    }\n    const mutate = (draft) => {\n        patches.forEach((patch) => {\n            const { path: _path, op } = patch;\n            const path = unescapePath(_path);\n            let base = draft;\n            for (let index = 0; index < path.length - 1; index += 1) {\n                const parentType = getType(base);\n                let key = path[index];\n                if (typeof key !== 'string' && typeof key !== 'number') {\n                    key = String(key);\n                }\n                if (((parentType === 0 /* DraftType.Object */ ||\n                    parentType === 1 /* DraftType.Array */) &&\n                    (key === '__proto__' || key === 'constructor')) ||\n                    (typeof base === 'function' && key === 'prototype')) {\n                    throw new Error(`Patching reserved attributes like __proto__ and constructor is not allowed.`);\n                }\n                // use `index` in Set draft\n                base = get(parentType === 3 /* DraftType.Set */ ? Array.from(base) : base, key);\n                if (typeof base !== 'object') {\n                    throw new Error(`Cannot apply patch at '${path.join('/')}'.`);\n                }\n            }\n            const type = getType(base);\n            // ensure the original patch is not modified.\n            const value = deepClone(patch.value);\n            const key = path[path.length - 1];\n            switch (op) {\n                case Operation.Replace:\n                    switch (type) {\n                        case 2 /* DraftType.Map */:\n                            return base.set(key, value);\n                        case 3 /* DraftType.Set */:\n                            throw new Error(`Cannot apply replace patch to set.`);\n                        default:\n                            return (base[key] = value);\n                    }\n                case Operation.Add:\n                    switch (type) {\n                        case 1 /* DraftType.Array */:\n                            // If the \"-\" character is used to\n                            // index the end of the array (see [RFC6901](https://datatracker.ietf.org/doc/html/rfc6902)),\n                            // this has the effect of appending the value to the array.\n                            return key === '-'\n                                ? base.push(value)\n                                : base.splice(key, 0, value);\n                        case 2 /* DraftType.Map */:\n                            return base.set(key, value);\n                        case 3 /* DraftType.Set */:\n                            return base.add(value);\n                        default:\n                            return (base[key] = value);\n                    }\n                case Operation.Remove:\n                    switch (type) {\n                        case 1 /* DraftType.Array */:\n                            return base.splice(key, 1);\n                        case 2 /* DraftType.Map */:\n                            return base.delete(key);\n                        case 3 /* DraftType.Set */:\n                            return base.delete(patch.value);\n                        default:\n                            return delete base[key];\n                    }\n                default:\n                    throw new Error(`Unsupported patch operation: ${op}.`);\n            }\n        });\n    };\n    if (applyOptions === null || applyOptions === void 0 ? void 0 : applyOptions.mutable) {\n        {\n            if (Object.keys(applyOptions).filter((key) => key !== 'mutable').length) {\n                console.warn('The \"mutable\" option is not allowed to be used with other options.');\n            }\n        }\n        mutate(state);\n        return undefined;\n    }\n    if (isDraft(state)) {\n        if (applyOptions !== undefined) {\n            throw new Error(`Cannot apply patches with options to a draft.`);\n        }\n        mutate(state);\n        return state;\n    }\n    return create(state, mutate, Object.assign(Object.assign({}, applyOptions), { enablePatches: false }));\n}\n\n/**\n * `original(draft)` to get original state in the draft mutation function.\n *\n * ## Example\n *\n * ```ts\n * import { create, original } from '../index';\n *\n * const baseState = { foo: { bar: 'str' }, arr: [] };\n * const state = create(\n *   baseState,\n *   (draft) => {\n *     draft.foo.bar = 'str2';\n *     expect(original(draft.foo)).toEqual({ bar: 'str' });\n *   }\n * );\n * ```\n */\nfunction original(target) {\n    const proxyDraft = getProxyDraft(target);\n    if (!proxyDraft) {\n        throw new Error(`original() is only used for a draft, parameter: ${target}`);\n    }\n    return proxyDraft.original;\n}\n\n/**\n * Use rawReturn() to wrap the return value to skip the draft check and thus improve performance.\n *\n * ## Example\n *\n * ```ts\n * import { create, rawReturn } from '../index';\n *\n * const baseState = { foo: { bar: 'str' }, arr: [] };\n * const state = create(\n *   baseState,\n *   (draft) => {\n *     return rawReturn(baseState);\n *   },\n * );\n * expect(state).toBe(baseState);\n * ```\n */\nfunction rawReturn(value) {\n    if (arguments.length === 0) {\n        throw new Error('rawReturn() must be called with a value.');\n    }\n    if (arguments.length > 1) {\n        throw new Error('rawReturn() must be called with one argument.');\n    }\n    if (value !== undefined &&\n        (typeof value !== 'object' || value === null)) {\n        console.warn('rawReturn() must be called with an object(including plain object, arrays, Set, Map, etc.) or `undefined`, other types do not need to be returned via rawReturn().');\n    }\n    return {\n        [RAW_RETURN_SYMBOL]: [value],\n    };\n}\n\nconst constructorString = Object.prototype.constructor.toString();\n/**\n * Check if the value is a simple object(No prototype chain object or iframe same-origin object),\n * support case: https://github.com/unadlib/mutative/issues/17\n */\nconst isSimpleObject = (value) => {\n    if (!value || typeof value !== 'object')\n        return false;\n    const prototype = Object.getPrototypeOf(value);\n    if (prototype === null) {\n        return true;\n    }\n    const constructor = Object.hasOwnProperty.call(prototype, 'constructor') &&\n        prototype.constructor;\n    if (constructor === Object)\n        return true;\n    return (typeof constructor === 'function' &&\n        Function.toString.call(constructor) === constructorString);\n};\nconst markSimpleObject = (value) => {\n    if (isSimpleObject(value)) {\n        return dataTypes.immutable;\n    }\n    return;\n};\n\n/**\n * Cast a value to an Draft type value.\n */\nfunction castDraft(value) {\n    return value;\n}\n/**\n * Cast a value to an Immutable type value.\n */\nfunction castImmutable(value) {\n    return value;\n}\n/**\n * Cast a value to an Mutable type value.\n */\nfunction castMutable(draft) {\n    return draft;\n}\n\nexport { apply, castDraft, castImmutable, castMutable, create, current, isDraft, isDraftable, makeCreator, markSimpleObject, original, rawReturn, unsafe };\n//# sourceMappingURL=mutative.esm.mjs.map\n","export function areObjectKeysEqual(a, b) {\n    const ak = Object.keys(a);\n    const bk = Object.keys(b);\n    return (ak.length === bk.length && Object.keys(a).every((k) => b.hasOwnProperty(k)));\n}\nexport function areObjectsShallowEqual(obj1, obj2) {\n    return (Object.keys(obj1).length === Object.keys(obj2).length &&\n        Object.keys(obj1).every((key) => obj2.hasOwnProperty(key) && obj1[key] === obj2[key]));\n}\nexport function areObjectsDeepEqual(obj1, obj2) {\n    if (typeof obj1 !== 'object' ||\n        typeof obj2 !== 'object' ||\n        obj1 === null ||\n        obj2 === null) {\n        return obj1 === obj2;\n    }\n    if (!areObjectKeysEqual(obj1, obj2)) {\n        return false;\n    }\n    return Object.keys(obj1).every((key) => areObjectsDeepEqual(obj1[key], obj2[key]));\n}\nexport function immutableRemoveUndefined(obj) {\n    if (!isObject(obj)) {\n        return obj;\n    }\n    const result = {};\n    for (const [key, value] of Object.entries(obj)) {\n        if (value === undefined)\n            continue;\n        result[key] = value;\n    }\n    return result;\n}\nexport function immutableDeepMerge(target, source) {\n    if (!isObject(target) || !isObject(source)) {\n        return source;\n    }\n    const result = Object.assign({}, target);\n    for (const key of Object.keys(source)) {\n        if (source[key] === undefined)\n            continue;\n        if (source[key] === null) {\n            delete result[key];\n            continue;\n        }\n        const areBothObjects = isObject(target[key]) && isObject(source[key]);\n        result[key] = areBothObjects\n            ? immutableDeepMerge(target[key], source[key])\n            : source[key];\n    }\n    return result;\n}\nexport function immutableDeepReplace(target, replaceValue, replacementValue) {\n    if (!isObject(target)) {\n        return target;\n    }\n    const result = {};\n    for (const [key, value] of Object.entries(target)) {\n        result[key] = isObject(value)\n            ? immutableDeepReplace(value, replaceValue, replacementValue)\n            : value === replaceValue\n                ? replacementValue\n                : value;\n    }\n    return result;\n}\nexport function isObject(val) {\n    return typeof val === 'object' && val !== null && !Array.isArray(val);\n}\nexport function immutableOmitValue(obj, v) { }\n/**\n * Like `assocInMutative`, but\n *\n * - for arrays: inserts the value at the specified index, instead of replacing it\n */\nexport function insertInMutative(obj, path, value) {\n    if (!obj) {\n        return;\n    }\n    if (path.length === 0) {\n        return;\n    }\n    let current = obj || {};\n    for (let i = 0; i < path.length - 1; i++) {\n        const key = path[i];\n        if (!(key in current) || typeof current[key] !== 'object') {\n            current[key] = typeof path[i + 1] === 'number' ? [] : {};\n        }\n        current = current[key];\n    }\n    const key = path[path.length - 1];\n    if (Array.isArray(current) && typeof key === 'number') {\n        current.splice(key, 0, value);\n    }\n    else {\n        current[key] = value;\n    }\n}\nexport function assocInMutative(obj, path, value) {\n    if (!obj) {\n        return;\n    }\n    if (path.length === 0) {\n        return;\n    }\n    let current = obj || {};\n    for (let i = 0; i < path.length - 1; i++) {\n        const key = path[i];\n        if (!(key in current) || typeof current[key] !== 'object') {\n            current[key] = typeof path[i + 1] === 'number' ? [] : {};\n        }\n        current = current[key];\n    }\n    current[path[path.length - 1]] = value;\n}\nexport function dissocInMutative(obj, path) {\n    if (!obj) {\n        return;\n    }\n    if (path.length === 0) {\n        return;\n    }\n    const [key, ...restPath] = path;\n    if (!(key in obj)) {\n        return;\n    }\n    if (restPath.length === 0) {\n        if (Array.isArray(obj)) {\n            obj.splice(key, 1);\n        }\n        else {\n            delete obj[key];\n        }\n        return;\n    }\n    dissocInMutative(obj[key], restPath);\n    if (isEmpty(obj[key])) {\n        delete obj[key];\n    }\n}\nfunction isEmpty(obj) {\n    return obj && Object.keys(obj).length === 0;\n}\n//# sourceMappingURL=object.js.map","import { create } from 'mutative';\nimport { immutableDeepMerge } from './utils/object.js';\nfunction hasEA(attr) {\n    return attr['cardinality'] === 'one';\n}\nfunction isRef(attr) {\n    return attr['value-type'] === 'ref';\n}\nexport function isBlob(attr) {\n    return attr['value-type'] === 'blob';\n}\nfunction getAttr(attrs, attrId) {\n    return attrs[attrId];\n}\nfunction getInMap(obj, path) {\n    return path.reduce((acc, key) => acc && acc.get(key), obj);\n}\nfunction deleteInMap(m, path) {\n    if (path.length === 0)\n        throw new Error('path must have at least one element');\n    if (path.length === 1) {\n        m.delete(path[0]);\n        return;\n    }\n    const [head, ...tail] = path;\n    if (!m.has(head))\n        return;\n    deleteInMap(m.get(head), tail);\n}\nfunction setInMap(m, path, value) {\n    if (path.length === 0)\n        throw new Error('path must have at least one element');\n    if (path.length === 1) {\n        m.set(path[0], value);\n        return;\n    }\n    const [head, ...tail] = path;\n    let nextM = m.get(head);\n    if (!nextM) {\n        nextM = new Map();\n        m.set(head, nextM);\n    }\n    setInMap(nextM, tail, value);\n}\nfunction createTripleIndexes(attrs, triples) {\n    const eav = new Map();\n    const aev = new Map();\n    const vae = new Map();\n    for (const triple of triples) {\n        const [eid, aid, v, t] = triple;\n        const attr = getAttr(attrs, aid);\n        if (!attr) {\n            console.warn('no such attr', eid, attrs);\n            continue;\n        }\n        if (isRef(attr)) {\n            setInMap(vae, [v, aid, eid], triple);\n        }\n        setInMap(eav, [eid, aid, v], triple);\n        setInMap(aev, [aid, eid, v], triple);\n    }\n    return { eav, aev, vae };\n}\nfunction createAttrIndexes(attrs) {\n    const blobAttrs = new Map();\n    const primaryKeys = new Map();\n    const forwardIdents = new Map();\n    const revIdents = new Map();\n    for (const attr of Object.values(attrs)) {\n        const fwdIdent = attr['forward-identity'];\n        const [_, fwdEtype, fwdLabel] = fwdIdent;\n        const revIdent = attr['reverse-identity'];\n        setInMap(forwardIdents, [fwdEtype, fwdLabel], attr);\n        if (isBlob(attr)) {\n            setInMap(blobAttrs, [fwdEtype, fwdLabel], attr);\n        }\n        if (attr['primary?']) {\n            setInMap(primaryKeys, [fwdEtype], attr);\n        }\n        if (revIdent) {\n            const [_, revEtype, revLabel] = revIdent;\n            setInMap(revIdents, [revEtype, revLabel], attr);\n        }\n    }\n    return { blobAttrs, primaryKeys, forwardIdents, revIdents };\n}\nexport function toJSON(store) {\n    return {\n        __type: store.__type,\n        attrs: store.attrs,\n        triples: allMapValues(store.eav, 3),\n        cardinalityInference: store.cardinalityInference,\n        linkIndex: store.linkIndex,\n    };\n}\nexport function fromJSON(storeJSON) {\n    return createStore(storeJSON.attrs, storeJSON.triples, storeJSON.cardinalityInference, storeJSON.linkIndex);\n}\nfunction resetAttrIndexes(store) {\n    store.attrIndexes = createAttrIndexes(store.attrs);\n}\nexport function createStore(attrs, triples, enableCardinalityInference, linkIndex) {\n    const store = createTripleIndexes(attrs, triples);\n    store.attrs = attrs;\n    store.attrIndexes = createAttrIndexes(attrs);\n    store.cardinalityInference = enableCardinalityInference;\n    store.linkIndex = linkIndex;\n    store.__type = 'store';\n    return store;\n}\n// We may have local triples with lookup refs in them,\n// we need to convert those lookup refs to eids to insert them\n// into the store. If we can't find the lookup ref locally,\n// then we drop the triple and have to wait for the server response\n// to see the optimistic updates.\nfunction resolveLookupRefs(store, triple) {\n    var _a, _b;\n    let eid;\n    // Check if `e` is a lookup ref\n    if (Array.isArray(triple[0])) {\n        const [a, v] = triple[0];\n        const eMaps = store.aev.get(a);\n        if (!eMaps) {\n            // We don't have the attr, so don't try to add the\n            // triple to the store\n            return null;\n        }\n        // This would be a lot more efficient with a ave index\n        const triples = allMapValues(eMaps, 2);\n        eid = (_a = triples.find((x) => x[2] === v)) === null || _a === void 0 ? void 0 : _a[0];\n    }\n    else {\n        eid = triple[0];\n    }\n    if (!eid) {\n        // We don't know the eid that the ref refers to, so\n        // we can't add the triple to the store.\n        return null;\n    }\n    // Check if v is a lookup ref\n    const lookupV = triple[2];\n    if (Array.isArray(lookupV) &&\n        lookupV.length === 2 &&\n        store.aev.get(lookupV[0])) {\n        const [a, v] = lookupV;\n        const eMaps = store.aev.get(a);\n        if (!eMaps) {\n            // We don't have the attr, so don't try to add the\n            // triple to the store\n            return null;\n        }\n        const triples = allMapValues(eMaps, 2);\n        const value = (_b = triples.find((x) => x[2] === v)) === null || _b === void 0 ? void 0 : _b[0];\n        if (!value) {\n            return null;\n        }\n        const [_e, aid, _v, ...rest] = triple;\n        return [eid, aid, value, ...rest];\n    }\n    else {\n        const [_, ...rest] = triple;\n        return [eid, ...rest];\n    }\n}\nfunction retractTriple(store, rawTriple) {\n    const triple = resolveLookupRefs(store, rawTriple);\n    if (!triple) {\n        return;\n    }\n    const [eid, aid, v] = triple;\n    const attr = getAttr(store.attrs, aid);\n    if (!attr) {\n        return;\n    }\n    deleteInMap(store.eav, [eid, aid, v]);\n    deleteInMap(store.aev, [aid, eid, v]);\n    if (isRef(attr)) {\n        deleteInMap(store.vae, [v, aid, eid]);\n    }\n}\nlet _seed = 0;\nfunction getCreatedAt(store, attr, triple) {\n    const [eid, aid, v] = triple;\n    let createdAt;\n    const t = getInMap(store.ea, [eid, aid, v]);\n    if (t) {\n        createdAt = t[3];\n    }\n    /**\n     * (XXX)\n     * Two hacks here, for generating a `createdAt`\n     *\n     * 1. We multiply Date.now() by 10, to make sure that\n     *  `createdAt` is always greater than anything the server\n     *   could return\n     *\n     *   We do this because right now we know we _only_ insert\n     *   triples as optimistic updates.\n     *\n     * 2. We increment by `_seed`, to make sure there are no\n     *    two triples with the same `createdAt`. This is\n     *    done to make tests more predictable.\n     *\n     * We may need to rethink this. Because we * 10, we can't\n     * use this value as an _actual_ `createdAt` timestamp.\n     * Eventually we may want too though; For example, we could\n     * use `createdAt` for each triple, to infer a `createdAt` and\n     * `updatedAt` value for each object.\n     */\n    return createdAt || Date.now() * 10 + _seed++;\n}\nfunction addTriple(store, rawTriple) {\n    var _a;\n    const triple = resolveLookupRefs(store, rawTriple);\n    if (!triple) {\n        return;\n    }\n    const [eid, aid, v] = triple;\n    const attr = getAttr(store.attrs, aid);\n    if (!attr) {\n        // (XXX): Due to the way we're handling attrs, it's\n        // possible to enter a state where we receive a triple without an attr.\n        // See: https://github.com/jsventures/instant-local/pull/132 for details.\n        // For now, if we receive a command without an attr, we no-op.\n        return;\n    }\n    const existingTriple = getInMap(store.eav, [eid, aid, v]);\n    // Reuse the created_at for a triple if it's already in the store.\n    // Prevents updates from temporarily pushing an entity to the top\n    // while waiting for the server response.\n    const t = (_a = existingTriple === null || existingTriple === void 0 ? void 0 : existingTriple[3]) !== null && _a !== void 0 ? _a : getCreatedAt(store, attr, triple);\n    const enhancedTriple = [eid, aid, v, t];\n    if (hasEA(attr)) {\n        setInMap(store.eav, [eid, aid], new Map([[v, enhancedTriple]]));\n        setInMap(store.aev, [aid, eid], new Map([[v, enhancedTriple]]));\n    }\n    else {\n        setInMap(store.eav, [eid, aid, v], enhancedTriple);\n        setInMap(store.aev, [aid, eid, v], enhancedTriple);\n    }\n    if (isRef(attr)) {\n        setInMap(store.vae, [v, aid, eid], enhancedTriple);\n    }\n}\nfunction mergeTriple(store, rawTriple) {\n    var _a;\n    const triple = resolveLookupRefs(store, rawTriple);\n    if (!triple) {\n        return;\n    }\n    const [eid, aid, update] = triple;\n    const attr = getAttr(store.attrs, aid);\n    if (!attr)\n        return;\n    if (!isBlob(attr))\n        throw new Error('merge operation is not supported for links');\n    const eavValuesMap = getInMap(store.eav, [eid, aid]);\n    if (!eavValuesMap)\n        return;\n    const currentTriple = (_a = eavValuesMap.values().next()) === null || _a === void 0 ? void 0 : _a.value;\n    if (!currentTriple)\n        return;\n    const currentValue = currentTriple[2];\n    const updatedValue = immutableDeepMerge(currentValue, update);\n    const enhancedTriple = [\n        eid,\n        aid,\n        updatedValue,\n        getCreatedAt(store, attr, currentTriple),\n    ];\n    setInMap(store.eav, [eid, aid], new Map([[updatedValue, enhancedTriple]]));\n}\nfunction deleteEntity(store, args) {\n    var _a, _b;\n    const [lookup, etype] = args;\n    const triple = resolveLookupRefs(store, [lookup]);\n    if (!triple) {\n        return;\n    }\n    const [id] = triple;\n    // delete forward links and attributes + cardinality one links\n    const eMap = store.eav.get(id);\n    if (eMap) {\n        for (const a of eMap.keys()) {\n            const attr = store.attrs[a];\n            // delete cascade refs\n            if (attr && attr['on-delete-reverse'] === 'cascade') {\n                allMapValues(eMap.get(a), 1).forEach(([e, a, v]) => { var _a; return deleteEntity(store, [v, (_a = attr['reverse-identity']) === null || _a === void 0 ? void 0 : _a[1]]); });\n            }\n            if (\n            // Fall back to deleting everything if we've rehydrated tx-steps from\n            // the store that didn't set `etype` in deleteEntity\n            !etype ||\n                // If we don't know about the attr, let's just get rid of it\n                !attr ||\n                // Make sure it matches the etype\n                ((_a = attr['forward-identity']) === null || _a === void 0 ? void 0 : _a[1]) === etype) {\n                deleteInMap(store.aev, [a, id]);\n                deleteInMap(store.eav, [id, a]);\n            }\n        }\n        // Clear out the eav index for `id` if we deleted all of the attributes\n        if (eMap.size === 0) {\n            deleteInMap(store.eav, [id]);\n        }\n    }\n    // delete reverse links\n    const vaeTriples = store.vae.get(id) && allMapValues(store.vae.get(id), 2);\n    if (vaeTriples) {\n        vaeTriples.forEach((triple) => {\n            var _a, _b;\n            const [e, a, v] = triple;\n            const attr = store.attrs[a];\n            if (!etype || !attr || ((_a = attr['reverse-identity']) === null || _a === void 0 ? void 0 : _a[1]) === etype) {\n                deleteInMap(store.eav, [e, a, v]);\n                deleteInMap(store.aev, [a, e, v]);\n                deleteInMap(store.vae, [v, a, e]);\n            }\n            if (attr && attr['on-delete'] === 'cascade') {\n                deleteEntity(store, [e, (_b = attr['forward-identity']) === null || _b === void 0 ? void 0 : _b[1]]);\n            }\n        });\n    }\n    // Clear out vae index for `id` if we deleted all the reverse attributes\n    if (((_b = store.vae.get(id)) === null || _b === void 0 ? void 0 : _b.size) === 0) {\n        deleteInMap(store.vae, [id]);\n    }\n}\n// (XXX): Whenever we change/delete attrs,\n// We indiscriminately reset the index map.\n// There are lots of opportunities for optimization:\n// * We _only_ need to run this indexes change. We could detect that\n// * We could batch this reset at the end\n// * We could add an ave index for all triples, so removing the\n//   right triples is easy and fast.\nfunction resetIndexMap(store, newTriples) {\n    const newIndexMap = createTripleIndexes(store.attrs, newTriples);\n    Object.keys(newIndexMap).forEach((key) => {\n        store[key] = newIndexMap[key];\n    });\n}\nfunction addAttr(store, [attr]) {\n    store.attrs[attr.id] = attr;\n    resetAttrIndexes(store);\n}\nfunction getAllTriples(store) {\n    return allMapValues(store.eav, 3);\n}\nfunction deleteAttr(store, [id]) {\n    if (!store.attrs[id])\n        return;\n    const newTriples = getAllTriples(store).filter(([_, aid]) => aid !== id);\n    delete store.attrs[id];\n    resetAttrIndexes(store);\n    resetIndexMap(store, newTriples);\n}\nfunction updateAttr(store, [partialAttr]) {\n    const attr = store.attrs[partialAttr.id];\n    if (!attr)\n        return;\n    store.attrs[partialAttr.id] = Object.assign(Object.assign({}, attr), partialAttr);\n    resetAttrIndexes(store);\n    resetIndexMap(store, getAllTriples(store));\n}\nfunction applyTxStep(store, txStep) {\n    const [action, ...args] = txStep;\n    switch (action) {\n        case 'add-triple':\n            addTriple(store, args);\n            break;\n        case 'deep-merge-triple':\n            mergeTriple(store, args);\n            break;\n        case 'retract-triple':\n            retractTriple(store, args);\n            break;\n        case 'delete-entity':\n            deleteEntity(store, args);\n            break;\n        case 'add-attr':\n            addAttr(store, args);\n            break;\n        case 'delete-attr':\n            deleteAttr(store, args);\n            break;\n        case 'update-attr':\n            updateAttr(store, args);\n            break;\n        case 'rule-params':\n            break;\n        default:\n            throw new Error(`unhandled transaction action: ${action}`);\n    }\n}\nexport function allMapValues(m, level, res = []) {\n    if (!m) {\n        return res;\n    }\n    if (level === 0) {\n        return res;\n    }\n    if (level === 1) {\n        for (const v of m.values()) {\n            res.push(v);\n        }\n        return res;\n    }\n    for (const v of m.values()) {\n        allMapValues(v, level - 1, res);\n    }\n    return res;\n}\nfunction triplesByValue(store, m, v) {\n    var _a, _b;\n    const res = [];\n    if (v === null || v === void 0 ? void 0 : v.hasOwnProperty('$not')) {\n        for (const candidate of m.keys()) {\n            if (v.$not !== candidate) {\n                res.push(m.get(candidate));\n            }\n        }\n        return res;\n    }\n    if (v === null || v === void 0 ? void 0 : v.hasOwnProperty('$isNull')) {\n        const { attrId, isNull, reverse } = v.$isNull;\n        if (reverse) {\n            for (const candidate of m.keys()) {\n                const vMap = store.vae.get(candidate);\n                const isValNull = !vMap || ((_a = vMap.get(attrId)) === null || _a === void 0 ? void 0 : _a.get(null)) || !vMap.get(attrId);\n                if (isNull ? isValNull : !isValNull) {\n                    res.push(m.get(candidate));\n                }\n            }\n        }\n        else {\n            const aMap = store.aev.get(attrId);\n            for (const candidate of m.keys()) {\n                const isValNull = !aMap || ((_b = aMap.get(candidate)) === null || _b === void 0 ? void 0 : _b.get(null)) || !aMap.get(candidate);\n                if (isNull ? isValNull : !isValNull) {\n                    res.push(m.get(candidate));\n                }\n            }\n        }\n        return res;\n    }\n    if (v === null || v === void 0 ? void 0 : v.$comparator) {\n        // TODO: A sorted index would be nice here\n        return allMapValues(m, 1).filter(v.$op);\n    }\n    const values = v.in || v.$in || [v];\n    for (const value of values) {\n        const triple = m.get(value);\n        if (triple) {\n            res.push(triple);\n        }\n    }\n    return res;\n}\n// A poor man's pattern matching\n// Returns either eav, ea, ev, av, v, or ''\nfunction whichIdx(e, a, v) {\n    let res = '';\n    if (e !== undefined) {\n        res += 'e';\n    }\n    if (a !== undefined) {\n        res += 'a';\n    }\n    if (v !== undefined) {\n        res += 'v';\n    }\n    return res;\n}\nexport function getTriples(store, [e, a, v]) {\n    var _a, _b;\n    const idx = whichIdx(e, a, v);\n    switch (idx) {\n        case 'e': {\n            const eMap = store.eav.get(e);\n            return allMapValues(eMap, 2);\n        }\n        case 'ea': {\n            const aMap = (_a = store.eav.get(e)) === null || _a === void 0 ? void 0 : _a.get(a);\n            return allMapValues(aMap, 1);\n        }\n        case 'eav': {\n            const aMap = (_b = store.eav.get(e)) === null || _b === void 0 ? void 0 : _b.get(a);\n            if (!aMap) {\n                return [];\n            }\n            return triplesByValue(store, aMap, v);\n        }\n        case 'ev': {\n            const eMap = store.eav.get(e);\n            if (!eMap) {\n                return [];\n            }\n            const res = [];\n            for (const aMap of eMap.values()) {\n                res.push(...triplesByValue(store, aMap, v));\n            }\n            return res;\n        }\n        case 'a': {\n            const aMap = store.aev.get(a);\n            return allMapValues(aMap, 2);\n        }\n        case 'av': {\n            const aMap = store.aev.get(a);\n            if (!aMap) {\n                return [];\n            }\n            const res = [];\n            for (const eMap of aMap.values()) {\n                res.push(...triplesByValue(store, eMap, v));\n            }\n            return res;\n        }\n        case 'v': {\n            const res = [];\n            for (const eMap of store.eav.values()) {\n                for (const aMap of eMap.values()) {\n                    res.push(...triplesByValue(store, aMap, v));\n                }\n            }\n        }\n        default: {\n            return allMapValues(store.eav, 3);\n        }\n    }\n}\nexport function getAsObject(store, attrs, e) {\n    var _a;\n    const obj = {};\n    for (const [label, attr] of attrs.entries()) {\n        const aMap = (_a = store.eav.get(e)) === null || _a === void 0 ? void 0 : _a.get(attr.id);\n        const triples = allMapValues(aMap, 1);\n        for (const triple of triples) {\n            obj[label] = triple[2];\n        }\n    }\n    return obj;\n}\nexport function getAttrByFwdIdentName(store, inputEtype, inputLabel) {\n    var _a;\n    return (_a = store.attrIndexes.forwardIdents.get(inputEtype)) === null || _a === void 0 ? void 0 : _a.get(inputLabel);\n}\nexport function getAttrByReverseIdentName(store, inputEtype, inputLabel) {\n    var _a;\n    return (_a = store.attrIndexes.revIdents.get(inputEtype)) === null || _a === void 0 ? void 0 : _a.get(inputLabel);\n}\nexport function getBlobAttrs(store, etype) {\n    return store.attrIndexes.blobAttrs.get(etype);\n}\nexport function getPrimaryKeyAttr(store, etype) {\n    var _a;\n    const fromPrimary = store.attrIndexes.primaryKeys.get(etype);\n    if (fromPrimary) {\n        return fromPrimary;\n    }\n    return (_a = store.attrIndexes.forwardIdents.get(etype)) === null || _a === void 0 ? void 0 : _a.get('id');\n}\nexport function transact(store, txSteps) {\n    return create(store, (draft) => {\n        txSteps.forEach((txStep) => {\n            applyTxStep(draft, txStep);\n        });\n    });\n}\n//# sourceMappingURL=store.js.map","// 1. patternMatch\nimport { getTriples } from './store.js';\nfunction isVariable(x) {\n    return typeof x === 'string' && x.startsWith('?');\n}\nfunction matchVariable(variable, triplePart, context) {\n    if (context.hasOwnProperty(variable)) {\n        const bound = context[variable];\n        return matchPart(bound, triplePart, context);\n    }\n    return Object.assign(Object.assign({}, context), { [variable]: triplePart });\n}\nfunction matchExact(patternPart, triplePart, context) {\n    return patternPart === triplePart ? context : null;\n}\nfunction matcherForPatternPart(patternPart) {\n    switch (typeof patternPart) {\n        case 'string':\n            return patternPart.startsWith('?') ? matchVariable : matchExact;\n        default:\n            return matchExact;\n    }\n}\nconst validArgMapProps = [\n    'in',\n    '$in',\n    '$not',\n    '$isNull',\n    '$comparator', // covers all of $gt, $lt, etc.\n];\n// Checks if an object is an args map\nfunction isArgsMap(patternPart) {\n    for (const prop of validArgMapProps) {\n        if (patternPart.hasOwnProperty(prop)) {\n            return true;\n        }\n    }\n    return false;\n}\nfunction matchPart(patternPart, triplePart, context) {\n    if (!context)\n        return null;\n    if (typeof patternPart === 'object') {\n        // This is an args map, so we'll have already fitered the triples\n        // in `getRelevantTriples`\n        if (isArgsMap(patternPart)) {\n            return context;\n        }\n        return null;\n    }\n    const matcher = matcherForPatternPart(patternPart);\n    return matcher(patternPart, triplePart, context);\n}\nexport function matchPattern(pattern, triple, context) {\n    return pattern.reduce((context, patternPart, idx) => {\n        const triplePart = triple[idx];\n        return matchPart(patternPart, triplePart, context);\n    }, context);\n}\n// 2. querySingle\nexport function querySingle(store, pattern, context) {\n    return relevantTriples(store, pattern, context)\n        .map((triple) => matchPattern(pattern, triple, context))\n        .filter((x) => x);\n}\n// 3. queryWhere\nfunction queryPattern(store, pattern, contexts) {\n    if (pattern.or) {\n        return pattern.or.patterns.flatMap((patterns) => {\n            return queryWhere(store, patterns, contexts);\n        });\n    }\n    if (pattern.and) {\n        return pattern.and.patterns.reduce((contexts, patterns) => {\n            return queryWhere(store, patterns, contexts);\n        }, contexts);\n    }\n    return contexts.flatMap((context) => querySingle(store, pattern, context));\n}\nexport function queryWhere(store, patterns, contexts = [{}]) {\n    return patterns.reduce((contexts, pattern) => {\n        return queryPattern(store, pattern, contexts);\n    }, contexts);\n}\n// 4. query\nfunction actualize(context, find) {\n    if (Array.isArray(find)) {\n        return find.map((findPart) => actualize(context, findPart));\n    }\n    return isVariable(find) ? context[find] : find;\n}\nexport function query(store, { find, where }) {\n    const contexts = queryWhere(store, where);\n    return contexts.map((context) => actualize(context, find));\n}\n// 5. Index\nfunction relevantTriples(store, pattern, context) {\n    return getTriples(store, actualize(context, pattern));\n}\n//# sourceMappingURL=datalog.js.map","// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\nlet getRandomValues;\nconst rnds8 = new Uint8Array(16);\nexport default function rng() {\n  // lazy load so that environments that need to polyfill have a chance to do so\n  if (!getRandomValues) {\n    // getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation.\n    getRandomValues = typeof crypto !== 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto);\n\n    if (!getRandomValues) {\n      throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n    }\n  }\n\n  return getRandomValues(rnds8);\n}","import validate from './validate.js';\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\n\nconst byteToHex = [];\n\nfor (let i = 0; i < 256; ++i) {\n  byteToHex.push((i + 0x100).toString(16).slice(1));\n}\n\nexport function unsafeStringify(arr, offset = 0) {\n  // Note: Be careful editing this code!  It's been tuned for performance\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n  return byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]];\n}\n\nfunction stringify(arr, offset = 0) {\n  const uuid = unsafeStringify(arr, offset); // Consistency check for valid UUID.  If this throws, it's likely due to one\n  // of the following:\n  // - One or more input array values don't map to a hex octet (leading to\n  // \"undefined\" in the uuid)\n  // - Invalid input values for the RFC `version` or `variant` fields\n\n  if (!validate(uuid)) {\n    throw TypeError('Stringified UUID is invalid');\n  }\n\n  return uuid;\n}\n\nexport default stringify;","const randomUUID = typeof crypto !== 'undefined' && crypto.randomUUID && crypto.randomUUID.bind(crypto);\nexport default {\n  randomUUID\n};","import native from './native.js';\nimport rng from './rng.js';\nimport { unsafeStringify } from './stringify.js';\n\nfunction v4(options, buf, offset) {\n  if (native.randomUUID && !buf && !options) {\n    return native.randomUUID();\n  }\n\n  options = options || {};\n  const rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    offset = offset || 0;\n\n    for (let i = 0; i < 16; ++i) {\n      buf[offset + i] = rnds[i];\n    }\n\n    return buf;\n  }\n\n  return unsafeStringify(rnds);\n}\n\nexport default v4;","import { v4 } from 'uuid';\nfunction uuidToByteArray(uuid) {\n    const hex = uuid.replace(/-/g, '');\n    const bytes = [];\n    for (let i = 0; i < hex.length; i += 2) {\n        bytes.push(parseInt(hex.substring(i, i + 2), 16));\n    }\n    return bytes;\n}\nfunction compareByteArrays(a, b) {\n    for (let i = 0; i < a.length; i++) {\n        if (a[i] < b[i])\n            return -1;\n        if (a[i] > b[i])\n            return 1;\n    }\n    return 0;\n}\nexport function uuidCompare(uuid_a, uuid_b) {\n    return compareByteArrays(uuidToByteArray(uuid_a), uuidToByteArray(uuid_b));\n}\nfunction id() {\n    return v4();\n}\nexport default id;\n//# sourceMappingURL=uuid.js.map","import { query as datalogQuery } from './datalog.js';\nimport { uuidCompare } from \"./utils/uuid.js\";\nimport * as s from './store.js';\n// Pattern variables\n// -----------------\nlet _seed = 0;\nfunction wildcard(friendlyName) {\n    return makeVarImpl(`_${friendlyName}`, _seed++);\n}\nfunction makeVarImpl(x, level) {\n    return `?${x}-${level}`;\n}\n// Where\n// -----------------\nclass AttrNotFoundError extends Error {\n    constructor(message) {\n        super(message);\n        this.name = 'AttrNotFoundError';\n    }\n}\nfunction idAttr(store, ns) {\n    const attr = s.getPrimaryKeyAttr(store, ns);\n    if (!attr) {\n        throw new AttrNotFoundError(`Could not find id attr for ${ns}`);\n    }\n    return attr;\n}\nfunction defaultWhere(makeVar, store, etype, level) {\n    return [eidWhere(makeVar, store, etype, level)];\n}\nfunction eidWhere(makeVar, store, etype, level) {\n    return [\n        makeVar(etype, level),\n        idAttr(store, etype).id,\n        makeVar(etype, level),\n        makeVar('time', level),\n    ];\n}\nfunction replaceInAttrPat(attrPat, needle, v) {\n    return attrPat.map((x) => (x === needle ? v : x));\n}\nfunction refAttrPat(makeVar, store, etype, level, label) {\n    const fwdAttr = s.getAttrByFwdIdentName(store, etype, label);\n    const revAttr = s.getAttrByReverseIdentName(store, etype, label);\n    const attr = fwdAttr || revAttr;\n    if (!attr) {\n        throw new AttrNotFoundError(`Could not find attr for ${[etype, label]}`);\n    }\n    if (attr['value-type'] !== 'ref') {\n        throw new Error(`Attr ${attr.id} is not a ref`);\n    }\n    const [_f, fwdEtype] = attr['forward-identity'];\n    const [_r, revEtype] = attr['reverse-identity'];\n    const nextLevel = level + 1;\n    const attrPat = fwdAttr\n        ? [\n            makeVar(fwdEtype, level),\n            attr.id,\n            makeVar(revEtype, nextLevel),\n            wildcard('time'),\n        ]\n        : [\n            makeVar(fwdEtype, nextLevel),\n            attr.id,\n            makeVar(revEtype, level),\n            wildcard('time'),\n        ];\n    const nextEtype = fwdAttr ? revEtype : fwdEtype;\n    const isForward = Boolean(fwdAttr);\n    return [nextEtype, nextLevel, attrPat, attr, isForward];\n}\nfunction makeLikeMatcher(caseSensitive, pattern) {\n    if (typeof pattern !== 'string') {\n        return function likeMatcher(_value) {\n            return false;\n        };\n    }\n    const escapedPattern = pattern.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n    const regexPattern = escapedPattern.replace(/%/g, '.*').replace(/_/g, '.');\n    const regex = new RegExp(`^${regexPattern}$`, caseSensitive ? undefined : 'i');\n    return function likeMatcher(value) {\n        if (typeof value !== 'string') {\n            return false;\n        }\n        return regex.test(value);\n    };\n}\nfunction parseValue(attr, v) {\n    if (typeof v !== 'object' ||\n        v.hasOwnProperty('$in') ||\n        v.hasOwnProperty('in')) {\n        return v;\n    }\n    const isDate = attr['checked-data-type'] === 'date';\n    if (v.hasOwnProperty('$gt')) {\n        return {\n            $comparator: true,\n            $op: isDate\n                ? function gtDate(triple) {\n                    return new Date(triple[2]) > new Date(v.$gt);\n                }\n                : function gt(triple) {\n                    return triple[2] > v.$gt;\n                },\n        };\n    }\n    if (v.hasOwnProperty('$gte')) {\n        return {\n            $comparator: true,\n            $op: isDate\n                ? function gteDate(triple) {\n                    return new Date(triple[2]) >= new Date(v.$gte);\n                }\n                : function gte(triple) {\n                    return triple[2] >= v.$gte;\n                },\n        };\n    }\n    if (v.hasOwnProperty('$lt')) {\n        return {\n            $comparator: true,\n            $op: isDate\n                ? function ltDate(triple) {\n                    return new Date(triple[2]) < new Date(v.$lt);\n                }\n                : function lt(triple) {\n                    return triple[2] < v.$lt;\n                },\n        };\n    }\n    if (v.hasOwnProperty('$lte')) {\n        return {\n            $comparator: true,\n            $op: isDate\n                ? function lteDate(triple) {\n                    return new Date(triple[2]) <= new Date(v.$lte);\n                }\n                : function lte(triple) {\n                    return triple[2] <= v.$lte;\n                },\n        };\n    }\n    if (v.hasOwnProperty('$like')) {\n        const matcher = makeLikeMatcher(true, v.$like);\n        return {\n            $comparator: true,\n            $op: function like(triple) {\n                return matcher(triple[2]);\n            },\n        };\n    }\n    if (v.hasOwnProperty('$ilike')) {\n        const matcher = makeLikeMatcher(false, v.$ilike);\n        return {\n            $comparator: true,\n            $op: function ilike(triple) {\n                return matcher(triple[2]);\n            },\n        };\n    }\n    return v;\n}\nfunction valueAttrPat(makeVar, store, valueEtype, valueLevel, valueLabel, v) {\n    const fwdAttr = s.getAttrByFwdIdentName(store, valueEtype, valueLabel);\n    const revAttr = s.getAttrByReverseIdentName(store, valueEtype, valueLabel);\n    const attr = fwdAttr || revAttr;\n    if (!attr) {\n        throw new AttrNotFoundError(`No attr for etype = ${valueEtype} label = ${valueLabel}`);\n    }\n    if (v === null || v === void 0 ? void 0 : v.hasOwnProperty('$isNull')) {\n        const idAttr = s.getAttrByFwdIdentName(store, valueEtype, 'id');\n        if (!idAttr) {\n            throw new AttrNotFoundError(`No attr for etype = ${valueEtype} label = id`);\n        }\n        return [\n            makeVar(valueEtype, valueLevel),\n            idAttr.id,\n            { $isNull: { attrId: attr.id, isNull: v.$isNull, reverse: !fwdAttr } },\n            wildcard('time'),\n        ];\n    }\n    if (fwdAttr) {\n        return [\n            makeVar(valueEtype, valueLevel),\n            attr.id,\n            parseValue(attr, v),\n            wildcard('time'),\n        ];\n    }\n    return [v, attr.id, makeVar(valueEtype, valueLevel), wildcard('time')];\n}\nfunction refAttrPats(makeVar, store, etype, level, refsPath) {\n    const [lastEtype, lastLevel, attrPats] = refsPath.reduce((acc, label) => {\n        const [etype, level, attrPats] = acc;\n        const [nextEtype, nextLevel, attrPat] = refAttrPat(makeVar, store, etype, level, label);\n        return [nextEtype, nextLevel, [...attrPats, attrPat]];\n    }, [etype, level, []]);\n    return [lastEtype, lastLevel, attrPats];\n}\nfunction whereCondAttrPats(makeVar, store, etype, level, path, v) {\n    const refsPath = path.slice(0, path.length - 1);\n    const valueLabel = path[path.length - 1];\n    const [lastEtype, lastLevel, refPats] = refAttrPats(makeVar, store, etype, level, refsPath);\n    const valuePat = valueAttrPat(makeVar, store, lastEtype, lastLevel, valueLabel, v);\n    return refPats.concat([valuePat]);\n}\nfunction withJoin(where, join) {\n    return join ? [join].concat(where) : where;\n}\nfunction isOrClauses([k, v]) {\n    return k === 'or' && Array.isArray(v);\n}\nfunction isAndClauses([k, v]) {\n    return k === 'and' && Array.isArray(v);\n}\n// Creates a makeVar that will namespace symbols for or clauses\n// to prevent conflicts, except for the base etype\nfunction genMakeVar(baseMakeVar, joinSym, orIdx) {\n    return (x, lvl) => {\n        const base = baseMakeVar(x, lvl);\n        if (joinSym == base) {\n            return base;\n        }\n        return `${base}-${orIdx}`;\n    };\n}\nfunction parseWhereClauses(makeVar, clauseType /* 'or' | 'and' */, store, etype, level, whereValue) {\n    const joinSym = makeVar(etype, level);\n    const patterns = whereValue.map((w, i) => {\n        const makeNamespacedVar = genMakeVar(makeVar, joinSym, i);\n        return parseWhere(makeNamespacedVar, store, etype, level, w);\n    });\n    return { [clauseType]: { patterns, joinSym } };\n}\n// Given a path, returns a list of paths leading up to this path:\n// growPath([1, 2, 3]) -> [[1], [1, 2], [1, 2, 3]]\nfunction growPath(path) {\n    const ret = [];\n    for (let i = 1; i <= path.length; i++) {\n        ret.push(path.slice(0, i));\n    }\n    return ret;\n}\n// Returns array of pattern arrays that should be grouped in OR\n// to capture any intermediate nulls\nfunction whereCondAttrPatsForNullIsTrue(makeVar, store, etype, level, path) {\n    return growPath(path).map((path) => whereCondAttrPats(makeVar, store, etype, level, path, { $isNull: true }));\n}\nfunction parseWhere(makeVar, store, etype, level, where) {\n    return Object.entries(where).flatMap(([k, v]) => {\n        if (isOrClauses([k, v])) {\n            return parseWhereClauses(makeVar, 'or', store, etype, level, v);\n        }\n        if (isAndClauses([k, v])) {\n            return parseWhereClauses(makeVar, 'and', store, etype, level, v);\n        }\n        // Temporary hack until we have support for a uuid index on `id`\n        if (k === '$entityIdStartsWith') {\n            return [];\n        }\n        const path = k.split('.');\n        if (v === null || v === void 0 ? void 0 : v.hasOwnProperty('$not')) {\n            // `$not` won't pick up entities that are missing the attr, so we\n            // add in a `$isNull` to catch those too.\n            const notPats = whereCondAttrPats(makeVar, store, etype, level, path, v);\n            const nilPats = whereCondAttrPatsForNullIsTrue(makeVar, store, etype, level, path);\n            return [\n                {\n                    or: {\n                        patterns: [notPats, ...nilPats],\n                        joinSym: makeVar(etype, level),\n                    },\n                },\n            ];\n        }\n        if ((v === null || v === void 0 ? void 0 : v.hasOwnProperty('$isNull')) && v.$isNull === true && path.length > 1) {\n            // Make sure we're capturing all of the intermediate paths that might be null\n            // by checking for null at each step along the path\n            return [\n                {\n                    or: {\n                        patterns: whereCondAttrPatsForNullIsTrue(makeVar, store, etype, level, path),\n                        joinSym: makeVar(etype, level),\n                    },\n                },\n            ];\n        }\n        return whereCondAttrPats(makeVar, store, etype, level, path, v);\n    });\n}\nfunction makeWhere(store, etype, level, where) {\n    const makeVar = makeVarImpl;\n    if (!where) {\n        return defaultWhere(makeVar, store, etype, level);\n    }\n    const parsedWhere = parseWhere(makeVar, store, etype, level, where);\n    return parsedWhere.concat(defaultWhere(makeVar, store, etype, level));\n}\n// Find\n// -----------------\nfunction makeFind(makeVar, etype, level) {\n    return [makeVar(etype, level), makeVar('time', level)];\n}\n// extendObjects\n// -----------------\nfunction makeJoin(makeVar, store, etype, level, label, eid) {\n    const [nextEtype, nextLevel, pat, attr, isForward] = refAttrPat(makeVar, store, etype, level, label);\n    const actualized = replaceInAttrPat(pat, makeVar(etype, level), eid);\n    return [nextEtype, nextLevel, actualized, attr, isForward];\n}\nfunction extendObjects(makeVar, store, { etype, level, form }, objects) {\n    const childQueries = Object.keys(form).filter((c) => c !== '$');\n    if (!childQueries.length) {\n        return Object.values(objects);\n    }\n    return Object.entries(objects).map(function extendChildren([eid, parent]) {\n        const childResults = childQueries.map(function getChildResult(label) {\n            var _a, _b, _c;\n            const isSingular = Boolean(store.cardinalityInference &&\n                ((_c = (_b = (_a = store.linkIndex) === null || _a === void 0 ? void 0 : _a[etype]) === null || _b === void 0 ? void 0 : _b[label]) === null || _c === void 0 ? void 0 : _c.isSingular));\n            try {\n                const [nextEtype, nextLevel, join] = makeJoin(makeVar, store, etype, level, label, eid);\n                const childrenArray = queryOne(store, {\n                    etype: nextEtype,\n                    level: nextLevel,\n                    form: form[label],\n                    join,\n                });\n                const childOrChildren = isSingular ? childrenArray[0] : childrenArray;\n                return { [label]: childOrChildren };\n            }\n            catch (e) {\n                if (e instanceof AttrNotFoundError) {\n                    return { [label]: isSingular ? undefined : [] };\n                }\n                throw e;\n            }\n        });\n        return childResults.reduce(function reduceChildren(parent, child) {\n            return Object.assign(Object.assign({}, parent), child);\n        }, parent);\n    });\n}\n// resolveObjects\n// -----------------\nfunction shouldIgnoreAttr(attrs, id) {\n    const attr = attrs[id];\n    return attr['value-type'] === 'ref' && attr['forward-identity'][2] !== 'id';\n}\nfunction compareOrder([id_a, v_a], [id_b, v_b]) {\n    if (v_a === v_b || (v_a == null && v_b == null)) {\n        return uuidCompare(id_a, id_b);\n    }\n    if (v_b == null) {\n        return 1;\n    }\n    if (v_a == null) {\n        return -1;\n    }\n    if (v_a > v_b) {\n        return 1;\n    }\n    return -1;\n}\nfunction comparableDate(x) {\n    if (x == null) {\n        return x;\n    }\n    return new Date(x).getTime();\n}\nfunction isBefore(startCursor, orderAttr, direction, idVec) {\n    var _a;\n    const [c_e, _c_a, c_v, c_t] = startCursor;\n    const compareVal = direction === 'desc' ? 1 : -1;\n    if (((_a = orderAttr['forward-identity']) === null || _a === void 0 ? void 0 : _a[2]) === 'id') {\n        return compareOrder(idVec, [c_e, c_t]) === compareVal;\n    }\n    const [e, v] = idVec;\n    const v_new = orderAttr['checked-data-type'] === 'date' ? comparableDate(v) : v;\n    const c_v_new = orderAttr['checked-data-type'] === 'date' ? comparableDate(c_v) : c_v;\n    return compareOrder([e, v_new], [c_e, c_v_new]) === compareVal;\n}\nfunction orderAttrFromCursor(store, cursor) {\n    const cursorAttrId = cursor[1];\n    return store.attrs[cursorAttrId];\n}\nfunction orderAttrFromOrder(store, etype, order) {\n    const label = Object.keys(order)[0];\n    return s.getAttrByFwdIdentName(store, etype, label);\n}\nfunction getOrderAttr(store, etype, cursor, order) {\n    if (cursor) {\n        return orderAttrFromCursor(store, cursor);\n    }\n    if (order) {\n        return orderAttrFromOrder(store, etype, order);\n    }\n}\nfunction objectAttrs(store, etype, dq) {\n    var _a, _b;\n    if (!Array.isArray(dq.fields)) {\n        return s.getBlobAttrs(store, etype);\n    }\n    const attrs = new Map();\n    for (const field of dq.fields) {\n        const attr = s.getAttrByFwdIdentName(store, etype, field);\n        const label = (_a = attr === null || attr === void 0 ? void 0 : attr['forward-identity']) === null || _a === void 0 ? void 0 : _a[2];\n        if (label && s.isBlob(attr)) {\n            attrs.set(label, attr);\n        }\n    }\n    // Ensure we add the id field to avoid empty objects\n    if (!attrs.has('id')) {\n        const attr = s.getAttrByFwdIdentName(store, etype, 'id');\n        const label = (_b = attr === null || attr === void 0 ? void 0 : attr['forward-identity']) === null || _b === void 0 ? void 0 : _b[2];\n        if (label) {\n            attrs.set(label, attr);\n        }\n    }\n    return attrs;\n}\nfunction runDataloadAndReturnObjects(store, etype, direction, pageInfo, order, dq) {\n    var _a;\n    let idVecs = datalogQuery(store, dq);\n    const startCursor = pageInfo === null || pageInfo === void 0 ? void 0 : pageInfo['start-cursor'];\n    const orderAttr = getOrderAttr(store, etype, startCursor, order);\n    if (orderAttr && ((_a = orderAttr === null || orderAttr === void 0 ? void 0 : orderAttr['forward-identity']) === null || _a === void 0 ? void 0 : _a[2]) !== 'id') {\n        const isDate = orderAttr['checked-data-type'] === 'date';\n        const a = orderAttr.id;\n        idVecs = idVecs.map(([id]) => {\n            var _a, _b, _c, _d, _e;\n            // order attr is required to be cardinality one, so there will\n            // be at most one value here\n            let v = (_e = (_d = (_c = (_b = (_a = store.eav.get(id)) === null || _a === void 0 ? void 0 : _a.get(a)) === null || _b === void 0 ? void 0 : _b.values()) === null || _c === void 0 ? void 0 : _c.next()) === null || _d === void 0 ? void 0 : _d.value) === null || _e === void 0 ? void 0 : _e[2];\n            if (isDate) {\n                v = comparableDate(v);\n            }\n            return [id, v];\n        });\n    }\n    idVecs.sort(direction === 'asc'\n        ? function compareIdVecs(a, b) {\n            return compareOrder(a, b);\n        }\n        : function compareIdVecs(a, b) {\n            return compareOrder(b, a);\n        });\n    let objects = {};\n    const attrs = objectAttrs(store, etype, dq);\n    for (const idVec of idVecs) {\n        const [id] = idVec;\n        if (objects[id]) {\n            continue;\n        }\n        if (startCursor &&\n            orderAttr &&\n            isBefore(startCursor, orderAttr, direction, idVec)) {\n            continue;\n        }\n        const obj = s.getAsObject(store, attrs, id);\n        if (obj) {\n            objects[id] = obj;\n        }\n    }\n    return objects;\n}\nfunction determineOrder(form) {\n    var _a;\n    const orderOpts = (_a = form.$) === null || _a === void 0 ? void 0 : _a.order;\n    if (!orderOpts) {\n        return 'asc';\n    }\n    return orderOpts[Object.keys(orderOpts)[0]] || 'asc';\n}\n/**\n * Given a query like:\n *\n * {\n *   users: {\n *     $: { where: { name: \"Joe\" } },\n *   },\n * };\n *\n * `resolveObjects`, turns where clause: `{ name: \"Joe\" }`\n * into a datalog query. We then run the datalog query,\n * and reduce all the triples into objects.\n */\nfunction resolveObjects(store, { etype, level, form, join, pageInfo }) {\n    var _a, _b, _c, _d, _e, _g, _h, _j, _k;\n    const limit = ((_a = form.$) === null || _a === void 0 ? void 0 : _a.limit) || ((_b = form.$) === null || _b === void 0 ? void 0 : _b.first) || ((_c = form.$) === null || _c === void 0 ? void 0 : _c.last);\n    const offset = (_d = form.$) === null || _d === void 0 ? void 0 : _d.offset;\n    const before = (_e = form.$) === null || _e === void 0 ? void 0 : _e.before;\n    const after = (_g = form.$) === null || _g === void 0 ? void 0 : _g.after;\n    const order = (_h = form.$) === null || _h === void 0 ? void 0 : _h.order;\n    const fields = (_j = form.$) === null || _j === void 0 ? void 0 : _j.fields;\n    // Wait for server to tell us where we start if we don't start from the beginning\n    if ((offset || before || after) && (!pageInfo || !pageInfo['start-cursor'])) {\n        return [];\n    }\n    const where = withJoin(makeWhere(store, etype, level, (_k = form.$) === null || _k === void 0 ? void 0 : _k.where), join);\n    const find = makeFind(makeVarImpl, etype, level);\n    const objs = runDataloadAndReturnObjects(store, etype, determineOrder(form), pageInfo, order, { where, find, fields });\n    if (limit != null) {\n        const entries = Object.entries(objs);\n        if (entries.length <= limit) {\n            return objs;\n        }\n        return Object.fromEntries(entries.slice(0, limit));\n    }\n    return objs;\n}\n/**\n * It's possible that we query\n * for an attribute that doesn't exist yet.\n *\n * { users: { $: { where: { nonExistentProperty: \"foo\" } } } }\n *\n * This swallows the missing attr error and returns\n * an empty result instead\n */\nfunction guardedResolveObjects(store, opts) {\n    try {\n        return resolveObjects(store, opts);\n    }\n    catch (e) {\n        if (e instanceof AttrNotFoundError) {\n            return {};\n        }\n        throw e;\n    }\n}\n/**\n * Given a query like:\n *\n * {\n *   users: {\n *     $: { where: { name: \"Joe\" } },\n *     posts: {},\n *   },\n * };\n *\n * `guardResolveObjects` will return the relevant `users` objects\n * `extendObjects` will then extend each `user` object with relevant `posts`.\n */\nfunction queryOne(store, opts) {\n    const objects = guardedResolveObjects(store, opts);\n    return extendObjects(makeVarImpl, store, opts, objects);\n}\nfunction formatPageInfo(pageInfo) {\n    const res = {};\n    for (const [k, v] of Object.entries(pageInfo)) {\n        res[k] = {\n            startCursor: v['start-cursor'],\n            endCursor: v['end-cursor'],\n            hasNextPage: v['has-next-page?'],\n            hasPreviousPage: v['has-previous-page?'],\n        };\n    }\n    return res;\n}\nexport default function query({ store, pageInfo, aggregate }, q) {\n    const data = Object.keys(q).reduce(function reduceResult(res, k) {\n        if ((aggregate === null || aggregate === void 0 ? void 0 : aggregate[k]) || '$$ruleParams' === k) {\n            // Aggregate doesn't return any join rows and has no children,\n            // so don't bother querying further\n            return res;\n        }\n        res[k] = queryOne(store, {\n            etype: k,\n            form: q[k],\n            level: 0,\n            pageInfo: pageInfo === null || pageInfo === void 0 ? void 0 : pageInfo[k],\n        });\n        return res;\n    }, {});\n    const result = { data };\n    if (pageInfo) {\n        result.pageInfo = formatPageInfo(pageInfo);\n    }\n    if (aggregate) {\n        result.aggregate = aggregate;\n    }\n    return result;\n}\n//# sourceMappingURL=instaql.js.map","function getAllTransactionChunkKeys() {\n    const v = 1;\n    const _dummy = {\n        __etype: v,\n        __ops: v,\n        update: v,\n        link: v,\n        unlink: v,\n        delete: v,\n        merge: v,\n        ruleParams: v,\n    };\n    return new Set(Object.keys(_dummy));\n}\nconst allTransactionChunkKeys = getAllTransactionChunkKeys();\nfunction transactionChunk(etype, id, prevOps) {\n    const target = {\n        __etype: etype,\n        __ops: prevOps,\n    };\n    return new Proxy(target, {\n        get: (_target, cmd) => {\n            if (cmd === '__ops')\n                return prevOps;\n            if (cmd === '__etype')\n                return etype;\n            if (!allTransactionChunkKeys.has(cmd)) {\n                return undefined;\n            }\n            return (args) => {\n                return transactionChunk(etype, id, [\n                    ...prevOps,\n                    [cmd, etype, id, args],\n                ]);\n            };\n        },\n    });\n}\n/**\n * Creates a lookup to use in place of an id in a transaction\n *\n * @example\n * db.tx.users[lookup('email', 'lyndon@example.com')].update({name: 'Lyndon'})\n */\nexport function lookup(attribute, value) {\n    return `lookup__${attribute}__${JSON.stringify(value)}`;\n}\nexport function isLookup(k) {\n    return k.startsWith('lookup__');\n}\nexport function parseLookup(k) {\n    const [_, attribute, ...vJSON] = k.split('__');\n    return [attribute, JSON.parse(vJSON.join('__'))];\n}\nfunction etypeChunk(etype) {\n    return new Proxy({\n        __etype: etype,\n    }, {\n        get(_target, cmd) {\n            if (cmd === '__etype')\n                return etype;\n            const id = cmd;\n            if (isLookup(id)) {\n                return transactionChunk(etype, parseLookup(id), []);\n            }\n            return transactionChunk(etype, id, []);\n        },\n    });\n}\nexport function txInit() {\n    return new Proxy({}, {\n        get(_target, ns) {\n            return etypeChunk(ns);\n        },\n    });\n}\n/**\n * A handy builder for changes.\n *\n * You must start with the `namespace` you want to change:\n *\n * @example\n *   db.tx.goals[goalId].update({title: \"Get fit\"})\n *   // Note: you don't need to create `goals` ahead of time.\n */\nexport const tx = txInit();\nexport function getOps(x) {\n    return x.__ops;\n}\n//# sourceMappingURL=instatx.js.map","import { getOps, isLookup, parseLookup } from \"./instatx.js\";\nimport { immutableRemoveUndefined } from './utils/object.js';\nimport uuid from \"./utils/uuid.js\";\n// Rewrites optimistic attrs with the attrs we get back from the server.\nexport function rewriteStep(attrMapping, txStep) {\n    const { attrIdMap, refSwapAttrIds } = attrMapping;\n    const rewritten = [];\n    for (const part of txStep) {\n        const newValue = attrIdMap[part];\n        if (newValue) {\n            // Rewrites attr id\n            rewritten.push(newValue);\n        }\n        else if (Array.isArray(part) && part.length == 2 && attrIdMap[part[0]]) {\n            // Rewrites attr id in lookups\n            const [aid, value] = part;\n            rewritten.push([attrIdMap[aid], value]);\n        }\n        else {\n            rewritten.push(part);\n        }\n    }\n    const [action] = txStep;\n    if ((action === 'add-triple' || action === 'retract-triple') &&\n        refSwapAttrIds.has(txStep[2])) {\n        // Reverse links if the optimistic link attr is backwards\n        const tmp = rewritten[1];\n        rewritten[1] = rewritten[3];\n        rewritten[3] = tmp;\n    }\n    return rewritten;\n}\nexport function getAttrByFwdIdentName(attrs, inputEtype, inputIdentName) {\n    return Object.values(attrs).find((attr) => {\n        const [_id, etype, label] = attr['forward-identity'];\n        return etype === inputEtype && label === inputIdentName;\n    });\n}\nexport function getAttrByReverseIdentName(attrs, inputEtype, inputIdentName) {\n    return Object.values(attrs).find((attr) => {\n        const revIdent = attr['reverse-identity'];\n        if (!revIdent)\n            return false;\n        const [_id, etype, label] = revIdent;\n        return etype === inputEtype && label === inputIdentName;\n    });\n}\nfunction explodeLookupRef(eid) {\n    if (Array.isArray(eid)) {\n        return eid;\n    }\n    const entries = Object.entries(eid);\n    if (entries.length !== 1) {\n        throw new Error('lookup must be an object with a single unique attr and value.');\n    }\n    return entries[0];\n}\nfunction isRefLookupIdent(attrs, etype, identName) {\n    return (identName.indexOf('.') !== -1 &&\n        // attr names can have `.` in them, so use the attr we find with a `.`\n        // before assuming it's a ref lookup.\n        !getAttrByFwdIdentName(attrs, etype, identName));\n}\nfunction extractRefLookupFwdName(identName) {\n    const [fwdName, idIdent, ...rest] = identName.split('.');\n    if (rest.length > 0 || idIdent !== 'id') {\n        throw new Error(`${identName} is not a valid lookup attribute.`);\n    }\n    return fwdName;\n}\nfunction lookupIdentToAttr(attrs, etype, identName) {\n    if (!isRefLookupIdent(attrs, etype, identName)) {\n        return getAttrByFwdIdentName(attrs, etype, identName);\n    }\n    const fwdName = extractRefLookupFwdName(identName);\n    const refAttr = getAttrByFwdIdentName(attrs, etype, fwdName) ||\n        getAttrByReverseIdentName(attrs, etype, fwdName);\n    if (refAttr && refAttr['value-type'] !== 'ref') {\n        throw new Error(`${identName} does not reference a valid link attribute.`);\n    }\n    return refAttr;\n}\n// Returns [attr, value] for the eid if the eid is a lookup.\n// If it's a regular eid, returns null\nfunction lookupPairOfEid(eid) {\n    if (typeof eid === 'string' && !isLookup(eid)) {\n        return null;\n    }\n    return typeof eid === 'string' && isLookup(eid)\n        ? parseLookup(eid)\n        : explodeLookupRef(eid);\n}\nfunction extractLookup(attrs, etype, eid) {\n    const lookupPair = lookupPairOfEid(eid);\n    if (lookupPair === null) {\n        return eid;\n    }\n    const [identName, value] = lookupPair;\n    const attr = lookupIdentToAttr(attrs, etype, identName);\n    if (!attr || !attr['unique?']) {\n        throw new Error(`${identName} is not a unique attribute.`);\n    }\n    return [attr.id, value];\n}\nfunction withIdAttrForLookup(attrs, etype, eidA, txSteps) {\n    const lookup = extractLookup(attrs, etype, eidA);\n    if (!Array.isArray(lookup)) {\n        return txSteps;\n    }\n    const idTuple = [\n        'add-triple',\n        lookup,\n        getAttrByFwdIdentName(attrs, etype, 'id').id,\n        lookup,\n    ];\n    return [idTuple].concat(txSteps);\n}\nfunction expandLink(attrs, [etype, eidA, obj]) {\n    const addTriples = Object.entries(obj).flatMap(([label, eidOrEids]) => {\n        const eids = Array.isArray(eidOrEids) ? eidOrEids : [eidOrEids];\n        const fwdAttr = getAttrByFwdIdentName(attrs, etype, label);\n        const revAttr = getAttrByReverseIdentName(attrs, etype, label);\n        return eids.map((eidB) => {\n            const txStep = fwdAttr\n                ? [\n                    'add-triple',\n                    extractLookup(attrs, etype, eidA),\n                    fwdAttr.id,\n                    extractLookup(attrs, fwdAttr['reverse-identity'][1], eidB),\n                ]\n                : [\n                    'add-triple',\n                    extractLookup(attrs, revAttr['forward-identity'][1], eidB),\n                    revAttr.id,\n                    extractLookup(attrs, etype, eidA),\n                ];\n            return txStep;\n        });\n    });\n    return withIdAttrForLookup(attrs, etype, eidA, addTriples);\n}\nfunction expandUnlink(attrs, [etype, eidA, obj]) {\n    const retractTriples = Object.entries(obj).flatMap(([label, eidOrEids]) => {\n        const eids = Array.isArray(eidOrEids) ? eidOrEids : [eidOrEids];\n        const fwdAttr = getAttrByFwdIdentName(attrs, etype, label);\n        const revAttr = getAttrByReverseIdentName(attrs, etype, label);\n        return eids.map((eidB) => {\n            const txStep = fwdAttr\n                ? [\n                    'retract-triple',\n                    extractLookup(attrs, etype, eidA),\n                    fwdAttr.id,\n                    extractLookup(attrs, fwdAttr['reverse-identity'][1], eidB),\n                ]\n                : [\n                    'retract-triple',\n                    extractLookup(attrs, revAttr['forward-identity'][1], eidB),\n                    revAttr.id,\n                    extractLookup(attrs, etype, eidA),\n                ];\n            return txStep;\n        });\n    });\n    return withIdAttrForLookup(attrs, etype, eidA, retractTriples);\n}\nfunction expandUpdate(attrs, [etype, eid, obj_]) {\n    const obj = immutableRemoveUndefined(obj_);\n    const lookup = extractLookup(attrs, etype, eid);\n    // id first so that we don't clobber updates on the lookup field\n    const attrTuples = [['id', lookup]]\n        .concat(Object.entries(obj))\n        .map(([identName, value]) => {\n        const attr = getAttrByFwdIdentName(attrs, etype, identName);\n        return ['add-triple', lookup, attr.id, value];\n    });\n    return attrTuples;\n}\nfunction expandDelete(attrs, [etype, eid]) {\n    const lookup = extractLookup(attrs, etype, eid);\n    return [['delete-entity', lookup, etype]];\n}\nfunction expandDeepMerge(attrs, [etype, eid, obj_]) {\n    const obj = immutableRemoveUndefined(obj_);\n    const lookup = extractLookup(attrs, etype, eid);\n    const attrTuples = Object.entries(obj).map(([identName, value]) => {\n        const attr = getAttrByFwdIdentName(attrs, etype, identName);\n        return ['deep-merge-triple', lookup, attr.id, value];\n    });\n    const idTuple = [\n        'add-triple',\n        lookup,\n        getAttrByFwdIdentName(attrs, etype, 'id').id,\n        lookup,\n    ];\n    // id first so that we don't clobber updates on the lookup field\n    return [idTuple].concat(attrTuples);\n}\nfunction expandRuleParams(attrs, [etype, eid, ruleParams]) {\n    const lookup = extractLookup(attrs, etype, eid);\n    return [['rule-params', lookup, etype, ruleParams]];\n}\nfunction removeIdFromArgs(step) {\n    const [op, etype, eid, obj] = step;\n    if (!obj) {\n        return step;\n    }\n    const newObj = Object.assign({}, obj);\n    delete newObj.id;\n    return [op, etype, eid, newObj];\n}\nfunction toTxSteps(attrs, step) {\n    const [action, ...args] = removeIdFromArgs(step);\n    switch (action) {\n        case 'merge':\n            return expandDeepMerge(attrs, args);\n        case 'update':\n            return expandUpdate(attrs, args);\n        case 'link':\n            return expandLink(attrs, args);\n        case 'unlink':\n            return expandUnlink(attrs, args);\n        case 'delete':\n            return expandDelete(attrs, args);\n        case 'ruleParams':\n            return expandRuleParams(attrs, args);\n        default:\n            throw new Error(`unsupported action ${action}`);\n    }\n}\n// ---------\n// transform\nfunction checkedDataTypeOfValueType(valueType) {\n    switch (valueType) {\n        case 'string':\n        case 'date':\n        case 'boolean':\n        case 'number':\n            return valueType;\n        default:\n            return undefined;\n    }\n}\nfunction objectPropsFromSchema(schema, etype, label) {\n    var _a, _b;\n    const attr = (_b = (_a = schema.entities[etype]) === null || _a === void 0 ? void 0 : _a.attrs) === null || _b === void 0 ? void 0 : _b[label];\n    if (label === 'id')\n        return null;\n    if (!attr) {\n        throw new Error(`${etype}.${label} does not exist in your schema`);\n    }\n    const { unique, indexed } = attr === null || attr === void 0 ? void 0 : attr.config;\n    const checkedDataType = checkedDataTypeOfValueType(attr === null || attr === void 0 ? void 0 : attr.valueType);\n    return {\n        'index?': indexed,\n        'unique?': unique,\n        'checked-data-type': checkedDataType,\n    };\n}\nfunction createObjectAttr(schema, etype, label, props) {\n    const schemaObjectProps = schema\n        ? objectPropsFromSchema(schema, etype, label)\n        : null;\n    const attrId = uuid();\n    const fwdIdentId = uuid();\n    const fwdIdent = [fwdIdentId, etype, label];\n    return Object.assign(Object.assign({ id: attrId, 'forward-identity': fwdIdent, 'value-type': 'blob', cardinality: 'one', 'unique?': false, 'index?': false, isUnsynced: true }, (schemaObjectProps || {})), (props || {}));\n}\nfunction findSchemaLink(schema, etype, label) {\n    const found = Object.values(schema.links).find((x) => {\n        return ((x.forward.on === etype && x.forward.label === label) ||\n            (x.reverse.on === etype && x.reverse.label === label));\n    });\n    return found;\n}\nfunction refPropsFromSchema(schema, etype, label) {\n    const found = findSchemaLink(schema, etype, label);\n    if (!found) {\n        throw new Error(`Couldn't find the link ${etype}.${label} in your schema`);\n    }\n    const { forward, reverse } = found;\n    return {\n        'forward-identity': [uuid(), forward.on, forward.label],\n        'reverse-identity': [uuid(), reverse.on, reverse.label],\n        cardinality: forward.has === 'one' ? 'one' : 'many',\n        'unique?': reverse.has === 'one',\n    };\n}\nfunction createRefAttr(schema, etype, label, props) {\n    const schemaRefProps = schema\n        ? refPropsFromSchema(schema, etype, label)\n        : null;\n    const attrId = uuid();\n    const fwdIdent = [uuid(), etype, label];\n    const revIdent = [uuid(), label, etype];\n    return Object.assign(Object.assign({ id: attrId, 'forward-identity': fwdIdent, 'reverse-identity': revIdent, 'value-type': 'ref', cardinality: 'many', 'unique?': false, 'index?': false, isUnsynced: true }, (schemaRefProps || {})), (props || {}));\n}\n// Actions that have an object, e.g. not delete\nconst OBJ_ACTIONS = new Set(['update', 'merge', 'link', 'unlink']);\nconst REF_ACTIONS = new Set(['link', 'unlink']);\nconst UPDATE_ACTIONS = new Set(['update', 'merge']);\nconst SUPPORTS_LOOKUP_ACTIONS = new Set([\n    'link',\n    'unlink',\n    'update',\n    'merge',\n    'delete',\n    'ruleParams',\n]);\nconst lookupProps = { 'unique?': true, 'index?': true };\nconst refLookupProps = Object.assign(Object.assign({}, lookupProps), { cardinality: 'one' });\nfunction lookupPairsOfOp(op) {\n    const res = [];\n    const [action, etype, eid, obj] = op;\n    if (!SUPPORTS_LOOKUP_ACTIONS.has(action)) {\n        return res;\n    }\n    const eidLookupPair = lookupPairOfEid(eid);\n    if (eidLookupPair) {\n        res.push({ etype: etype, lookupPair: eidLookupPair });\n    }\n    if (action === 'link') {\n        for (const [label, eidOrEids] of Object.entries(obj)) {\n            const eids = Array.isArray(eidOrEids) ? eidOrEids : [eidOrEids];\n            for (const linkEid of eids) {\n                const linkEidLookupPair = lookupPairOfEid(linkEid);\n                if (linkEidLookupPair) {\n                    res.push({\n                        etype: etype,\n                        lookupPair: linkEidLookupPair,\n                        linkLabel: label,\n                    });\n                }\n            }\n        }\n    }\n    return res;\n}\nfunction createMissingAttrs({ attrs: existingAttrs, schema }, ops) {\n    var _a, _b;\n    const [addedIds, attrs, addOps] = [new Set(), Object.assign({}, existingAttrs), []];\n    function addAttr(attr) {\n        attrs[attr.id] = attr;\n        addOps.push(['add-attr', attr]);\n        addedIds.add(attr.id);\n    }\n    function addUnsynced(attr) {\n        if ((attr === null || attr === void 0 ? void 0 : attr.isUnsynced) && !addedIds.has(attr.id)) {\n            addOps.push(['add-attr', attr]);\n            addedIds.add(attr.id);\n        }\n    }\n    // Adds attrs needed for a ref lookup\n    function addForRef(etype, label) {\n        const fwdAttr = getAttrByFwdIdentName(attrs, etype, label);\n        const revAttr = getAttrByReverseIdentName(attrs, etype, label);\n        addUnsynced(fwdAttr);\n        addUnsynced(revAttr);\n        if (!fwdAttr && !revAttr) {\n            addAttr(createRefAttr(schema, etype, label, refLookupProps));\n        }\n    }\n    // Create attrs for lookups if we need to\n    // Do these first because otherwise we might add a non-unique attr\n    // before we get to it\n    for (const op of ops) {\n        for (const { etype, lookupPair, linkLabel } of lookupPairsOfOp(op)) {\n            const identName = lookupPair[0];\n            // We got a link eid that's a lookup, linkLabel is the label of the ident,\n            // e.g. `posts` in `link({posts: postIds})`\n            if (linkLabel) {\n                // Add our ref attr, e.g. users.posts\n                addForRef(etype, linkLabel);\n                // Figure out the link etype so we can make sure we have the attrs\n                // for the link lookup\n                const fwdAttr = getAttrByFwdIdentName(attrs, etype, linkLabel);\n                const revAttr = getAttrByReverseIdentName(attrs, etype, linkLabel);\n                addUnsynced(fwdAttr);\n                addUnsynced(revAttr);\n                const linkEtype = ((_a = fwdAttr === null || fwdAttr === void 0 ? void 0 : fwdAttr['reverse-identity']) === null || _a === void 0 ? void 0 : _a[1]) ||\n                    ((_b = revAttr === null || revAttr === void 0 ? void 0 : revAttr['forward-identity']) === null || _b === void 0 ? void 0 : _b[1]) ||\n                    linkLabel;\n                if (isRefLookupIdent(attrs, linkEtype, identName)) {\n                    addForRef(linkEtype, extractRefLookupFwdName(identName));\n                }\n                else {\n                    const attr = getAttrByFwdIdentName(attrs, linkEtype, identName);\n                    if (!attr) {\n                        addAttr(createObjectAttr(schema, linkEtype, identName, lookupProps));\n                    }\n                    addUnsynced(attr);\n                }\n            }\n            else if (isRefLookupIdent(attrs, etype, identName)) {\n                addForRef(etype, extractRefLookupFwdName(identName));\n            }\n            else {\n                const attr = getAttrByFwdIdentName(attrs, etype, identName);\n                if (!attr) {\n                    addAttr(createObjectAttr(schema, etype, identName, lookupProps));\n                }\n                addUnsynced(attr);\n            }\n        }\n    }\n    // Create object and ref attrs\n    for (const op of ops) {\n        const [action, etype, eid, obj] = op;\n        if (OBJ_ACTIONS.has(action)) {\n            const labels = Object.keys(obj);\n            labels.push('id');\n            for (const label of labels) {\n                const fwdAttr = getAttrByFwdIdentName(attrs, etype, label);\n                addUnsynced(fwdAttr);\n                if (UPDATE_ACTIONS.has(action)) {\n                    if (!fwdAttr) {\n                        addAttr(createObjectAttr(schema, etype, label, label === 'id' ? { 'unique?': true } : null));\n                    }\n                }\n                if (REF_ACTIONS.has(action)) {\n                    const revAttr = getAttrByReverseIdentName(attrs, etype, label);\n                    if (!fwdAttr && !revAttr) {\n                        addAttr(createRefAttr(schema, etype, label));\n                    }\n                    addUnsynced(revAttr);\n                }\n            }\n        }\n    }\n    return [attrs, addOps];\n}\nexport function transform(ctx, inputChunks) {\n    const chunks = Array.isArray(inputChunks) ? inputChunks : [inputChunks];\n    const ops = chunks.flatMap((tx) => getOps(tx));\n    const [newAttrs, addAttrTxSteps] = createMissingAttrs(ctx, ops);\n    const txSteps = ops.flatMap((op) => toTxSteps(newAttrs, op));\n    return [...addAttrTxSteps, ...txSteps];\n}\n//# sourceMappingURL=instaml.js.map","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nexport default class IndexedDBStorage {\n    constructor(dbName) {\n        this.dbName = dbName;\n        this._storeName = 'kv';\n        this._dbPromise = this._init();\n    }\n    _init() {\n        return new Promise((resolve, reject) => {\n            const request = indexedDB.open(this.dbName, 1);\n            request.onerror = (event) => {\n                reject(event);\n            };\n            request.onsuccess = (event) => {\n                resolve(event.target.result);\n            };\n            request.onupgradeneeded = (event) => {\n                const db = event.target.result;\n                db.createObjectStore(this._storeName);\n            };\n        });\n    }\n    getItem(k) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const db = yield this._dbPromise;\n            return new Promise((resolve, reject) => {\n                const transaction = db.transaction([this._storeName], 'readonly');\n                const objectStore = transaction.objectStore(this._storeName);\n                const request = objectStore.get(k);\n                request.onerror = (event) => {\n                    reject(event);\n                };\n                request.onsuccess = (_event) => {\n                    if (request.result) {\n                        resolve(request.result);\n                    }\n                    else {\n                        resolve(null);\n                    }\n                };\n            });\n        });\n    }\n    setItem(k, v) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const db = yield this._dbPromise;\n            return new Promise((resolve, reject) => {\n                const transaction = db.transaction([this._storeName], 'readwrite');\n                const objectStore = transaction.objectStore(this._storeName);\n                const request = objectStore.put(v, k);\n                request.onerror = (event) => {\n                    reject(event);\n                };\n                request.onsuccess = (_event) => {\n                    resolve();\n                };\n            });\n        });\n    }\n}\n//# sourceMappingURL=IndexedDBStorage.js.map","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nexport default class WindowNetworkListener {\n    static getIsOnline() {\n        return __awaiter(this, void 0, void 0, function* () {\n            return navigator.onLine;\n        });\n    }\n    static listen(f) {\n        const onOnline = () => {\n            f(true);\n        };\n        const onOffline = () => {\n            f(false);\n        };\n        addEventListener('online', onOnline);\n        addEventListener('offline', onOffline);\n        return () => {\n            removeEventListener('online', onOnline);\n            removeEventListener('offline', onOffline);\n        };\n    }\n}\n//# sourceMappingURL=WindowNetworkListener.js.map","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nexport class InstantAPIError extends Error {\n    constructor(error) {\n        var _a;\n        // Create a descriptive message based on the error\n        const message = ((_a = error.body) === null || _a === void 0 ? void 0 : _a.message) || `API Error (${error.status})`;\n        super(message);\n        const actualProto = new.target.prototype;\n        if (Object.setPrototypeOf) {\n            Object.setPrototypeOf(this, actualProto);\n        }\n        // Maintain proper stack trace for where our error was thrown\n        if (Error.captureStackTrace) {\n            Error.captureStackTrace(this, InstantAPIError);\n        }\n        this.name = 'InstantAPIError';\n        this.status = error.status;\n        this.body = error.body;\n    }\n    get [Symbol.toStringTag]() {\n        return 'InstantAPIError';\n    }\n}\nexport function jsonFetch(input, init) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const res = yield fetch(input, init);\n        const json = yield res.json();\n        return res.status === 200\n            ? Promise.resolve(json)\n            : Promise.reject(new InstantAPIError({ status: res.status, body: json }));\n    });\n}\n//# sourceMappingURL=fetch.js.map","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { jsonFetch } from './utils/fetch.js';\nexport function sendMagicCode({ apiURI, appId, email, }) {\n    return jsonFetch(`${apiURI}/runtime/auth/send_magic_code`, {\n        method: 'POST',\n        headers: { 'content-type': 'application/json' },\n        body: JSON.stringify({ 'app-id': appId, email }),\n    });\n}\nexport function verifyMagicCode(_a) {\n    return __awaiter(this, arguments, void 0, function* ({ apiURI, appId, email, code, }) {\n        const res = yield jsonFetch(`${apiURI}/runtime/auth/verify_magic_code`, {\n            method: 'POST',\n            headers: { 'content-type': 'application/json' },\n            body: JSON.stringify({ 'app-id': appId, email, code }),\n        });\n        return res;\n    });\n}\nexport function verifyRefreshToken(_a) {\n    return __awaiter(this, arguments, void 0, function* ({ apiURI, appId, refreshToken, }) {\n        const res = yield jsonFetch(`${apiURI}/runtime/auth/verify_refresh_token`, {\n            method: 'POST',\n            headers: { 'content-type': 'application/json' },\n            body: JSON.stringify({\n                'app-id': appId,\n                'refresh-token': refreshToken,\n            }),\n        });\n        return res;\n    });\n}\nexport function exchangeCodeForToken(_a) {\n    return __awaiter(this, arguments, void 0, function* ({ apiURI, appId, code, codeVerifier, }) {\n        const res = yield jsonFetch(`${apiURI}/runtime/oauth/token`, {\n            method: 'POST',\n            headers: { 'content-type': 'application/json' },\n            body: JSON.stringify({\n                app_id: appId,\n                code: code,\n                code_verifier: codeVerifier,\n            }),\n        });\n        return res;\n    });\n}\nexport function signInWithIdToken(_a) {\n    return __awaiter(this, arguments, void 0, function* ({ apiURI, appId, nonce, idToken, clientName, refreshToken, }) {\n        const res = yield jsonFetch(`${apiURI}/runtime/oauth/id_token`, {\n            method: 'POST',\n            headers: { 'content-type': 'application/json' },\n            body: JSON.stringify({\n                app_id: appId,\n                nonce,\n                id_token: idToken,\n                client_name: clientName,\n                refresh_token: refreshToken,\n            }),\n        });\n        return res;\n    });\n}\nexport function signOut(_a) {\n    return __awaiter(this, arguments, void 0, function* ({ apiURI, appId, refreshToken, }) {\n        const res = yield jsonFetch(`${apiURI}/runtime/signout`, {\n            method: 'POST',\n            headers: {\n                'content-type': 'application/json',\n            },\n            body: JSON.stringify({\n                app_id: appId,\n                refresh_token: refreshToken,\n            }),\n        });\n        return res;\n    });\n}\n//# sourceMappingURL=authAPI.js.map","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { jsonFetch } from './utils/fetch.js';\nexport function uploadFile(_a) {\n    return __awaiter(this, arguments, void 0, function* ({ apiURI, appId, path, file, refreshToken, contentType, contentDisposition, }) {\n        const headers = {\n            app_id: appId,\n            path,\n            authorization: `Bearer ${refreshToken}`,\n            'content-type': contentType || file.type,\n        };\n        if (contentDisposition) {\n            headers['content-disposition'] = contentDisposition;\n        }\n        const data = yield jsonFetch(`${apiURI}/storage/upload`, {\n            method: 'PUT',\n            headers,\n            body: file,\n        });\n        return data;\n    });\n}\nexport function deleteFile(_a) {\n    return __awaiter(this, arguments, void 0, function* ({ apiURI, appId, path, refreshToken, }) {\n        const { data } = yield jsonFetch(`${apiURI}/storage/files?app_id=${appId}&filename=${encodeURIComponent(path)}`, {\n            method: 'DELETE',\n            headers: {\n                'content-type': 'application/json',\n                authorization: `Bearer ${refreshToken}`,\n            },\n        });\n        return data;\n    });\n}\n// Deprecated Storage API (Jan 2025)\n// ---------------------------------\nexport function getSignedUploadUrl(_a) {\n    return __awaiter(this, arguments, void 0, function* ({ apiURI, appId, fileName, refreshToken, metadata = {}, }) {\n        const { data } = yield jsonFetch(`${apiURI}/storage/signed-upload-url`, {\n            method: 'POST',\n            headers: {\n                'content-type': 'application/json',\n                authorization: `Bearer ${refreshToken}`,\n            },\n            body: JSON.stringify({\n                app_id: appId,\n                filename: fileName,\n            }),\n        });\n        return data;\n    });\n}\nexport function upload(presignedUrl, file) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const response = yield fetch(presignedUrl, {\n            method: 'PUT',\n            body: file,\n            headers: {\n                'Content-Type': file.type,\n            },\n        });\n        return response.ok;\n    });\n}\nexport function getDownloadUrl(_a) {\n    return __awaiter(this, arguments, void 0, function* ({ apiURI, appId, path, refreshToken, }) {\n        const { data } = yield jsonFetch(`${apiURI}/storage/signed-download-url?app_id=${appId}&filename=${encodeURIComponent(path)}`, {\n            method: 'GET',\n            headers: {\n                'content-type': 'application/json',\n                authorization: `Bearer ${refreshToken}`,\n            },\n        });\n        return data;\n    });\n}\n//# sourceMappingURL=StorageAPI.js.map","let devBackend = false;\nlet instantLogs = false;\nlet devtoolLocalDashboard = false;\nif (typeof window !== 'undefined' &&\n    typeof window.localStorage !== 'undefined') {\n    devBackend = !!window.localStorage.getItem('devBackend');\n    instantLogs = !!window.localStorage.getItem('__instantLogging');\n    devtoolLocalDashboard = !!window.localStorage.getItem('__devtoolLocalDash');\n}\nexport { devBackend, instantLogs, devtoolLocalDashboard };\n//# sourceMappingURL=flags.js.map","export function pick(obj, keys) {\n    if (!keys)\n        return obj;\n    const ret = {};\n    keys.forEach((key) => {\n        ret[key] = obj[key];\n    });\n    return ret;\n}\n//# sourceMappingURL=pick.js.map","import { pick } from './utils/pick.js';\nimport { areObjectsShallowEqual, areObjectKeysEqual } from './utils/object.js';\nexport function buildPresenceSlice(data, opts, userPeerId) {\n    var _a, _b;\n    const slice = {\n        peers: {},\n    };\n    const includeUser = opts && 'user' in opts ? opts.user : true;\n    if (includeUser) {\n        const user = pick((_a = data.user) !== null && _a !== void 0 ? _a : {}, opts === null || opts === void 0 ? void 0 : opts.keys);\n        slice.user = Object.assign(Object.assign({}, user), { peerId: userPeerId });\n    }\n    for (const id of Object.keys((_b = data.peers) !== null && _b !== void 0 ? _b : {})) {\n        const shouldIncludeAllPeers = (opts === null || opts === void 0 ? void 0 : opts.peers) === undefined;\n        const isPeerIncluded = Array.isArray(opts === null || opts === void 0 ? void 0 : opts.peers) && (opts === null || opts === void 0 ? void 0 : opts.peers.includes(id));\n        if (shouldIncludeAllPeers || isPeerIncluded) {\n            const peer = pick(data.peers[id], opts === null || opts === void 0 ? void 0 : opts.keys);\n            slice.peers[id] = Object.assign(Object.assign({}, peer), { peerId: id });\n        }\n    }\n    return slice;\n}\n/**\n * Compare two presence slices\n * 0. compare isLoading and error\n * 1. shallow compare user\n * 2. compare peers keys\n * 3. shallow compare each peer\n */\nexport function hasPresenceResponseChanged(a, b) {\n    if (a.isLoading !== b.isLoading)\n        return true;\n    if (a.error !== b.error)\n        return true;\n    if (a.user || b.user) {\n        if (!a.user || !b.user)\n            return true;\n        const same = areObjectsShallowEqual(a.user, b.user);\n        if (!same)\n            return true;\n    }\n    const sameKeys = areObjectKeysEqual(a.peers, b.peers);\n    if (!sameKeys)\n        return true;\n    for (const id of Object.keys(a.peers)) {\n        const same = areObjectsShallowEqual(a.peers[id], b.peers[id]);\n        if (!same)\n            return true;\n    }\n    return false;\n}\n//# sourceMappingURL=presence.js.map","export class Deferred {\n    constructor() {\n        this.promise = new Promise((resolve, reject) => {\n            this._resolve = resolve;\n            this._reject = reject;\n        });\n    }\n    resolve(value) {\n        this._resolve(value);\n    }\n    reject(reason) {\n        this._reject(reason);\n    }\n}\n//# sourceMappingURL=Deferred.js.map","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n// PersistedObjects save data outside of memory.\n//\n// When we load a persisted object, it's possible we call `set`\n// before we finish loading. To address we handle set in two ways:\n//\n// 1. Before load\n// We simply update currentValue in memory\n//\n// 2. After load\n// We update currentValue in memory and in storage\n//\n// Each PersistedObject provides it's own `onMerge`\n// function to handle the merge of data from storage and memory\n// on load\nexport class PersistedObject {\n    constructor(persister, key, defaultValue, onMerge, toJSON = (x) => {\n        return JSON.stringify(x);\n    }, fromJSON = (x) => {\n        return JSON.parse(x);\n    }, saveThrottleMs = 100) {\n        this._subs = [];\n        this._persister = persister;\n        this._key = key;\n        this._onMerge = onMerge;\n        this._loadedCbs = [];\n        this._isLoading = true;\n        this.currentValue = defaultValue;\n        this.toJSON = toJSON;\n        this.fromJSON = fromJSON;\n        this._saveThrottleMs = saveThrottleMs;\n        this._pendingSaveCbs = [];\n        this._version = 0;\n        this._load();\n    }\n    _load() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const fromStorage = this.fromJSON(yield this._persister.getItem(this._key));\n            this._isLoading = false;\n            this._onMerge(fromStorage, this.currentValue);\n            for (const cb of this._loadedCbs) {\n                cb();\n            }\n        });\n    }\n    waitForLoaded() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this._isLoading) {\n                return;\n            }\n            const loadedPromise = new Promise((resolve) => {\n                this._loadedCbs.push(resolve);\n            });\n            yield loadedPromise;\n        });\n    }\n    isLoading() {\n        return this._isLoading;\n    }\n    version() {\n        return this._version;\n    }\n    waitForSync() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this._nextSave) {\n                return;\n            }\n            const syncedPromise = new Promise((resolve) => {\n                this._pendingSaveCbs.push(resolve);\n            });\n            yield syncedPromise;\n        });\n    }\n    _writeToStorage() {\n        this._persister.setItem(this._key, this.toJSON(this.currentValue));\n        for (const cb of this._pendingSaveCbs) {\n            cb();\n        }\n        this._pendingSaveCbs.length = 0;\n    }\n    flush() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this._nextSave) {\n                return;\n            }\n            clearTimeout(this._nextSave);\n            this._writeToStorage();\n        });\n    }\n    _enqueuePersist(cb) {\n        if (this._nextSave) {\n            if (cb) {\n                this._pendingSaveCbs.push(cb);\n            }\n            return;\n        }\n        this._nextSave = setTimeout(() => {\n            this._nextSave = null;\n            this._writeToStorage();\n        }, this._saveThrottleMs);\n    }\n    set(f, cb) {\n        this._version++;\n        this.currentValue = f(this.currentValue);\n        if (this._isLoading) {\n            this._loadedCbs.push(() => this._enqueuePersist(cb));\n        }\n        else {\n            this._enqueuePersist(cb);\n        }\n        for (const sub of this._subs) {\n            sub(this.currentValue);\n        }\n    }\n    subscribe(cb) {\n        this._subs.push(cb);\n        cb(this.currentValue);\n        return () => {\n            this._subs = this._subs.filter((x) => x !== cb);\n        };\n    }\n}\n//# sourceMappingURL=PersistedObject.js.map","function _extractTriplesHelper(idNodes, acc = []) {\n    idNodes.forEach((idNode) => {\n        const { data } = idNode;\n        const { 'datalog-result': datalogResult } = data;\n        const { 'join-rows': joinRows } = datalogResult;\n        for (const rows of joinRows) {\n            for (const triple of rows) {\n                acc.push(triple);\n            }\n        }\n        _extractTriplesHelper(idNode['child-nodes'], acc);\n    });\n}\n/**\n * Marshall instaql-result into list of triples. Instaql-result may have\n * multiple datalog-results, each datalog-result may have multiple join-rows\n * and each join-row may have triples.The union of these triples may have\n * duplicates, so we dedup them.\n */\nexport function extractTriples(idNodes) {\n    const triples = [];\n    _extractTriplesHelper(idNodes, triples);\n    return triples;\n}\n//# sourceMappingURL=instaqlResult.js.map","export function createLinkIndex(schema) {\n    return Object.values(schema.links).reduce((linkIndex, link) => {\n        var _a, _b;\n        var _c, _d;\n        (_a = linkIndex[_c = link.forward.on]) !== null && _a !== void 0 ? _a : (linkIndex[_c] = {});\n        linkIndex[link.forward.on][link.forward.label] = {\n            isForward: true,\n            isSingular: link.forward.has === 'one',\n            link,\n        };\n        (_b = linkIndex[_d = link.reverse.on]) !== null && _b !== void 0 ? _b : (linkIndex[_d] = {});\n        linkIndex[link.reverse.on][link.reverse.label] = {\n            isForward: false,\n            isSingular: link.reverse.has === 'one',\n            link,\n        };\n        return linkIndex;\n    }, {});\n}\n//# sourceMappingURL=linkIndex.js.map","// Autogenerated by publish_packages.clj\nconst version = 'v0.19.5';\nexport default version;\n//# sourceMappingURL=version.js.map","export default function createLogger(isEnabled) {\n    return {\n        info: isEnabled ? console.info.bind(console) : () => { },\n        debug: isEnabled ? console.debug.bind(console) : () => { },\n        error: isEnabled ? console.error.bind(console) : () => { },\n    };\n}\n//# sourceMappingURL=log.js.map","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n// @ts-check\nimport weakHash from \"./utils/weakHash.js\";\nimport instaql from './instaql.js';\nimport * as instaml from './instaml.js';\nimport * as s from './store.js';\nimport uuid from \"./utils/uuid.js\";\nimport IndexedDBStorage from './IndexedDBStorage.js';\nimport WindowNetworkListener from './WindowNetworkListener.js';\nimport * as authAPI from \"./authAPI.js\";\nimport * as StorageApi from \"./StorageAPI.js\";\nimport * as flags from \"./utils/flags.js\";\nimport { buildPresenceSlice, hasPresenceResponseChanged } from \"./presence.js\";\nimport { Deferred } from './utils/Deferred.js';\nimport { PersistedObject } from './utils/PersistedObject.js';\nimport { extractTriples } from './model/instaqlResult.js';\nimport { areObjectsDeepEqual, assocInMutative, dissocInMutative, insertInMutative, } from './utils/object.js';\nimport { createLinkIndex } from \"./utils/linkIndex.js\";\nimport version from './version.js';\nimport { create } from 'mutative';\nimport createLogger from \"./utils/log.js\";\n/** @typedef {import('./utils/log.ts').Logger} Logger */\nconst STATUS = {\n    CONNECTING: 'connecting',\n    OPENED: 'opened',\n    AUTHENTICATED: 'authenticated',\n    CLOSED: 'closed',\n    ERRORED: 'errored',\n};\nconst QUERY_ONCE_TIMEOUT = 30000;\nconst WS_CONNECTING_STATUS = 0;\nconst WS_OPEN_STATUS = 1;\nconst defaultConfig = {\n    apiURI: 'https://api.instantdb.com',\n    websocketURI: 'wss://api.instantdb.com/runtime/session',\n};\n// Param that the backend adds if this is an oauth redirect\nconst OAUTH_REDIRECT_PARAM = '_instant_oauth_redirect';\nconst currentUserKey = `currentUser`;\nlet _wsId = 0;\nfunction createWebSocket(uri) {\n    const ws = new WebSocket(uri);\n    // @ts-ignore\n    ws._id = _wsId++;\n    return ws;\n}\nfunction isClient() {\n    const hasWindow = typeof window !== 'undefined';\n    // this checks if we are running in a chrome extension\n    // @ts-expect-error\n    const isChrome = typeof chrome !== 'undefined';\n    return hasWindow || isChrome;\n}\nconst ignoreLogging = {\n    'set-presence': true,\n    'set-presence-ok': true,\n    'refresh-presence': true,\n    'patch-presence': true,\n};\nfunction querySubsFromJSON(str) {\n    var _a;\n    const parsed = JSON.parse(str);\n    for (const key in parsed) {\n        const v = parsed[key];\n        if ((_a = v === null || v === void 0 ? void 0 : v.result) === null || _a === void 0 ? void 0 : _a.store) {\n            v.result.store = s.fromJSON(v.result.store);\n        }\n    }\n    return parsed;\n}\nfunction querySubsToJSON(querySubs) {\n    var _a;\n    const jsonSubs = {};\n    for (const key in querySubs) {\n        const sub = querySubs[key];\n        const jsonSub = Object.assign({}, sub);\n        if ((_a = sub.result) === null || _a === void 0 ? void 0 : _a.store) {\n            jsonSub.result = Object.assign(Object.assign({}, sub.result), { store: s.toJSON(sub.result.store) });\n        }\n        jsonSubs[key] = jsonSub;\n    }\n    return JSON.stringify(jsonSubs);\n}\n/**\n * @template {import('./presence.ts').RoomSchemaShape} [RoomSchema = {}]\n */\nexport default class Reactor {\n    constructor(config, Storage = IndexedDBStorage, NetworkListener = WindowNetworkListener, versions) {\n        this._isOnline = true;\n        this._isShutdown = false;\n        this.status = STATUS.CONNECTING;\n        /** @type {Record<string, Array<{ q: any, cb: (data: any) => any }>>} */\n        this.queryCbs = {};\n        /** @type {Record<string, Array<{ q: any, eventId: string, dfd: Deferred }>>} */\n        this.queryOnceDfds = {};\n        this.authCbs = [];\n        this.attrsCbs = [];\n        this.mutationErrorCbs = [];\n        this.connectionStatusCbs = [];\n        this.mutationDeferredStore = new Map();\n        this._reconnectTimeoutId = null;\n        this._reconnectTimeoutMs = 0;\n        this._localIdPromises = {};\n        this._errorMessage = null;\n        /** @type {Promise<null | {error: {message: string}}>}**/\n        this._oauthCallbackResponse = null;\n        /** @type {null | import('./utils/linkIndex.ts').LinkIndex}} */\n        this._linkIndex = null;\n        /** @type {Record<string, {isConnected: boolean; error: any}>} */\n        this._rooms = {};\n        /** @type {Record<string, boolean>} */\n        this._roomsPendingLeave = {};\n        this._presence = {};\n        this._broadcastQueue = [];\n        this._broadcastSubs = {};\n        this._currentUserCached = { isLoading: true, error: undefined, user: undefined };\n        this._beforeUnloadCbs = [];\n        this._dataForQueryCache = {};\n        /**\n         *  merge querySubs from storage and in memory. Has the following side\n         *  effects:\n         *  - We notify all queryCbs because results may been added during merge\n         */\n        this._onMergeQuerySubs = (_storageSubs, inMemorySubs) => {\n            const storageSubs = _storageSubs || {};\n            const ret = Object.assign({}, inMemorySubs);\n            // Consider an inMemorySub with no result;\n            // If we have a result from storageSubs, let's add it\n            Object.entries(inMemorySubs).forEach(([hash, querySub]) => {\n                var _a;\n                const storageResult = (_a = storageSubs === null || storageSubs === void 0 ? void 0 : storageSubs[hash]) === null || _a === void 0 ? void 0 : _a.result;\n                const memoryResult = querySub.result;\n                if (storageResult && !memoryResult) {\n                    ret[hash].result = storageResult;\n                }\n            });\n            // Consider a storageSub with no corresponding inMemorySub\n            // This means that at least at this point,\n            // the user has not asked to subscribe to the query.\n            // We may _still_ want to add it, because in just a\n            // few milliseconds, the user will ask to subscribe to the\n            // query.\n            // For now, we can't really tell if the user will ask to subscribe\n            // or not. So for now let's just add the first 10 queries from storage.\n            // Eventually, we could be smarter about this. For example,\n            // we can keep usage information about which queries are popular.\n            const storageKsToAdd = Object.keys(storageSubs)\n                .filter((k) => !inMemorySubs[k])\n                .slice(0, 10);\n            storageKsToAdd.forEach((k) => {\n                ret[k] = storageSubs[k];\n            });\n            // Okay, now we have merged our querySubs\n            this.querySubs.set((_) => ret);\n            this.loadedNotifyAll();\n        };\n        /**\n         * merge pendingMutations from storage and in memory. Has a side effect of\n         * sending mutations that were stored but not acked\n         */\n        this._onMergePendingMutations = (storageMuts, inMemoryMuts) => {\n            const ret = new Map([...storageMuts.entries(), ...inMemoryMuts.entries()]);\n            this.pendingMutations.set((_) => ret);\n            this.loadedNotifyAll();\n            const rewrittenStorageMuts = this._rewriteMutations(this.attrs, storageMuts);\n            rewrittenStorageMuts.forEach((mut, k) => {\n                if (!inMemoryMuts.has(k) && !mut['tx-id']) {\n                    this._sendMutation(k, mut);\n                }\n            });\n        };\n        // ---------------------------\n        // Queries\n        this.getPreviousResult = (q) => {\n            const hash = weakHash(q);\n            return this.dataForQuery(hash);\n        };\n        /** Re-run instaql and call all callbacks with new data */\n        this.notifyOne = (hash) => {\n            var _a, _b;\n            const cbs = (_a = this.queryCbs[hash]) !== null && _a !== void 0 ? _a : [];\n            const prevData = (_b = this._dataForQueryCache[hash]) === null || _b === void 0 ? void 0 : _b.data;\n            const data = this.dataForQuery(hash);\n            if (!data)\n                return;\n            if (areObjectsDeepEqual(data, prevData))\n                return;\n            cbs.forEach((r) => r.cb(data));\n        };\n        this.notifyOneQueryOnce = (hash) => {\n            var _a;\n            const dfds = (_a = this.queryOnceDfds[hash]) !== null && _a !== void 0 ? _a : [];\n            const data = this.dataForQuery(hash);\n            dfds.forEach((r) => {\n                this._completeQueryOnce(r.q, hash, r.dfd);\n                r.dfd.resolve(data);\n            });\n        };\n        this.notifyQueryError = (hash, error) => {\n            const cbs = this.queryCbs[hash] || [];\n            cbs.forEach((r) => r.cb({ error }));\n        };\n        /** Applies transactions locally and sends transact message to server */\n        this.pushTx = (chunks) => {\n            try {\n                const txSteps = instaml.transform({ attrs: this.optimisticAttrs(), schema: this.config.schema }, chunks);\n                return this.pushOps(txSteps);\n            }\n            catch (e) {\n                return this.pushOps([], e);\n            }\n        };\n        /**\n         * @param {*} txSteps\n         * @param {*} [error]\n         * @returns\n         */\n        this.pushOps = (txSteps, error) => {\n            const eventId = uuid();\n            const mutation = {\n                op: 'transact',\n                'tx-steps': txSteps,\n                error: error,\n            };\n            this.pendingMutations.set((prev) => {\n                prev.set(eventId, mutation);\n                return prev;\n            });\n            const dfd = new Deferred();\n            this.mutationDeferredStore.set(eventId, dfd);\n            this._sendMutation(eventId, mutation);\n            this.notifyAll();\n            return dfd.promise;\n        };\n        this._wsOnOpen = (e) => {\n            const targetWs = e.target;\n            if (this._ws !== targetWs) {\n                this._log.info('[socket][open]', targetWs._id, 'skip; this is no longer the current ws');\n                return;\n            }\n            this._log.info('[socket][open]', this._ws._id);\n            this._setStatus(STATUS.OPENED);\n            this.getCurrentUser().then((resp) => {\n                var _a;\n                this._trySend(uuid(), {\n                    op: 'init',\n                    'app-id': this.config.appId,\n                    'refresh-token': (_a = resp.user) === null || _a === void 0 ? void 0 : _a['refresh_token'],\n                    versions: this.versions,\n                    // If an admin token is provided for an app, we will\n                    // skip all permission checks. This is an advanced feature,\n                    // to let users write internal tools\n                    // This option is not exposed in `Config`, as it's\n                    // not ready for prime time\n                    '__admin-token': this.config.__adminToken,\n                });\n            });\n        };\n        this._wsOnMessage = (e) => {\n            const targetWs = e.target;\n            const m = JSON.parse(e.data.toString());\n            if (this._ws !== targetWs) {\n                this._log.info('[socket][message]', targetWs._id, m, 'skip; this is no longer the current ws');\n                return;\n            }\n            this._handleReceive(targetWs._id, JSON.parse(e.data.toString()));\n        };\n        this._wsOnError = (e) => {\n            const targetWs = e.target;\n            if (this._ws !== targetWs) {\n                this._log.info('[socket][error]', targetWs._id, 'skip; this is no longer the current ws');\n                return;\n            }\n            this._log.error('[socket][error]', targetWs._id, e);\n        };\n        this._wsOnClose = (e) => {\n            const targetWs = e.target;\n            if (this._ws !== targetWs) {\n                this._log.info('[socket][close]', targetWs._id, 'skip; this is no longer the current ws');\n                return;\n            }\n            this._setStatus(STATUS.CLOSED);\n            for (const room of Object.values(this._rooms)) {\n                room.isConnected = false;\n            }\n            if (this._isShutdown) {\n                this._log.info('[socket][close]', targetWs._id, 'Reactor has been shut down and will not reconnect');\n                return;\n            }\n            this._log.info('[socket][close]', targetWs._id, 'schedule reconnect, ms =', this._reconnectTimeoutMs);\n            setTimeout(() => {\n                this._reconnectTimeoutMs = Math.min(this._reconnectTimeoutMs + 1000, 10000);\n                if (!this._isOnline) {\n                    this._log.info('[socket][close]', targetWs._id, 'we are offline, no need to start socket');\n                    return;\n                }\n                this._startSocket();\n            }, this._reconnectTimeoutMs);\n        };\n        this.config = Object.assign(Object.assign({}, defaultConfig), config);\n        this._log = createLogger(config.verbose || flags.devBackend || flags.instantLogs);\n        this.versions = Object.assign(Object.assign({}, (versions || {})), { '@instantdb/core': version });\n        if (this.config.schema) {\n            this._linkIndex = createLinkIndex(this.config.schema);\n        }\n        // This is to protect us against running\n        // server-side.\n        if (!isClient()) {\n            return;\n        }\n        if (typeof BroadcastChannel === 'function') {\n            this._broadcastChannel = new BroadcastChannel('@instantdb');\n            this._broadcastChannel.addEventListener('message', (e) => __awaiter(this, void 0, void 0, function* () {\n                var _a;\n                if (((_a = e.data) === null || _a === void 0 ? void 0 : _a.type) === 'auth') {\n                    const res = yield this.getCurrentUser();\n                    this.updateUser(res.user);\n                }\n            }));\n        }\n        this._oauthCallbackResponse = this._oauthLoginInit();\n        this._initStorage(Storage);\n        // kick off a request to cache it\n        this.getCurrentUser();\n        NetworkListener.getIsOnline().then((isOnline) => {\n            this._isOnline = isOnline;\n            this._startSocket();\n            NetworkListener.listen((isOnline) => {\n                // We do this because react native's NetInfo\n                // fires multiple online events.\n                // We only want to handle one state change\n                if (isOnline === this._isOnline) {\n                    return;\n                }\n                this._log.info('[network] online =', isOnline);\n                this._isOnline = isOnline;\n                if (this._isOnline) {\n                    this._startSocket();\n                }\n                else {\n                    this._log.info('Changing status from', this.status, 'to', STATUS.CLOSED);\n                    this._setStatus(STATUS.CLOSED);\n                }\n            });\n        });\n        if (typeof addEventListener !== 'undefined') {\n            this._beforeUnload = this._beforeUnload.bind(this);\n            addEventListener('beforeunload', this._beforeUnload);\n        }\n    }\n    updateSchema(schema) {\n        this.config = Object.assign(Object.assign({}, this.config), { schema: schema, cardinalityInference: Boolean(schema) });\n        this._linkIndex = schema ? createLinkIndex(this.config.schema) : null;\n    }\n    _initStorage(Storage) {\n        this._persister = new Storage(`instant_${this.config.appId}_5`);\n        this.querySubs = new PersistedObject(this._persister, 'querySubs', {}, this._onMergeQuerySubs, querySubsToJSON, querySubsFromJSON);\n        this.pendingMutations = new PersistedObject(this._persister, 'pendingMutations', new Map(), this._onMergePendingMutations, (x) => {\n            return JSON.stringify([...x.entries()]);\n        }, (x) => {\n            return new Map(JSON.parse(x));\n        });\n        this._beforeUnloadCbs.push(() => {\n            this.pendingMutations.flush();\n            this.querySubs.flush();\n        });\n    }\n    _beforeUnload() {\n        for (const cb of this._beforeUnloadCbs) {\n            cb();\n        }\n    }\n    /**\n     * @param {'enqueued' | 'pending' | 'synced' | 'timeout' |  'error' } status\n     * @param string clientId\n     * @param {{message?: string, hint?: string, error?: Error}} [errDetails]\n     */\n    _finishTransaction(status, clientId, errDetails) {\n        const dfd = this.mutationDeferredStore.get(clientId);\n        this.mutationDeferredStore.delete(clientId);\n        const ok = status !== 'error' && status !== 'timeout';\n        if (!dfd && !ok) {\n            // console.erroring here, as there are no listeners to let know\n            console.error('Mutation failed', Object.assign({ status, clientId }, errDetails));\n        }\n        if (!dfd) {\n            return;\n        }\n        if (ok) {\n            dfd.resolve({ status, clientId });\n        }\n        else {\n            dfd.reject(Object.assign({ status, clientId }, errDetails));\n        }\n    }\n    _setStatus(status, err) {\n        this.status = status;\n        this._errorMessage = err;\n        this.notifyConnectionStatusSubs(status);\n    }\n    _flushEnqueuedRoomData(roomId) {\n        var _a, _b;\n        const enqueuedUserPresence = (_b = (_a = this._presence[roomId]) === null || _a === void 0 ? void 0 : _a.result) === null || _b === void 0 ? void 0 : _b.user;\n        const enqueuedBroadcasts = this._broadcastQueue[roomId];\n        this._broadcastQueue[roomId] = [];\n        if (enqueuedUserPresence) {\n            this._trySetPresence(roomId, enqueuedUserPresence);\n        }\n        if (enqueuedBroadcasts) {\n            for (const item of enqueuedBroadcasts) {\n                const { topic, roomType, data } = item;\n                this._tryBroadcast(roomId, roomType, topic, data);\n            }\n        }\n    }\n    _handleReceive(wsId, msg) {\n        var _a, _b, _c, _d, _e, _f;\n        // opt-out, enabled by default if schema\n        const enableCardinalityInference = Boolean(this.config.schema) &&\n            ('cardinalityInference' in this.config\n                ? Boolean(this.config.cardinalityInference)\n                : true);\n        if (!ignoreLogging[msg.op]) {\n            this._log.info('[receive]', wsId, msg.op, msg);\n        }\n        switch (msg.op) {\n            case 'init-ok':\n                this._setStatus(STATUS.AUTHENTICATED);\n                this._reconnectTimeoutMs = 0;\n                this._setAttrs(msg.attrs);\n                this._flushPendingMessages();\n                // (EPH): set session-id, so we know\n                // which item is us\n                this._sessionId = msg['session-id'];\n                for (const roomId of Object.keys(this._rooms)) {\n                    const enqueuedUserPresence = (_b = (_a = this._presence[roomId]) === null || _a === void 0 ? void 0 : _a.result) === null || _b === void 0 ? void 0 : _b.user;\n                    this._tryJoinRoom(roomId, enqueuedUserPresence);\n                }\n                break;\n            case 'add-query-exists':\n                this.notifyOneQueryOnce(weakHash(msg.q));\n                break;\n            case 'add-query-ok':\n                const { q, result } = msg;\n                const hash = weakHash(q);\n                const pageInfo = (_d = (_c = result === null || result === void 0 ? void 0 : result[0]) === null || _c === void 0 ? void 0 : _c.data) === null || _d === void 0 ? void 0 : _d['page-info'];\n                const aggregate = (_f = (_e = result === null || result === void 0 ? void 0 : result[0]) === null || _e === void 0 ? void 0 : _e.data) === null || _f === void 0 ? void 0 : _f['aggregate'];\n                const triples = extractTriples(result);\n                const store = s.createStore(this.attrs, triples, enableCardinalityInference, this._linkIndex);\n                this.querySubs.set((prev) => {\n                    prev[hash].result = { store, pageInfo, aggregate };\n                    return prev;\n                });\n                this.notifyOne(hash);\n                this.notifyOneQueryOnce(hash);\n                break;\n            case 'refresh-ok':\n                const { computations, attrs } = msg;\n                this._setAttrs(attrs);\n                const updates = computations.map((x) => {\n                    var _a, _b, _c, _d;\n                    const q = x['instaql-query'];\n                    const result = x['instaql-result'];\n                    const hash = weakHash(q);\n                    const triples = extractTriples(result);\n                    const store = s.createStore(this.attrs, triples, enableCardinalityInference, this._linkIndex);\n                    const pageInfo = (_b = (_a = result === null || result === void 0 ? void 0 : result[0]) === null || _a === void 0 ? void 0 : _a.data) === null || _b === void 0 ? void 0 : _b['page-info'];\n                    const aggregate = (_d = (_c = result === null || result === void 0 ? void 0 : result[0]) === null || _c === void 0 ? void 0 : _c.data) === null || _d === void 0 ? void 0 : _d['aggregate'];\n                    return { hash, store, pageInfo, aggregate };\n                });\n                updates.forEach(({ hash, store, pageInfo, aggregate }) => {\n                    this.querySubs.set((prev) => {\n                        prev[hash].result = { store, pageInfo, aggregate };\n                        return prev;\n                    });\n                });\n                updates.forEach(({ hash }) => {\n                    this.notifyOne(hash);\n                });\n                break;\n            case 'transact-ok':\n                const { 'client-event-id': eventId, 'tx-id': txId } = msg;\n                const muts = this._rewriteMutations(this.attrs, this.pendingMutations.currentValue);\n                const prevMutation = muts.get(eventId);\n                if (!prevMutation) {\n                    break;\n                }\n                // Now that this transaction is accepted,\n                // We can delete it from our queue.\n                this.pendingMutations.set((prev) => {\n                    prev.delete(eventId);\n                    return prev;\n                });\n                // We apply this transaction to all our existing queries\n                const txStepsToApply = prevMutation['tx-steps'];\n                this.querySubs.set((prev) => {\n                    var _a;\n                    for (const [hash, sub] of Object.entries(prev)) {\n                        const store = (_a = sub === null || sub === void 0 ? void 0 : sub.result) === null || _a === void 0 ? void 0 : _a.store;\n                        if (!store) {\n                            continue;\n                        }\n                        const newStore = s.transact(store, txStepsToApply);\n                        prev[hash].result.store = newStore;\n                    }\n                    return prev;\n                });\n                const newAttrs = prevMutation['tx-steps']\n                    .filter(([action, ..._args]) => action === 'add-attr')\n                    .map(([_action, attr]) => attr)\n                    .concat(Object.values(this.attrs));\n                this._setAttrs(newAttrs);\n                this._finishTransaction('synced', eventId);\n                break;\n            case 'patch-presence': {\n                const roomId = msg['room-id'];\n                this._patchPresencePeers(roomId, msg['edits']);\n                this._notifyPresenceSubs(roomId);\n                break;\n            }\n            case 'refresh-presence': {\n                const roomId = msg['room-id'];\n                this._setPresencePeers(roomId, msg['data']);\n                this._notifyPresenceSubs(roomId);\n                break;\n            }\n            case 'server-broadcast':\n                const room = msg['room-id'];\n                const topic = msg.topic;\n                this._notifyBroadcastSubs(room, topic, msg);\n                break;\n            case 'join-room-ok':\n                const loadingRoomId = msg['room-id'];\n                const joinedRoom = this._rooms[loadingRoomId];\n                if (!joinedRoom) {\n                    if (this._roomsPendingLeave[loadingRoomId]) {\n                        this._tryLeaveRoom(loadingRoomId);\n                        delete this._roomsPendingLeave[loadingRoomId];\n                    }\n                    break;\n                }\n                joinedRoom.isConnected = true;\n                this._notifyPresenceSubs(loadingRoomId);\n                this._flushEnqueuedRoomData(loadingRoomId);\n                break;\n            case 'join-room-error':\n                const errorRoomId = msg['room-id'];\n                const errorRoom = this._rooms[errorRoomId];\n                if (errorRoom) {\n                    errorRoom.error = msg['error'];\n                }\n                this._notifyPresenceSubs(errorRoomId);\n                break;\n            case 'error':\n                this._handleReceiveError(msg);\n                break;\n            default:\n                break;\n        }\n    }\n    /**\n     * @param {'timeout' | 'error'} status\n     * @param {string} eventId\n     * @param {{message?: string, hint?: string, error?: Error}} errDetails\n     */\n    _handleMutationError(status, eventId, errDetails) {\n        const mut = this.pendingMutations.currentValue.get(eventId);\n        if (mut && (status !== 'timeout' || !mut['tx-id'])) {\n            this.pendingMutations.set((prev) => {\n                prev.delete(eventId);\n                return prev;\n            });\n            this.notifyAll();\n            this.notifyAttrsSubs();\n            this.notifyMutationErrorSubs(errDetails);\n            this._finishTransaction(status, eventId, errDetails);\n        }\n    }\n    _handleReceiveError(msg) {\n        var _a, _b, _c, _d, _e;\n        const eventId = msg['client-event-id'];\n        const prevMutation = this.pendingMutations.currentValue.get(eventId);\n        const errorMessage = {\n            message: msg.message || 'Uh-oh, something went wrong. Ping Joe & Stopa.',\n        };\n        if (msg.hint) {\n            errorMessage.hint = msg.hint;\n        }\n        if (prevMutation) {\n            // This must be a transaction error\n            const errDetails = {\n                message: msg.message,\n                hint: msg.hint,\n            };\n            this._handleMutationError('error', eventId, errDetails);\n            return;\n        }\n        if (((_a = msg['original-event']) === null || _a === void 0 ? void 0 : _a.hasOwnProperty('q')) &&\n            ((_b = msg['original-event']) === null || _b === void 0 ? void 0 : _b.op) === 'add-query') {\n            const q = (_c = msg['original-event']) === null || _c === void 0 ? void 0 : _c.q;\n            const hash = weakHash(q);\n            this.notifyQueryError(weakHash(q), errorMessage);\n            this.notifyQueryOnceError(q, hash, eventId, errorMessage);\n            return;\n        }\n        const isInitError = ((_d = msg['original-event']) === null || _d === void 0 ? void 0 : _d.op) === 'init';\n        if (isInitError) {\n            if (msg.type === 'record-not-found' &&\n                ((_e = msg.hint) === null || _e === void 0 ? void 0 : _e['record-type']) === 'app-user') {\n                // User has been logged out\n                this.changeCurrentUser(null);\n                return;\n            }\n            // We failed to init\n            this._setStatus(STATUS.ERRORED, errorMessage);\n            this.notifyAll();\n            return;\n        }\n        // We've caught some error which has no corresponding listener.\n        // Let's console.error to let the user know.\n        const errorObj = Object.assign({}, msg);\n        delete errorObj.message;\n        delete errorObj.hint;\n        console.error(msg.message, errorObj);\n        if (msg.hint) {\n            console.error('This error comes with some debugging information. Here it is: \\n', msg.hint);\n        }\n    }\n    notifyQueryOnceError(q, hash, eventId, e) {\n        var _a;\n        const r = (_a = this.queryOnceDfds[hash]) === null || _a === void 0 ? void 0 : _a.find((r) => r.eventId === eventId);\n        if (!r)\n            return;\n        r.dfd.reject(e);\n        this._completeQueryOnce(q, hash, r.dfd);\n    }\n    _setAttrs(attrs) {\n        this.attrs = attrs.reduce((acc, attr) => {\n            acc[attr.id] = attr;\n            return acc;\n        }, {});\n        this.notifyAttrsSubs();\n    }\n    _startQuerySub(q, hash) {\n        const eventId = uuid();\n        this.querySubs.set((prev) => {\n            prev[hash] = prev[hash] || { q, result: null, eventId };\n            return prev;\n        });\n        this._trySendAuthed(eventId, { op: 'add-query', q });\n        return eventId;\n    }\n    /**\n     *  When a user subscribes to a query the following side effects occur:\n     *\n     *  - We update querySubs to include the new query\n     *  - We update queryCbs to include the new cb\n     *  - If we already have a result for the query we call cb immediately\n     *  - We send the server an `add-query` message\n     *\n     *  Returns an unsubscribe function\n     */\n    subscribeQuery(q, cb, opts) {\n        var _a;\n        if (opts && 'ruleParams' in opts) {\n            q = Object.assign({ $$ruleParams: opts['ruleParams'] }, q);\n        }\n        const hash = weakHash(q);\n        const prevResult = this.getPreviousResult(q);\n        if (prevResult) {\n            cb(prevResult);\n        }\n        this.queryCbs[hash] = (_a = this.queryCbs[hash]) !== null && _a !== void 0 ? _a : [];\n        this.queryCbs[hash].push({ q, cb });\n        this._startQuerySub(q, hash);\n        return () => {\n            this._unsubQuery(q, hash, cb);\n        };\n    }\n    queryOnce(q, opts) {\n        var _a;\n        if (opts && 'ruleParams' in opts) {\n            q = Object.assign({ $$ruleParams: opts['ruleParams'] }, q);\n        }\n        const dfd = new Deferred();\n        if (!this._isOnline) {\n            dfd.reject(new Error(\"We can't run `queryOnce`, because the device is offline.\"));\n            return dfd.promise;\n        }\n        if (!this.querySubs) {\n            dfd.reject(new Error(\"We can't run `queryOnce` on the backend. Use adminAPI.query instead: https://www.instantdb.com/docs/backend#query\"));\n            return dfd.promise;\n        }\n        const hash = weakHash(q);\n        const eventId = this._startQuerySub(q, hash);\n        this.queryOnceDfds[hash] = (_a = this.queryOnceDfds[hash]) !== null && _a !== void 0 ? _a : [];\n        this.queryOnceDfds[hash].push({ q, dfd, eventId });\n        setTimeout(() => dfd.reject(new Error('Query timed out')), QUERY_ONCE_TIMEOUT);\n        return dfd.promise;\n    }\n    _completeQueryOnce(q, hash, dfd) {\n        if (!this.queryOnceDfds[hash])\n            return;\n        this.queryOnceDfds[hash] = this.queryOnceDfds[hash].filter((r) => r.dfd !== dfd);\n        this._cleanupQuery(q, hash);\n    }\n    _unsubQuery(q, hash, cb) {\n        if (!this.queryCbs[hash])\n            return;\n        this.queryCbs[hash] = this.queryCbs[hash].filter((r) => r.cb !== cb);\n        this._cleanupQuery(q, hash);\n    }\n    _cleanupQuery(q, hash) {\n        var _a, _b;\n        const hasListeners = ((_a = this.queryCbs[hash]) === null || _a === void 0 ? void 0 : _a.length) || ((_b = this.queryOnceDfds[hash]) === null || _b === void 0 ? void 0 : _b.length);\n        if (hasListeners)\n            return;\n        delete this.queryCbs[hash];\n        delete this.queryOnceDfds[hash];\n        this._trySendAuthed(uuid(), { op: 'remove-query', q });\n    }\n    // When we `pushTx`, it's possible that we don't yet have `this.attrs`\n    // This means that `tx-steps` in `pendingMutations` will include `add-attr`\n    // commands for attrs that already exist.\n    //\n    // This will also affect `add-triple` and `retract-triple` which\n    // reference attr-ids that do not match the server.\n    //\n    // We fix this by rewriting `tx-steps` in each `pendingMutation`.\n    // We remove `add-attr` commands for attrs that already exist.\n    // We update `add-triple` and `retract-triple` commands to use the\n    // server attr-ids.\n    _rewriteMutations(attrs, muts) {\n        if (!attrs)\n            return muts;\n        const findExistingAttr = (attr) => {\n            const [_, etype, label] = attr['forward-identity'];\n            const existing = instaml.getAttrByFwdIdentName(attrs, etype, label);\n            return existing;\n        };\n        const findReverseAttr = (attr) => {\n            const [_, etype, label] = attr['forward-identity'];\n            const revAttr = instaml.getAttrByReverseIdentName(attrs, etype, label);\n            return revAttr;\n        };\n        const mapping = { attrIdMap: {}, refSwapAttrIds: new Set() };\n        const rewriteTxSteps = (txSteps) => {\n            const retTxSteps = [];\n            for (const txStep of txSteps) {\n                const [action] = txStep;\n                // Handles add-attr\n                // If existing, we drop it, and track it\n                // to update add/retract triples\n                if (action === 'add-attr') {\n                    const [_action, attr] = txStep;\n                    const existing = findExistingAttr(attr);\n                    if (existing) {\n                        mapping.attrIdMap[attr.id] = existing.id;\n                        continue;\n                    }\n                    if (attr['value-type'] === 'ref') {\n                        const revAttr = findReverseAttr(attr);\n                        if (revAttr) {\n                            mapping.attrIdMap[attr.id] = revAttr.id;\n                            mapping.refSwapAttrIds.add(attr.id);\n                            continue;\n                        }\n                    }\n                }\n                // Handles add-triple|retract-triple\n                // If in mapping, we update the attr-id\n                const newTxStep = instaml.rewriteStep(mapping, txStep);\n                retTxSteps.push(newTxStep);\n            }\n            return retTxSteps;\n        };\n        const rewritten = new Map();\n        for (const [k, mut] of muts.entries()) {\n            rewritten.set(k, Object.assign(Object.assign({}, mut), { 'tx-steps': rewriteTxSteps(mut['tx-steps']) }));\n        }\n        return rewritten;\n    }\n    // ---------------------------\n    // Transact\n    optimisticAttrs() {\n        var _a;\n        const pendingMutationSteps = [\n            ...this.pendingMutations.currentValue.values(),\n        ] // hack due to Map()\n            .flatMap((x) => x['tx-steps']);\n        const deletedAttrIds = new Set(pendingMutationSteps\n            .filter(([action, _attr]) => action === 'delete-attr')\n            .map(([_action, id]) => id));\n        const pendingAttrs = [];\n        for (const [_action, attr] of pendingMutationSteps) {\n            if (_action === 'add-attr') {\n                pendingAttrs.push(attr);\n            }\n            else if (_action === 'update-attr' &&\n                attr.id &&\n                ((_a = this.attrs) === null || _a === void 0 ? void 0 : _a[attr.id])) {\n                const fullAttr = Object.assign(Object.assign({}, this.attrs[attr.id]), attr);\n                pendingAttrs.push(fullAttr);\n            }\n        }\n        const attrsWithoutDeleted = [\n            ...Object.values(this.attrs || {}),\n            ...pendingAttrs,\n        ].filter((a) => !deletedAttrIds.has(a.id));\n        const attrsRecord = Object.fromEntries(attrsWithoutDeleted.map((a) => [a.id, a]));\n        return attrsRecord;\n    }\n    /** Runs instaql on a query and a store */\n    dataForQuery(hash) {\n        const errorMessage = this._errorMessage;\n        if (errorMessage) {\n            return { error: errorMessage };\n        }\n        if (!this.querySubs)\n            return;\n        if (!this.pendingMutations)\n            return;\n        const querySubVersion = this.querySubs.version();\n        const querySubs = this.querySubs.currentValue;\n        const pendingMutationsVersion = this.pendingMutations.version();\n        const pendingMutations = this.pendingMutations.currentValue;\n        const { q, result } = querySubs[hash] || {};\n        if (!result)\n            return;\n        const cached = this._dataForQueryCache[hash];\n        if (cached &&\n            querySubVersion === cached.querySubVersion &&\n            pendingMutationsVersion === cached.pendingMutationsVersion) {\n            return cached.data;\n        }\n        const { store, pageInfo, aggregate } = result;\n        const muts = this._rewriteMutations(store.attrs, pendingMutations);\n        const txSteps = [...muts.values()].flatMap((x) => x['tx-steps']);\n        const newStore = s.transact(store, txSteps);\n        const resp = instaql({ store: newStore, pageInfo, aggregate }, q);\n        this._dataForQueryCache[hash] = {\n            querySubVersion,\n            pendingMutationsVersion,\n            data: resp,\n        };\n        return resp;\n    }\n    /** Re-compute all subscriptions */\n    notifyAll() {\n        Object.keys(this.queryCbs).forEach((hash) => {\n            this.notifyOne(hash);\n        });\n    }\n    loadedNotifyAll() {\n        if (this.pendingMutations.isLoading() || this.querySubs.isLoading())\n            return;\n        this.notifyAll();\n    }\n    shutdown() {\n        var _a;\n        this._log.info('[shutdown]', this.config.appId);\n        this._isShutdown = true;\n        (_a = this._ws) === null || _a === void 0 ? void 0 : _a.close();\n    }\n    /**\n     * Sends mutation to server and schedules a timeout to cancel it if\n     * we don't hear back in time.\n     * Note: If we're offline we don't schedule a timeout, we'll schedule it\n     * later once we're back online and send the mutation again\n     *\n     */\n    _sendMutation(eventId, mutation) {\n        if (mutation.error) {\n            this._handleMutationError('error', eventId, {\n                error: mutation.error,\n                message: mutation.error.message,\n            });\n            return;\n        }\n        if (this.status !== STATUS.AUTHENTICATED) {\n            this._finishTransaction('enqueued', eventId);\n            return;\n        }\n        const timeoutMs = Math.max(5000, this.pendingMutations.currentValue.size * 5000);\n        if (!this._isOnline) {\n            this._finishTransaction('enqueued', eventId);\n        }\n        else {\n            this._trySend(eventId, mutation);\n            // If a transaction is pending for over 3 seconds,\n            // we want to unblock the UX, so mark it as pending\n            // and keep trying to process the transaction in the background\n            setTimeout(() => {\n                this._finishTransaction('pending', eventId);\n            }, 3000);\n            setTimeout(() => {\n                if (!this._isOnline) {\n                    return;\n                }\n                // If we are here, this means that we have sent this mutation, we are online\n                // but we have not received a response. If it's this long, something must be wrong,\n                // so we error with a timeout.\n                this._handleMutationError('timeout', eventId, {\n                    message: 'transaction timed out',\n                });\n            }, timeoutMs);\n        }\n    }\n    // ---------------------------\n    // Websocket\n    /** Send messages we accumulated while we were connecting */\n    _flushPendingMessages() {\n        const subs = Object.keys(this.queryCbs).map((hash) => {\n            return this.querySubs.currentValue[hash];\n        });\n        // Note: we should not have any nulls in subs, but we're\n        // doing this defensively just in case.\n        const safeSubs = subs.filter((x) => x);\n        safeSubs.forEach(({ eventId, q }) => {\n            this._trySendAuthed(eventId, { op: 'add-query', q });\n        });\n        Object.values(this.queryOnceDfds)\n            .flat()\n            .forEach(({ eventId, q }) => {\n            this._trySendAuthed(eventId, { op: 'add-query', q });\n        });\n        const muts = this._rewriteMutations(this.attrs, this.pendingMutations.currentValue);\n        muts.forEach((mut, eventId) => {\n            if (!mut['tx-id']) {\n                this._sendMutation(eventId, mut);\n            }\n        });\n    }\n    _trySendAuthed(...args) {\n        if (this.status !== STATUS.AUTHENTICATED) {\n            return;\n        }\n        this._trySend(...args);\n    }\n    _trySend(eventId, msg, opts) {\n        if (this._ws.readyState !== WS_OPEN_STATUS) {\n            return;\n        }\n        if (!ignoreLogging[msg.op]) {\n            this._log.info('[send]', this._ws._id, msg.op, msg);\n        }\n        this._ws.send(JSON.stringify(Object.assign({ 'client-event-id': eventId }, msg)));\n    }\n    _startSocket() {\n        if (this._isShutdown) {\n            this._log.info('[socket][start]', this.config.appId, 'Reactor has been shut down and will not start a new socket');\n            return;\n        }\n        if (this._ws && this._ws.readyState == WS_CONNECTING_STATUS) {\n            // Our current websocket is in a 'connecting' state.\n            // There's no need to start another one, as the socket is\n            // effectively fresh.\n            this._log.info('[socket][start]', this._ws._id, 'maintained as current ws, we were still in a connecting state');\n            return;\n        }\n        const prevWs = this._ws;\n        this._ws = createWebSocket(`${this.config.websocketURI}?app_id=${this.config.appId}`);\n        this._ws.onopen = this._wsOnOpen;\n        this._ws.onmessage = this._wsOnMessage;\n        this._ws.onclose = this._wsOnClose;\n        this._ws.onerror = this._wsOnError;\n        this._log.info('[socket][start]', this._ws._id);\n        if ((prevWs === null || prevWs === void 0 ? void 0 : prevWs.readyState) === WS_OPEN_STATUS) {\n            // When the network dies, it doesn't always mean that our\n            // socket connection will fire a close event.\n            //\n            // We _could_ re-use the old socket, if the network drop was a\n            // few seconds. But, to be safe right now we always create a new socket.\n            //\n            // This means that we have to make sure to kill the previous one ourselves.\n            // c.f https://issues.chromium.org/issues/41343684\n            this._log.info('[socket][start]', this._ws._id, 'close previous ws id = ', prevWs._id);\n            prevWs.close();\n        }\n    }\n    /**\n     * Given a key, returns a stable local id, unique to this device and app.\n     *\n     * This can be useful if you want to create guest ids for example.\n     *\n     * Note: If the user deletes their local storage, this id will change.\n     *\n     * We use this._localIdPromises to ensure that we only generate a local\n     * id once, even if multiple callers call this function concurrently.\n     */\n    getLocalId(name) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const k = `localToken_${name}`;\n            const id = yield this._persister.getItem(k);\n            if (id)\n                return id;\n            if (this._localIdPromises[k]) {\n                return this._localIdPromises[k];\n            }\n            const newId = uuid();\n            this._localIdPromises[k] = this._persister\n                .setItem(k, newId)\n                .then(() => newId);\n            return this._localIdPromises[k];\n        });\n    }\n    // ----\n    // Auth\n    _replaceUrlAfterOAuth() {\n        if (typeof URL === 'undefined') {\n            return;\n        }\n        const url = new URL(window.location.href);\n        if (url.searchParams.get(OAUTH_REDIRECT_PARAM)) {\n            const startUrl = url.toString();\n            url.searchParams.delete(OAUTH_REDIRECT_PARAM);\n            url.searchParams.delete('code');\n            url.searchParams.delete('error');\n            const newPath = url.pathname +\n                (url.searchParams.size ? '?' + url.searchParams : '') +\n                url.hash;\n            // Note: In next.js, this will revert to the old state if user navigates\n            //       back. We would need to allow framework specific routing to work\n            //       around that problem.\n            history.replaceState(history.state, '', newPath);\n            // navigation is part of the HTML spec, but not supported by Safari\n            // or Firefox yet:\n            // https://developer.mozilla.org/en-US/docs/Web/API/Navigation_API#browser_compatibility\n            if (\n            // @ts-ignore (waiting for ts support)\n            typeof navigation === 'object' &&\n                // @ts-ignore (waiting for ts support)\n                typeof navigation.addEventListener === 'function' &&\n                // @ts-ignore (waiting for ts support)\n                typeof navigation.removeEventListener === 'function') {\n                let ran = false;\n                // The next.js app router will reset the URL when the router loads.\n                // This puts it back after the router loads.\n                const listener = (e) => {\n                    var _a;\n                    if (!ran) {\n                        ran = true;\n                        // @ts-ignore (waiting for ts support)\n                        navigation.removeEventListener('navigate', listener);\n                        if (!e.userInitiated &&\n                            e.navigationType === 'replace' &&\n                            ((_a = e.destination) === null || _a === void 0 ? void 0 : _a.url) === startUrl) {\n                            history.replaceState(history.state, '', newPath);\n                        }\n                    }\n                };\n                // @ts-ignore (waiting for ts support)\n                navigation.addEventListener('navigate', listener);\n            }\n        }\n    }\n    /**\n     *\n     * @returns Promise<null | {error: {message: string}}>\n     */\n    _oauthLoginInit() {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a, _b, _c, _d;\n            if (typeof window === 'undefined' ||\n                typeof window.location === 'undefined' ||\n                typeof URLSearchParams === 'undefined') {\n                return null;\n            }\n            const params = new URLSearchParams(window.location.search);\n            if (!params.get(OAUTH_REDIRECT_PARAM)) {\n                return null;\n            }\n            const error = params.get('error');\n            if (error) {\n                this._replaceUrlAfterOAuth();\n                return { error: { message: error } };\n            }\n            const code = params.get('code');\n            if (!code) {\n                return null;\n            }\n            this._replaceUrlAfterOAuth();\n            try {\n                const { user } = yield authAPI.exchangeCodeForToken({\n                    apiURI: this.config.apiURI,\n                    appId: this.config.appId,\n                    code,\n                });\n                this.setCurrentUser(user);\n                return null;\n            }\n            catch (e) {\n                if (((_a = e === null || e === void 0 ? void 0 : e.body) === null || _a === void 0 ? void 0 : _a.type) === 'record-not-found' &&\n                    ((_c = (_b = e === null || e === void 0 ? void 0 : e.body) === null || _b === void 0 ? void 0 : _b.hint) === null || _c === void 0 ? void 0 : _c['record-type']) === 'app-oauth-code' &&\n                    (yield this._hasCurrentUser())) {\n                    // We probably just weren't able to clean up the URL, so\n                    // let's just ignore this error\n                    return null;\n                }\n                const message = ((_d = e === null || e === void 0 ? void 0 : e.body) === null || _d === void 0 ? void 0 : _d.message) || 'Error logging in.';\n                return { error: { message } };\n            }\n        });\n    }\n    _waitForOAuthCallbackResponse() {\n        return __awaiter(this, void 0, void 0, function* () {\n            return yield this._oauthCallbackResponse;\n        });\n    }\n    __subscribeMutationErrors(cb) {\n        this.mutationErrorCbs.push(cb);\n        return () => {\n            this.mutationErrorCbs = this.mutationErrorCbs.filter((x) => x !== cb);\n        };\n    }\n    subscribeAuth(cb) {\n        this.authCbs.push(cb);\n        const currUserCached = this._currentUserCached;\n        if (!currUserCached.isLoading) {\n            cb(this._currentUserCached);\n        }\n        let unsubbed = false;\n        this.getCurrentUser().then((resp) => {\n            if (unsubbed)\n                return;\n            if (areObjectsDeepEqual(resp, currUserCached))\n                return;\n            cb(resp);\n        });\n        return () => {\n            unsubbed = true;\n            this.authCbs = this.authCbs.filter((x) => x !== cb);\n        };\n    }\n    getAuth() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { user, error } = yield this.getCurrentUser();\n            if (error) {\n                throw error;\n            }\n            return user;\n        });\n    }\n    subscribeConnectionStatus(cb) {\n        this.connectionStatusCbs.push(cb);\n        return () => {\n            this.connectionStatusCbs = this.connectionStatusCbs.filter((x) => x !== cb);\n        };\n    }\n    subscribeAttrs(cb) {\n        this.attrsCbs.push(cb);\n        if (this.attrs) {\n            cb(this.attrs);\n        }\n        return () => {\n            this.attrsCbs = this.attrsCbs.filter((x) => x !== cb);\n        };\n    }\n    notifyAuthSubs(user) {\n        this.authCbs.forEach((cb) => cb(user));\n    }\n    notifyMutationErrorSubs(error) {\n        this.mutationErrorCbs.forEach((cb) => cb(error));\n    }\n    notifyAttrsSubs() {\n        if (!this.attrs)\n            return;\n        const oas = this.optimisticAttrs();\n        this.attrsCbs.forEach((cb) => cb(oas));\n    }\n    notifyConnectionStatusSubs(status) {\n        this.connectionStatusCbs.forEach((cb) => cb(status));\n    }\n    setCurrentUser(user) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this._persister.setItem(currentUserKey, JSON.stringify(user));\n        });\n    }\n    getCurrentUserCached() {\n        return this._currentUserCached;\n    }\n    getCurrentUser() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const oauthResp = yield this._waitForOAuthCallbackResponse();\n            if (oauthResp === null || oauthResp === void 0 ? void 0 : oauthResp.error) {\n                const errorV = { error: oauthResp.error, user: undefined };\n                this._currentUserCached = Object.assign({ isLoading: false }, errorV);\n                return errorV;\n            }\n            const user = yield this._persister.getItem(currentUserKey);\n            const userV = { user: JSON.parse(user), error: undefined };\n            this._currentUserCached = Object.assign({ isLoading: false }, userV);\n            return userV;\n        });\n    }\n    _hasCurrentUser() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const user = yield this._persister.getItem(currentUserKey);\n            return JSON.parse(user) != null;\n        });\n    }\n    changeCurrentUser(newUser) {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            const { user: oldUser } = yield this.getCurrentUser();\n            if (areObjectsDeepEqual(oldUser, newUser)) {\n                // We were already logged in as the newUser, don't\n                // bother updating\n                return;\n            }\n            yield this.setCurrentUser(newUser);\n            // We need to remove all `result` from querySubs,\n            // as they are no longer valid for the new user\n            this.updateUser(newUser);\n            try {\n                (_a = this._broadcastChannel) === null || _a === void 0 ? void 0 : _a.postMessage({ type: 'auth' });\n            }\n            catch (error) {\n                console.error('Error posting message to broadcast channel', error);\n            }\n        });\n    }\n    updateUser(newUser) {\n        const newV = { error: undefined, user: newUser };\n        this._currentUserCached = Object.assign({ isLoading: false }, newV);\n        this._dataForQueryCache = {};\n        this.querySubs.set((prev) => {\n            Object.keys(prev).forEach((k) => {\n                delete prev[k].result;\n            });\n            return prev;\n        });\n        this._reconnectTimeoutMs = 0;\n        this._ws.close();\n        this._oauthCallbackResponse = null;\n        this.notifyAuthSubs(newV);\n    }\n    sendMagicCode({ email }) {\n        return authAPI.sendMagicCode({\n            apiURI: this.config.apiURI,\n            appId: this.config.appId,\n            email: email,\n        });\n    }\n    signInWithMagicCode(_a) {\n        return __awaiter(this, arguments, void 0, function* ({ email, code }) {\n            const res = yield authAPI.verifyMagicCode({\n                apiURI: this.config.apiURI,\n                appId: this.config.appId,\n                email,\n                code,\n            });\n            yield this.changeCurrentUser(res.user);\n            return res;\n        });\n    }\n    signInWithCustomToken(authToken) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const res = yield authAPI.verifyRefreshToken({\n                apiURI: this.config.apiURI,\n                appId: this.config.appId,\n                refreshToken: authToken,\n            });\n            yield this.changeCurrentUser(res.user);\n            return res;\n        });\n    }\n    potentiallyInvalidateToken(currentUser, opts) {\n        var _a;\n        const refreshToken = (_a = currentUser === null || currentUser === void 0 ? void 0 : currentUser.user) === null || _a === void 0 ? void 0 : _a.refresh_token;\n        if (!refreshToken) {\n            return;\n        }\n        const wantsToSkip = opts.invalidateToken === false;\n        if (wantsToSkip) {\n            this._log.info('[auth-invalidate] skipped invalidateToken');\n            return;\n        }\n        authAPI\n            .signOut({\n            apiURI: this.config.apiURI,\n            appId: this.config.appId,\n            refreshToken,\n        })\n            .then(() => {\n            this._log.info('[auth-invalidate] completed invalidateToken');\n        })\n            .catch((e) => { });\n    }\n    signOut(opts) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const currentUser = yield this.getCurrentUser();\n            this.potentiallyInvalidateToken(currentUser, opts);\n            yield this.changeCurrentUser(null);\n        });\n    }\n    /**\n     * Creates an OAuth authorization URL.\n     * @param {Object} params - The parameters to create the authorization URL.\n     * @param {string} params.clientName - The name of the client requesting authorization.\n     * @param {string} params.redirectURL - The URL to redirect users to after authorization.\n     * @returns {string} The created authorization URL.\n     */\n    createAuthorizationURL({ clientName, redirectURL }) {\n        const { apiURI, appId } = this.config;\n        return `${apiURI}/runtime/oauth/start?app_id=${appId}&client_name=${clientName}&redirect_uri=${redirectURL}`;\n    }\n    /**\n     * @param {Object} params\n     * @param {string} params.code - The code received from the OAuth service.\n     * @param {string} [params.codeVerifier] - The code verifier used to generate the code challenge.\n     */\n    exchangeCodeForToken(_a) {\n        return __awaiter(this, arguments, void 0, function* ({ code, codeVerifier }) {\n            const res = yield authAPI.exchangeCodeForToken({\n                apiURI: this.config.apiURI,\n                appId: this.config.appId,\n                code: code,\n                codeVerifier,\n            });\n            yield this.changeCurrentUser(res.user);\n            return res;\n        });\n    }\n    issuerURI() {\n        const { apiURI, appId } = this.config;\n        return `${apiURI}/runtime/${appId}`;\n    }\n    /**\n     * @param {Object} params\n     * @param {string} params.clientName - The name of the client requesting authorization.\n     * @param {string} params.idToken - The id_token from the external service\n     * @param {string | null | undefined} [params.nonce] - The nonce used when requesting the id_token from the external service\n     */\n    signInWithIdToken(_a) {\n        return __awaiter(this, arguments, void 0, function* ({ idToken, clientName, nonce }) {\n            var _b;\n            const currentUser = yield this.getCurrentUser();\n            const refreshToken = (_b = currentUser === null || currentUser === void 0 ? void 0 : currentUser.user) === null || _b === void 0 ? void 0 : _b.refresh_token;\n            const res = yield authAPI.signInWithIdToken({\n                apiURI: this.config.apiURI,\n                appId: this.config.appId,\n                idToken,\n                clientName,\n                nonce,\n                refreshToken,\n            });\n            yield this.changeCurrentUser(res.user);\n            return res;\n        });\n    }\n    // --------\n    // Rooms\n    /**\n     * @param {string} roomId\n     * @param {any | null | undefined} [initialData] -- initial presence data to send when joining the room\n     * @returns () => void\n     */\n    joinRoom(roomId, initialData) {\n        if (!this._rooms[roomId]) {\n            this._rooms[roomId] = {\n                isConnected: false,\n                error: undefined,\n            };\n        }\n        this._presence[roomId] = this._presence[roomId] || {};\n        if (initialData) {\n            this._presence[roomId].result = this._presence[roomId].result || {};\n            this._presence[roomId].result.user = initialData;\n            this._notifyPresenceSubs(roomId);\n        }\n        this._tryJoinRoom(roomId, initialData);\n        return () => {\n            this._cleanupRoom(roomId);\n        };\n    }\n    _cleanupRoom(roomId) {\n        var _a, _b, _c, _d;\n        if (!((_b = (_a = this._presence[roomId]) === null || _a === void 0 ? void 0 : _a.handlers) === null || _b === void 0 ? void 0 : _b.length) &&\n            !Object.keys((_c = this._broadcastSubs[roomId]) !== null && _c !== void 0 ? _c : {}).length) {\n            const isConnected = (_d = this._rooms[roomId]) === null || _d === void 0 ? void 0 : _d.isConnected;\n            delete this._rooms[roomId];\n            delete this._presence[roomId];\n            delete this._broadcastSubs[roomId];\n            if (isConnected) {\n                this._tryLeaveRoom(roomId);\n            }\n            else {\n                this._roomsPendingLeave[roomId] = true;\n            }\n        }\n    }\n    // --------\n    // Presence\n    // TODO: look into typing again\n    getPresence(roomType, roomId, opts = {}) {\n        const room = this._rooms[roomId];\n        const presence = this._presence[roomId];\n        if (!room || !presence || !presence.result)\n            return null;\n        return Object.assign(Object.assign({}, buildPresenceSlice(presence.result, opts, this._sessionId)), { isLoading: !room.isConnected, error: room.error });\n    }\n    // TODO: look into typing again\n    publishPresence(roomType, roomId, partialData) {\n        const room = this._rooms[roomId];\n        const presence = this._presence[roomId];\n        if (!room || !presence) {\n            return;\n        }\n        presence.result = presence.result || {};\n        const data = Object.assign(Object.assign({}, presence.result.user), partialData);\n        presence.result.user = data;\n        if (!room.isConnected) {\n            return;\n        }\n        this._trySetPresence(roomId, data);\n        this._notifyPresenceSubs(roomId);\n    }\n    _trySetPresence(roomId, data) {\n        this._trySendAuthed(uuid(), {\n            op: 'set-presence',\n            'room-id': roomId,\n            data,\n        });\n    }\n    _tryJoinRoom(roomId, data) {\n        this._trySendAuthed(uuid(), { op: 'join-room', 'room-id': roomId, data });\n        delete this._roomsPendingLeave[roomId];\n    }\n    _tryLeaveRoom(roomId) {\n        this._trySendAuthed(uuid(), { op: 'leave-room', 'room-id': roomId });\n    }\n    // TODO: look into typing again\n    subscribePresence(roomType, roomId, opts, cb) {\n        const leaveRoom = this.joinRoom(roomId, opts.data);\n        const handler = Object.assign(Object.assign({}, opts), { roomId, cb, prev: null });\n        this._presence[roomId] = this._presence[roomId] || {};\n        this._presence[roomId].handlers = this._presence[roomId].handlers || [];\n        this._presence[roomId].handlers.push(handler);\n        this._notifyPresenceSub(roomId, handler);\n        return () => {\n            var _a, _b, _c;\n            this._presence[roomId].handlers =\n                (_c = (_b = (_a = this._presence[roomId]) === null || _a === void 0 ? void 0 : _a.handlers) === null || _b === void 0 ? void 0 : _b.filter((x) => x !== handler)) !== null && _c !== void 0 ? _c : [];\n            leaveRoom();\n        };\n    }\n    _notifyPresenceSubs(roomId) {\n        var _a, _b;\n        (_b = (_a = this._presence[roomId]) === null || _a === void 0 ? void 0 : _a.handlers) === null || _b === void 0 ? void 0 : _b.forEach((handler) => {\n            this._notifyPresenceSub(roomId, handler);\n        });\n    }\n    _notifyPresenceSub(roomId, handler) {\n        const slice = this.getPresence('', roomId, handler);\n        if (!slice) {\n            return;\n        }\n        if (handler.prev && !hasPresenceResponseChanged(slice, handler.prev)) {\n            return;\n        }\n        handler.prev = slice;\n        handler.cb(slice);\n    }\n    _patchPresencePeers(roomId, edits) {\n        var _a, _b, _c;\n        const peers = ((_b = (_a = this._presence[roomId]) === null || _a === void 0 ? void 0 : _a.result) === null || _b === void 0 ? void 0 : _b.peers) || {};\n        let sessions = Object.fromEntries(Object.entries(peers).map(([k, v]) => [k, { data: v }]));\n        const myPresence = (_c = this._presence[roomId]) === null || _c === void 0 ? void 0 : _c.result;\n        const newSessions = create(sessions, (draft) => {\n            for (let [path, op, value] of edits) {\n                switch (op) {\n                    case '+':\n                        insertInMutative(draft, path, value);\n                        break;\n                    case 'r':\n                        assocInMutative(draft, path, value);\n                        break;\n                    case '-':\n                        dissocInMutative(draft, path);\n                        break;\n                }\n            }\n            // Ignore our own edits\n            delete draft[this._sessionId];\n        });\n        this._setPresencePeers(roomId, newSessions);\n    }\n    _setPresencePeers(roomId, data) {\n        const sessions = Object.assign({}, data);\n        // no need to keep track of `user`\n        delete sessions[this._sessionId];\n        const peers = Object.fromEntries(Object.entries(sessions).map(([k, v]) => [k, v.data]));\n        this._presence = create(this._presence, (draft) => {\n            assocInMutative(draft, [roomId, 'result', 'peers'], peers);\n        });\n    }\n    // --------\n    // Broadcast\n    publishTopic({ roomType, roomId, topic, data }) {\n        var _a;\n        const room = this._rooms[roomId];\n        if (!room) {\n            return;\n        }\n        if (!room.isConnected) {\n            this._broadcastQueue[roomId] = (_a = this._broadcastQueue[roomId]) !== null && _a !== void 0 ? _a : [];\n            this._broadcastQueue[roomId].push({ topic, roomType, data });\n            return;\n        }\n        this._tryBroadcast(roomId, roomType, topic, data);\n    }\n    _tryBroadcast(roomId, roomType, topic, data) {\n        this._trySendAuthed(uuid(), {\n            op: 'client-broadcast',\n            'room-id': roomId,\n            roomType,\n            topic,\n            data,\n        });\n    }\n    subscribeTopic(roomId, topic, cb) {\n        const leaveRoom = this.joinRoom(roomId);\n        this._broadcastSubs[roomId] = this._broadcastSubs[roomId] || {};\n        this._broadcastSubs[roomId][topic] =\n            this._broadcastSubs[roomId][topic] || [];\n        this._broadcastSubs[roomId][topic].push(cb);\n        this._presence[roomId] = this._presence[roomId] || {};\n        return () => {\n            this._broadcastSubs[roomId][topic] = this._broadcastSubs[roomId][topic].filter((x) => x !== cb);\n            if (!this._broadcastSubs[roomId][topic].length) {\n                delete this._broadcastSubs[roomId][topic];\n            }\n            leaveRoom();\n        };\n    }\n    _notifyBroadcastSubs(room, topic, msg) {\n        var _a, _b, _c;\n        (_c = (_b = (_a = this._broadcastSubs) === null || _a === void 0 ? void 0 : _a[room]) === null || _b === void 0 ? void 0 : _b[topic]) === null || _c === void 0 ? void 0 : _c.forEach((cb) => {\n            var _a, _b, _c, _d, _e, _f;\n            const data = (_a = msg.data) === null || _a === void 0 ? void 0 : _a.data;\n            const peer = msg.data['peer-id'] === this._sessionId\n                ? (_c = (_b = this._presence[room]) === null || _b === void 0 ? void 0 : _b.result) === null || _c === void 0 ? void 0 : _c.user\n                : (_f = (_e = (_d = this._presence[room]) === null || _d === void 0 ? void 0 : _d.result) === null || _e === void 0 ? void 0 : _e.peers) === null || _f === void 0 ? void 0 : _f[msg.data['peer-id']];\n            return cb(data, peer);\n        });\n    }\n    // --------\n    // Storage\n    uploadFile(path, file, opts) {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            const currentUser = yield this.getCurrentUser();\n            const refreshToken = (_a = currentUser === null || currentUser === void 0 ? void 0 : currentUser.user) === null || _a === void 0 ? void 0 : _a.refresh_token;\n            return StorageApi.uploadFile(Object.assign(Object.assign({}, opts), { apiURI: this.config.apiURI, appId: this.config.appId, path: path, file, refreshToken: refreshToken }));\n        });\n    }\n    deleteFile(path) {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            const currentUser = yield this.getCurrentUser();\n            const refreshToken = (_a = currentUser === null || currentUser === void 0 ? void 0 : currentUser.user) === null || _a === void 0 ? void 0 : _a.refresh_token;\n            const result = yield StorageApi.deleteFile({\n                apiURI: this.config.apiURI,\n                appId: this.config.appId,\n                path,\n                refreshToken: refreshToken,\n            });\n            return result;\n        });\n    }\n    // Deprecated Storage API (Jan 2025)\n    // ---------------------------------\n    upload(path, file) {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            const currentUser = yield this.getCurrentUser();\n            const refreshToken = (_a = currentUser === null || currentUser === void 0 ? void 0 : currentUser.user) === null || _a === void 0 ? void 0 : _a.refresh_token;\n            const fileName = path || file.name;\n            const url = yield StorageApi.getSignedUploadUrl({\n                apiURI: this.config.apiURI,\n                appId: this.config.appId,\n                fileName: fileName,\n                refreshToken: refreshToken,\n            });\n            const isSuccess = yield StorageApi.upload(url, file);\n            return isSuccess;\n        });\n    }\n    getDownloadUrl(path) {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            const currentUser = yield this.getCurrentUser();\n            const refreshToken = (_a = currentUser === null || currentUser === void 0 ? void 0 : currentUser.user) === null || _a === void 0 ? void 0 : _a.refresh_token;\n            const url = yield StorageApi.getDownloadUrl({\n                apiURI: this.config.apiURI,\n                appId: this.config.appId,\n                path: path,\n                refreshToken: refreshToken,\n            });\n            return url;\n        });\n    }\n}\n//# sourceMappingURL=Reactor.js.map","export class DataAttrDef {\n    constructor(valueType, required, config = { indexed: false, unique: false }) {\n        this.valueType = valueType;\n        this.required = required;\n        this.config = config;\n    }\n    /**\n     * @deprecated Only use this temporarily for attributes that you want\n     * to treat as required in frontend code but canâ€™t yet mark as required\n     * and enforced for backend\n     */\n    clientRequired() {\n        return new DataAttrDef(this.valueType, false, this.config);\n    }\n    optional() {\n        return new DataAttrDef(this.valueType, false, this.config);\n    }\n    unique() {\n        return new DataAttrDef(this.valueType, this.required, Object.assign(Object.assign({}, this.config), { unique: true }));\n    }\n    indexed() {\n        return new DataAttrDef(this.valueType, this.required, Object.assign(Object.assign({}, this.config), { indexed: true }));\n    }\n}\nexport class LinkAttrDef {\n    constructor(cardinality, entityName) {\n        this.cardinality = cardinality;\n        this.entityName = entityName;\n    }\n}\nexport class EntityDef {\n    constructor(attrs, links) {\n        this.attrs = attrs;\n        this.links = links;\n    }\n    asType() {\n        return new EntityDef(this.attrs, this.links);\n    }\n}\nexport class InstantSchemaDef {\n    constructor(entities, links, rooms) {\n        this.entities = entities;\n        this.links = links;\n        this.rooms = rooms;\n    }\n    /**\n     * @deprecated\n     * `withRoomSchema` is deprecated. Define your schema in `rooms` directly:\n     *\n     * @example\n     * // Before:\n     * const schema = i.schema({\n     *   // ...\n     * }).withRoomSchema<RoomSchema>()\n     *\n     * // After\n     * const schema = i.schema({\n     *  rooms: {\n     *    // ...\n     *  }\n     * })\n     *\n     * @see https://instantdb.com/docs/presence-and-topics#typesafety\n     */\n    withRoomSchema() {\n        return new InstantSchemaDef(this.entities, this.links, {});\n    }\n}\n/**\n * @deprecated\n * `i.graph` is deprecated. Use `i.schema` instead.\n *\n * @see https://instantdb.com/docs/modeling-data\n */\nexport class InstantGraph {\n    constructor(entities, links) {\n        this.entities = entities;\n        this.links = links;\n    }\n    withRoomSchema() {\n        return new InstantGraph(this.entities, this.links);\n    }\n}\n//# sourceMappingURL=schemaTypes.js.map","import { EntityDef, DataAttrDef, InstantSchemaDef, } from \"./schemaTypes.js\";\n// ==========\n// API\n/**\n * @deprecated\n * `i.graph` is deprecated. Use `i.schema` instead.\n *\n * @example\n * // Before\n * i.graph(entities, links).withRoomSchema<RoomType>();\n *\n * // After\n * i.schema({ entities, links, rooms })\n *\n * @see\n * https://instantdb.com/docs/schema\n */\nfunction graph(entities, links) {\n    return new InstantSchemaDef(enrichEntitiesWithLinks(entities, links), \n    // (XXX): LinksDef<any> stems from TypeScriptâ€™s inability to reconcile the\n    // type EntitiesWithLinks<EntitiesWithoutLinks, Links> with\n    // EntitiesWithoutLinks. TypeScript is strict about ensuring that types are\n    // correctly aligned and does not allow for substituting a type that might\n    // be broader or have additional properties.\n    links, undefined);\n}\n/**\n * Creates an entity definition, to be used in conjunction with `i.graph`.\n *\n * @see https://instantdb.com/docs/schema\n * @example\n *   {\n *     posts: i.entity({\n *       title: i.string(),\n *       body: i.string(),\n *     }),\n *     comments: i.entity({\n *       body: i.string(),\n *     })\n *   }\n */\nfunction entity(attrs) {\n    return new EntityDef(attrs, {});\n}\nfunction string() {\n    return new DataAttrDef('string', true);\n}\nfunction number() {\n    return new DataAttrDef('number', true);\n}\nfunction boolean() {\n    return new DataAttrDef('boolean', true);\n}\nfunction date() {\n    return new DataAttrDef('date', true);\n}\nfunction json() {\n    return new DataAttrDef('json', true);\n}\nfunction any() {\n    return new DataAttrDef('json', true);\n}\n// ==========\n// internal\nfunction enrichEntitiesWithLinks(entities, links) {\n    var _a, _b, _c, _d;\n    const linksIndex = { fwd: {}, rev: {} };\n    for (const linkDef of Object.values(links)) {\n        (_a = linksIndex.fwd)[_b = linkDef.forward.on] || (_a[_b] = {});\n        (_c = linksIndex.rev)[_d = linkDef.reverse.on] || (_c[_d] = {});\n        linksIndex.fwd[linkDef.forward.on][linkDef.forward.label] = {\n            entityName: linkDef.reverse.on,\n            cardinality: linkDef.forward.has,\n        };\n        linksIndex.rev[linkDef.reverse.on][linkDef.reverse.label] = {\n            entityName: linkDef.forward.on,\n            cardinality: linkDef.reverse.has,\n        };\n    }\n    const enrichedEntities = Object.fromEntries(Object.entries(entities).map(([name, def]) => [\n        name,\n        new EntityDef(def.attrs, Object.assign(Object.assign({}, linksIndex.fwd[name]), linksIndex.rev[name])),\n    ]));\n    return enrichedEntities;\n}\n/**\n * Lets you define a schema for your database.\n *\n * You can define entities, links between entities, and if you use\n * presence, you can define rooms.\n *\n * You can push this schema to your database with the CLI,\n * or use it inside `init`, to get typesafety and autocompletion.\n *\n * @see https://instantdb.com/docs/schema\n * @example\n *   i.schema({\n *     entities: { },\n *     links: { },\n *     rooms: { }\n *   });\n */\nfunction schema({ entities, links, rooms, }) {\n    const linksDef = links !== null && links !== void 0 ? links : {};\n    const roomsDef = rooms !== null && rooms !== void 0 ? rooms : {};\n    return new InstantSchemaDef(enrichEntitiesWithLinks(entities, linksDef), \n    // (XXX): LinksDef<any> stems from TypeScriptâ€™s inability to reconcile the\n    // type EntitiesWithLinks<EntitiesWithoutLinks, Links> with\n    // EntitiesWithoutLinks. TypeScript is strict about ensuring that types are\n    // correctly aligned and does not allow for substituting a type that might\n    // be broader or have additional properties.\n    linksDef, roomsDef);\n}\nexport const i = {\n    // constructs\n    graph,\n    schema,\n    entity,\n    // value types\n    string,\n    number,\n    boolean,\n    date,\n    json,\n    any,\n};\n//# sourceMappingURL=schema.js.map","import * as flags from \"./utils/flags.js\";\nlet currentDevtool;\nexport function createDevtool(appId, config) {\n    currentDevtool === null || currentDevtool === void 0 ? void 0 : currentDevtool.dispose();\n    const iframeContrainer = createIframeContainer(config);\n    const toggler = createToggler(config, toggleView);\n    const iframe = createIframe(getSrc(appId));\n    function onPostMessage(event) {\n        var _a;\n        if (event.source !== iframe.element.contentWindow)\n            return;\n        if (((_a = event.data) === null || _a === void 0 ? void 0 : _a.type) === 'close' && iframeContrainer.isVisible()) {\n            toggleView();\n        }\n    }\n    function onKeyDown(event) {\n        const isToggleShortcut = event.shiftKey && event.ctrlKey && event.key === '0';\n        const isEsc = event.key === 'Escape' || event.key === 'Esc';\n        if (isToggleShortcut) {\n            toggleView();\n        }\n        else if (isEsc && iframeContrainer.isVisible()) {\n            toggleView();\n        }\n    }\n    function toggleView() {\n        if (iframeContrainer.isVisible()) {\n            iframeContrainer.element.style.display = 'none';\n        }\n        else {\n            iframeContrainer.element.style.display = 'block';\n            // lazily render iframe on first open\n            if (!iframeContrainer.element.contains(iframe.element)) {\n                iframeContrainer.element.appendChild(iframe.element);\n            }\n        }\n    }\n    function dispose() {\n        iframeContrainer.element.remove();\n        toggler.element.remove();\n        removeEventListener('keydown', onKeyDown);\n        removeEventListener('message', onPostMessage);\n    }\n    function create() {\n        document.body.appendChild(iframeContrainer.element);\n        document.body.appendChild(toggler.element);\n        addEventListener('keydown', onKeyDown);\n        addEventListener('message', onPostMessage);\n        currentDevtool = {\n            dispose,\n        };\n    }\n    return create();\n}\nfunction getSrc(appId) {\n    const useLocalDashboard = flags.devBackend || flags.devtoolLocalDashboard;\n    const src = `${useLocalDashboard ? 'http://localhost:3000' : 'https://instantdb.com'}/_devtool?appId=${appId}`;\n    return src;\n}\nfunction createIframe(src) {\n    const element = document.createElement('iframe');\n    element.src = src;\n    element.className = 'instant-devtool-iframe';\n    Object.assign(element.style, {\n        width: '100%',\n        height: '100%',\n        backgroundColor: 'white',\n        border: 'none',\n    });\n    return { element };\n}\nfunction createToggler(config, onClick) {\n    const logoSVG = `\n    <svg width=\"32\" height=\"32\" viewBox=\"0 0 512 512\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n      <rect width=\"512\" height=\"512\" fill=\"black\"/>\n      <rect x=\"97.0973\" y=\"91.3297\" width=\"140\" height=\"330\" fill=\"white\"/>\n    </svg>\n  `;\n    const element = document.createElement('button');\n    element.innerHTML = logoSVG;\n    element.className = 'instant-devtool-toggler';\n    Object.assign(element.style, Object.assign(Object.assign({ \n        // pos\n        position: 'fixed' }, cssPositionForToggler(config.position)), { height: '32px', width: '32px', \n        // layout\n        display: 'flex', alignItems: 'center', justifyContent: 'center', zIndex: '9010', \n        // look\n        padding: '0', margin: '0', border: 'none', cursor: 'pointer' }));\n    element.addEventListener('click', onClick);\n    return { element };\n}\nfunction cssPositionForToggler(position) {\n    switch (position) {\n        case 'bottom-left':\n            return { bottom: '24px', left: '24px' };\n        case 'bottom-right':\n            return { bottom: '24px', right: '24px' };\n        case 'top-right':\n            return { top: '24px', right: '24px' };\n        case 'top-left':\n            return { top: '24px', left: '24px' };\n    }\n}\nfunction cssPositionForIframeContainer(position) {\n    switch (position) {\n        case 'bottom-left':\n            return { bottom: '24px', right: '24px', left: '60px', top: '72px' };\n        case 'bottom-right':\n            return { bottom: '24px', left: '24px', right: '60px', top: '72px' };\n        case 'top-right':\n            return { top: '24px', left: '24px', right: '60px', bottom: '72px' };\n        case 'top-left':\n            return { top: '24px', right: '24px', left: '60px', bottom: '72px' };\n    }\n}\nfunction createIframeContainer(config) {\n    const element = document.createElement('div');\n    Object.assign(element.style, Object.assign(Object.assign({ position: 'fixed' }, cssPositionForIframeContainer(config.position)), { display: 'block', borderRadius: '4px', border: '1px #ccc solid', boxShadow: '0px 0px 8px #00000044', backgroundColor: '#eee', zIndex: '999990' }));\n    element.style.display = 'none';\n    element.className = 'instant-devtool-container';\n    function isVisible() {\n        return element.style.display !== 'none';\n    }\n    return { element, isVisible };\n}\n//# sourceMappingURL=devtool.js.map","import Reactor from './Reactor.js';\nimport { tx, txInit, lookup, getOps, } from './instatx.js';\nimport weakHash from './utils/weakHash.js';\nimport id from './utils/uuid.js';\nimport IndexedDBStorage from './IndexedDBStorage.js';\nimport WindowNetworkListener from './WindowNetworkListener.js';\nimport { i } from './schema.js';\nimport { createDevtool } from './devtool.js';\nimport version from './version.js';\nimport { InstantAPIError } from './utils/fetch.js';\nconst defaultOpenDevtool = true;\n// consts\nconst defaultConfig = {\n    apiURI: 'https://api.instantdb.com',\n    websocketURI: 'wss://api.instantdb.com/runtime/session',\n};\n// hmr\nfunction initSchemaHashStore() {\n    var _a;\n    globalThis.__instantDbSchemaHashStore =\n        (_a = globalThis.__instantDbSchemaHashStore) !== null && _a !== void 0 ? _a : new WeakMap();\n    return globalThis.__instantDbSchemaHashStore;\n}\nfunction initGlobalInstantCoreStore() {\n    var _a;\n    globalThis.__instantDbStore = (_a = globalThis.__instantDbStore) !== null && _a !== void 0 ? _a : {};\n    return globalThis.__instantDbStore;\n}\nfunction reactorKey(config) {\n    // @ts-expect-error\n    const adminToken = config.__adminToken;\n    return (config.appId +\n        '_' +\n        (config.websocketURI || 'default_ws_uri') +\n        '_' +\n        (config.apiURI || 'default_api_uri') +\n        '_' +\n        (adminToken || 'client_only'));\n}\nconst globalInstantCoreStore = initGlobalInstantCoreStore();\nconst schemaHashStore = initSchemaHashStore();\n/**\n * Functions to log users in and out.\n *\n * @see https://instantdb.com/docs/auth\n */\nclass Auth {\n    constructor(db) {\n        this.db = db;\n        /**\n         * Sends a magic code to the user's email address.\n         *\n         * Once you send the magic code, see {@link auth.signInWithMagicCode} to let the\n         * user verify.\n         *\n         * @see https://instantdb.com/docs/auth\n         * @example\n         *  db.auth.sendMagicCode({email: \"example@gmail.com\"})\n         *    .catch((err) => console.error(err.body?.message))\n         */\n        this.sendMagicCode = (params) => {\n            return this.db.sendMagicCode(params);\n        };\n        /**\n         * Verify a magic code that was sent to the user's email address.\n         *\n         * @see https://instantdb.com/docs/auth\n         *\n         * @example\n         *  db.auth.signInWithMagicCode({email: \"example@gmail.com\", code: \"123456\"})\n         *       .catch((err) => console.error(err.body?.message))\n         */\n        this.signInWithMagicCode = (params) => {\n            return this.db.signInWithMagicCode(params);\n        };\n        /**\n         * Sign in a user with a refresh token\n         *\n         * @see https://instantdb.com/docs/backend#frontend-auth-sign-in-with-token\n         *\n         * @example\n         *   // Get the token from your backend\n         *   const token = await fetch('/signin', ...);\n         *   //Sign in\n         *   db.auth.signInWithToken(token);\n         */\n        this.signInWithToken = (token) => {\n            return this.db.signInWithCustomToken(token);\n        };\n        /**\n         * Create an authorization url to sign in with an external provider\n         *\n         * @see https://instantdb.com/docs/auth\n         *\n         * @example\n         *   // Get the authorization url from your backend\n         *   const url = db.auth.createAuthorizationUrl({\n         *     clientName: \"google\",\n         *     redirectURL: window.location.href,\n         *   });\n         *\n         *   // Put it in a sign in link\n         *   <a href={url}>Log in with Google</a>\n         */\n        this.createAuthorizationURL = (params) => {\n            return this.db.createAuthorizationURL(params);\n        };\n        /**\n         * Sign in with the id_token from an external provider like Google\n         *\n         * @see https://instantdb.com/docs/auth\n         * @example\n         *   db.auth\n         *  .signInWithIdToken({\n         *    // Token from external service\n         *    idToken: id_token,\n         *    // The name you gave the client when you registered it with Instant\n         *    clientName: \"google\",\n         *    // The nonce, if any, that you used when you initiated the auth flow\n         *    // with the external service.\n         *    nonce: your_nonce\n         *  })\n         *  .catch((err) => console.error(err.body?.message));\n         *\n         */\n        this.signInWithIdToken = (params) => {\n            return this.db.signInWithIdToken(params);\n        };\n        /**\n         * Sign in with the id_token from an external provider like Google\n         *\n         * @see https://instantdb.com/docs/auth\n         * @example\n         *   db.auth\n         *  .exchangeOAuthCode({\n         *    // code received in redirect from OAuth callback\n         *    code: code\n         *    // The PKCE code_verifier, if any, that you used when you\n         *    // initiated the auth flow\n         *    codeVerifier: your_code_verifier\n         *  })\n         *  .catch((err) => console.error(err.body?.message));\n         *\n         */\n        this.exchangeOAuthCode = (params) => {\n            return this.db.exchangeCodeForToken(params);\n        };\n        /**\n         * OpenID Discovery path for use with tools like\n         * expo-auth-session that use auto-discovery of\n         * OAuth parameters.\n         *\n         * @see https://instantdb.com/docs/auth\n         * @example\n         *   const discovery = useAutoDiscovery(\n         *     db.auth.issuerURI()\n         *   );\n         */\n        this.issuerURI = () => {\n            return this.db.issuerURI();\n        };\n        /**\n         * Sign out the current user\n         */\n        this.signOut = (opts = { invalidateToken: true }) => {\n            return this.db.signOut(opts);\n        };\n    }\n}\n/**\n * Functions to manage file storage.\n */\nclass Storage {\n    constructor(db) {\n        this.db = db;\n        /**\n         * Uploads file at the provided path.\n         *\n         * @see https://instantdb.com/docs/storage\n         * @example\n         *   const [file] = e.target.files; // result of file input\n         *   const data = await db.storage.uploadFile('photos/demo.png', file);\n         */\n        this.uploadFile = (path, file, opts = {}) => {\n            return this.db.uploadFile(path, file, opts);\n        };\n        /**\n         * Deletes a file by path name.\n         *\n         * @see https://instantdb.com/docs/storage\n         * @example\n         *   await db.storage.delete('photos/demo.png');\n         */\n        this.delete = (pathname) => {\n            return this.db.deleteFile(pathname);\n        };\n        // Deprecated Storage API (Jan 2025)\n        // ---------------------------------\n        /**\n         * @deprecated. Use `db.storage.uploadFile` instead\n         * remove in the future.\n         */\n        this.upload = (pathname, file) => {\n            return this.db.upload(pathname, file);\n        };\n        /**\n         * @deprecated Use `db.storage.uploadFile` instead\n         */\n        this.put = this.upload;\n        /**\n         * @deprecated. getDownloadUrl will be removed in the future.\n         * Use `useQuery` instead to query and fetch for valid urls\n         *\n         * db.useQuery({\n         *   $files: {\n         *     $: {\n         *       where: {\n         *         path: \"moop.png\"\n         *       }\n         *     }\n         *   }\n         * })\n         */\n        this.getDownloadUrl = (pathname) => {\n            return this.db.getDownloadUrl(pathname);\n        };\n    }\n}\n// util\nfunction coerceQuery(o) {\n    // stringify and parse to remove undefined values\n    return JSON.parse(JSON.stringify(o));\n}\nclass InstantCoreDatabase {\n    constructor(reactor) {\n        this.tx = txInit();\n        this._reactor = reactor;\n        this.auth = new Auth(this._reactor);\n        this.storage = new Storage(this._reactor);\n    }\n    /**\n     * Use this to write data! You can create, update, delete, and link objects\n     *\n     * @see https://instantdb.com/docs/instaml\n     *\n     * @example\n     *   // Create a new object in the `goals` namespace\n     *   const goalId = id();\n     *   db.transact(db.tx.goals[goalId].update({title: \"Get fit\"}))\n     *\n     *   // Update the title\n     *   db.transact(db.tx.goals[goalId].update({title: \"Get super fit\"}))\n     *\n     *   // Delete it\n     *   db.transact(db.tx.goals[goalId].delete())\n     *\n     *   // Or create an association:\n     *   todoId = id();\n     *   db.transact([\n     *    db.tx.todos[todoId].update({ title: 'Go on a run' }),\n     *    db.tx.goals[goalId].link({todos: todoId}),\n     *  ])\n     */\n    transact(chunks) {\n        return this._reactor.pushTx(chunks);\n    }\n    getLocalId(name) {\n        return this._reactor.getLocalId(name);\n    }\n    /**\n     * Use this to query your data!\n     *\n     * @see https://instantdb.com/docs/instaql\n     *\n     * @example\n     *  // listen to all goals\n     *  db.subscribeQuery({ goals: {} }, (resp) => {\n     *    console.log(resp.data.goals)\n     *  })\n     *\n     *  // goals where the title is \"Get Fit\"\n     *  db.subscribeQuery(\n     *    { goals: { $: { where: { title: \"Get Fit\" } } } },\n     *    (resp) => {\n     *      console.log(resp.data.goals)\n     *    }\n     *  )\n     *\n     *  // all goals, _alongside_ their todos\n     *  db.subscribeQuery({ goals: { todos: {} } }, (resp) => {\n     *    console.log(resp.data.goals)\n     *  });\n     */\n    subscribeQuery(query, cb, opts) {\n        return this._reactor.subscribeQuery(query, cb, opts);\n    }\n    /**\n     * Listen for the logged in state. This is useful\n     * for deciding when to show a login screen.\n     *\n     * @see https://instantdb.com/docs/auth\n     * @example\n     *   const unsub = db.subscribeAuth((auth) => {\n     *     if (auth.user) {\n     *     console.log('logged in as', auth.user.email)\n     *    } else {\n     *      console.log('logged out')\n     *    }\n     *  })\n     */\n    subscribeAuth(cb) {\n        return this._reactor.subscribeAuth(cb);\n    }\n    /**\n     * One time query for the logged in state. This is useful\n     * for scenarios where you want to know the current auth\n     * state without subscribing to changes.\n     *\n     * @see https://instantdb.com/docs/auth\n     * @example\n     *   const user = await db.getAuth();\n     *   console.log('logged in as', user.email)\n     */\n    getAuth() {\n        return this._reactor.getAuth();\n    }\n    /**\n     * Listen for connection status changes to Instant. This is useful\n     * for building things like connectivity indicators\n     *\n     * @see https://www.instantdb.com/docs/patterns#connection-status\n     * @example\n     *   const unsub = db.subscribeConnectionStatus((status) => {\n     *     const connectionState =\n     *       status === 'connecting' || status === 'opened'\n     *         ? 'authenticating'\n     *       : status === 'authenticated'\n     *         ? 'connected'\n     *       : status === 'closed'\n     *         ? 'closed'\n     *       : status === 'errored'\n     *         ? 'errored'\n     *       : 'unexpected state';\n     *\n     *     console.log('Connection status:', connectionState);\n     *   });\n     */\n    subscribeConnectionStatus(cb) {\n        return this._reactor.subscribeConnectionStatus(cb);\n    }\n    /**\n     * Join a room to publish and subscribe to topics and presence.\n     *\n     * @see https://instantdb.com/docs/presence-and-topics\n     * @example\n     * // init\n     * const db = init();\n     * const room = db.joinRoom(roomType, roomId);\n     * // usage\n     * const unsubscribeTopic = room.subscribeTopic(\"foo\", console.log);\n     * const unsubscribePresence = room.subscribePresence({}, console.log);\n     * room.publishTopic(\"hello\", { message: \"hello world!\" });\n     * room.publishPresence({ name: \"joe\" });\n     * // later\n     * unsubscribePresence();\n     * unsubscribeTopic();\n     * room.leaveRoom();\n     */\n    joinRoom(roomType = '_defaultRoomType', roomId = '_defaultRoomId', opts) {\n        const leaveRoom = this._reactor.joinRoom(roomId, opts === null || opts === void 0 ? void 0 : opts.initialPresence);\n        return {\n            leaveRoom,\n            subscribeTopic: (topic, onEvent) => this._reactor.subscribeTopic(roomId, topic, onEvent),\n            subscribePresence: (opts, onChange) => this._reactor.subscribePresence(roomType, roomId, opts, onChange),\n            publishTopic: (topic, data) => this._reactor.publishTopic({ roomType, roomId, topic, data }),\n            publishPresence: (data) => this._reactor.publishPresence(roomType, roomId, data),\n            getPresence: (opts) => this._reactor.getPresence(roomType, roomId, opts),\n        };\n    }\n    shutdown() {\n        delete globalInstantCoreStore[reactorKey(this._reactor.config)];\n        this._reactor.shutdown();\n    }\n    /**\n     * Use this for one-off queries.\n     * Returns local data if available, otherwise fetches from the server.\n     * Because we want to avoid stale data, this method will throw an error\n     * if the user is offline or there is no active connection to the server.\n     *\n     * @see https://instantdb.com/docs/instaql\n     *\n     * @example\n     *\n     *  const resp = await db.queryOnce({ goals: {} });\n     *  console.log(resp.data.goals)\n     */\n    queryOnce(query, opts) {\n        return this._reactor.queryOnce(query, opts);\n    }\n}\nfunction schemaHash(schema) {\n    if (!schema) {\n        return '0';\n    }\n    if (schemaHashStore.get(schema)) {\n        console.log('getting cached schema');\n        return schemaHashStore.get(schema);\n    }\n    console.log('calculating schema hash');\n    const hash = weakHash(schema);\n    schemaHashStore.set(schema, hash);\n    return hash;\n}\nfunction schemaChanged(existingClient, newSchema) {\n    return (schemaHash(existingClient._reactor.config.schema) !== schemaHash(newSchema));\n}\n/**\n *\n * The first step: init your application!\n *\n * Visit https://instantdb.com/dash to get your `appId` :)\n *\n * @example\n *  import { init } from \"@instantdb/core\"\n *\n *  const db = init({ appId: \"my-app-id\" })\n *\n *  // You can also provide a schema for type safety and editor autocomplete!\n *\n *  import { init } from \"@instantdb/core\"\n *  import schema from \"\"../instant.schema.ts\";\n *\n *  const db = init({ appId: \"my-app-id\", schema })\n *\n *  // To learn more: https://instantdb.com/docs/modeling-data\n */\nfunction init(config, Storage, NetworkListener, versions) {\n    const existingClient = globalInstantCoreStore[reactorKey(config)];\n    if (existingClient) {\n        if (schemaChanged(existingClient, config.schema)) {\n            existingClient._reactor.updateSchema(config.schema);\n        }\n        return existingClient;\n    }\n    const reactor = new Reactor(Object.assign(Object.assign(Object.assign({}, defaultConfig), config), { cardinalityInference: config.schema ? true : false }), Storage || IndexedDBStorage, NetworkListener || WindowNetworkListener, Object.assign(Object.assign({}, (versions || {})), { '@instantdb/core': version }));\n    const client = new InstantCoreDatabase(reactor);\n    globalInstantCoreStore[reactorKey(config)] = client;\n    handleDevtool(config.appId, config.devtool);\n    return client;\n}\nfunction handleDevtool(appId, devtool) {\n    if (typeof window === 'undefined' ||\n        typeof window.location === 'undefined' ||\n        typeof document === 'undefined') {\n        return;\n    }\n    if (typeof devtool === 'boolean' && !devtool) {\n        return;\n    }\n    const config = Object.assign({ position: 'bottom-right', allowedHosts: ['localhost'] }, (typeof devtool === 'object' ? devtool : {}));\n    if (!config.allowedHosts.includes(window.location.hostname)) {\n        return;\n    }\n    createDevtool(appId, config);\n}\n/**\n * @deprecated\n * `init_experimental` is deprecated. You can replace it with `init`.\n *\n * @example\n *\n * // Before\n * import { init_experimental } from \"@instantdb/core\"\n * const db = init_experimental({  ...  });\n *\n * // After\n * import { init } from \"@instantdb/core\"\n * const db = init({ ...  });\n */\nconst init_experimental = init;\nexport { \n// bada bing bada boom\ninit, init_experimental, id, tx, txInit, lookup, \n// error\nInstantAPIError, \n// cli\ni, \n// util\ngetOps, coerceQuery, weakHash, IndexedDBStorage, WindowNetworkListener, InstantCoreDatabase, Auth, Storage, version, };\n//# sourceMappingURL=index.js.map","import{Component as n,createElement as t,options as e,toChildArray as r,Fragment as u,render as o,hydrate as i,createContext as l,createRef as c,cloneElement as f}from\"preact\";export{Component,Fragment,createContext,createElement,createRef}from\"preact\";import{useState as a,useLayoutEffect as s,useEffect as h,useCallback as v,useContext as d,useDebugValue as m,useId as p,useImperativeHandle as y,useMemo as _,useReducer as b,useRef as S}from\"preact/hooks\";export*from\"preact/hooks\";function g(n,t){for(var e in t)n[e]=t[e];return n}function E(n,t){for(var e in n)if(\"__source\"!==e&&!(e in t))return!0;for(var r in t)if(\"__source\"!==r&&n[r]!==t[r])return!0;return!1}function C(n,t){var e=t(),r=a({t:{__:e,u:t}}),u=r[0].t,o=r[1];return s(function(){u.__=e,u.u=t,x(u)&&o({t:u})},[n,e,t]),h(function(){return x(u)&&o({t:u}),n(function(){x(u)&&o({t:u})})},[n]),e}function x(n){var t,e,r=n.u,u=n.__;try{var o=r();return!((t=u)===(e=o)&&(0!==t||1/t==1/e)||t!=t&&e!=e)}catch(n){return!0}}function R(n){n()}function w(n){return n}function k(){return[!1,R]}var I=s;function N(n,t){this.props=n,this.context=t}function M(n,e){function r(n){var t=this.props.ref,r=t==n.ref;return!r&&t&&(t.call?t(null):t.current=null),e?!e(this.props,n)||!r:E(this.props,n)}function u(e){return this.shouldComponentUpdate=r,t(n,e)}return u.displayName=\"Memo(\"+(n.displayName||n.name)+\")\",u.prototype.isReactComponent=!0,u.__f=!0,u}(N.prototype=new n).isPureReactComponent=!0,N.prototype.shouldComponentUpdate=function(n,t){return E(this.props,n)||E(this.state,t)};var T=e.__b;e.__b=function(n){n.type&&n.type.__f&&n.ref&&(n.props.ref=n.ref,n.ref=null),T&&T(n)};var A=\"undefined\"!=typeof Symbol&&Symbol.for&&Symbol.for(\"react.forward_ref\")||3911;function D(n){function t(t){var e=g({},t);return delete e.ref,n(e,t.ref||null)}return t.$$typeof=A,t.render=t,t.prototype.isReactComponent=t.__f=!0,t.displayName=\"ForwardRef(\"+(n.displayName||n.name)+\")\",t}var L=function(n,t){return null==n?null:r(r(n).map(t))},O={map:L,forEach:L,count:function(n){return n?r(n).length:0},only:function(n){var t=r(n);if(1!==t.length)throw\"Children.only\";return t[0]},toArray:r},F=e.__e;e.__e=function(n,t,e,r){if(n.then)for(var u,o=t;o=o.__;)if((u=o.__c)&&u.__c)return null==t.__e&&(t.__e=e.__e,t.__k=e.__k),u.__c(n,t);F(n,t,e,r)};var U=e.unmount;function V(n,t,e){return n&&(n.__c&&n.__c.__H&&(n.__c.__H.__.forEach(function(n){\"function\"==typeof n.__c&&n.__c()}),n.__c.__H=null),null!=(n=g({},n)).__c&&(n.__c.__P===e&&(n.__c.__P=t),n.__c.__e=!0,n.__c=null),n.__k=n.__k&&n.__k.map(function(n){return V(n,t,e)})),n}function W(n,t,e){return n&&e&&(n.__v=null,n.__k=n.__k&&n.__k.map(function(n){return W(n,t,e)}),n.__c&&n.__c.__P===t&&(n.__e&&e.appendChild(n.__e),n.__c.__e=!0,n.__c.__P=e)),n}function P(){this.__u=0,this.o=null,this.__b=null}function j(n){var t=n.__.__c;return t&&t.__a&&t.__a(n)}function z(n){var e,r,u;function o(o){if(e||(e=n()).then(function(n){r=n.default||n},function(n){u=n}),u)throw u;if(!r)throw e;return t(r,o)}return o.displayName=\"Lazy\",o.__f=!0,o}function B(){this.i=null,this.l=null}e.unmount=function(n){var t=n.__c;t&&t.__R&&t.__R(),t&&32&n.__u&&(n.type=null),U&&U(n)},(P.prototype=new n).__c=function(n,t){var e=t.__c,r=this;null==r.o&&(r.o=[]),r.o.push(e);var u=j(r.__v),o=!1,i=function(){o||(o=!0,e.__R=null,u?u(l):l())};e.__R=i;var l=function(){if(!--r.__u){if(r.state.__a){var n=r.state.__a;r.__v.__k[0]=W(n,n.__c.__P,n.__c.__O)}var t;for(r.setState({__a:r.__b=null});t=r.o.pop();)t.forceUpdate()}};r.__u++||32&t.__u||r.setState({__a:r.__b=r.__v.__k[0]}),n.then(i,i)},P.prototype.componentWillUnmount=function(){this.o=[]},P.prototype.render=function(n,e){if(this.__b){if(this.__v.__k){var r=document.createElement(\"div\"),o=this.__v.__k[0].__c;this.__v.__k[0]=V(this.__b,r,o.__O=o.__P)}this.__b=null}var i=e.__a&&t(u,null,n.fallback);return i&&(i.__u&=-33),[t(u,null,e.__a?null:n.children),i]};var H=function(n,t,e){if(++e[1]===e[0]&&n.l.delete(t),n.props.revealOrder&&(\"t\"!==n.props.revealOrder[0]||!n.l.size))for(e=n.i;e;){for(;e.length>3;)e.pop()();if(e[1]<e[0])break;n.i=e=e[2]}};function Z(n){return this.getChildContext=function(){return n.context},n.children}function Y(n){var e=this,r=n.h;if(e.componentWillUnmount=function(){o(null,e.v),e.v=null,e.h=null},e.h&&e.h!==r&&e.componentWillUnmount(),!e.v){for(var u=e.__v;null!==u&&!u.__m&&null!==u.__;)u=u.__;e.h=r,e.v={nodeType:1,parentNode:r,childNodes:[],__k:{__m:u.__m},contains:function(){return!0},insertBefore:function(n,t){this.childNodes.push(n),e.h.insertBefore(n,t)},removeChild:function(n){this.childNodes.splice(this.childNodes.indexOf(n)>>>1,1),e.h.removeChild(n)}}}o(t(Z,{context:e.context},n.__v),e.v)}function $(n,e){var r=t(Y,{__v:n,h:e});return r.containerInfo=e,r}(B.prototype=new n).__a=function(n){var t=this,e=j(t.__v),r=t.l.get(n);return r[0]++,function(u){var o=function(){t.props.revealOrder?(r.push(u),H(t,n,r)):u()};e?e(o):o()}},B.prototype.render=function(n){this.i=null,this.l=new Map;var t=r(n.children);n.revealOrder&&\"b\"===n.revealOrder[0]&&t.reverse();for(var e=t.length;e--;)this.l.set(t[e],this.i=[1,0,this.i]);return n.children},B.prototype.componentDidUpdate=B.prototype.componentDidMount=function(){var n=this;this.l.forEach(function(t,e){H(n,e,t)})};var q=\"undefined\"!=typeof Symbol&&Symbol.for&&Symbol.for(\"react.element\")||60103,G=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,J=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,K=/[A-Z0-9]/g,Q=\"undefined\"!=typeof document,X=function(n){return(\"undefined\"!=typeof Symbol&&\"symbol\"==typeof Symbol()?/fil|che|rad/:/fil|che|ra/).test(n)};function nn(n,t,e){return null==t.__k&&(t.textContent=\"\"),o(n,t),\"function\"==typeof e&&e(),n?n.__c:null}function tn(n,t,e){return i(n,t),\"function\"==typeof e&&e(),n?n.__c:null}n.prototype.isReactComponent={},[\"componentWillMount\",\"componentWillReceiveProps\",\"componentWillUpdate\"].forEach(function(t){Object.defineProperty(n.prototype,t,{configurable:!0,get:function(){return this[\"UNSAFE_\"+t]},set:function(n){Object.defineProperty(this,t,{configurable:!0,writable:!0,value:n})}})});var en=e.event;function rn(){}function un(){return this.cancelBubble}function on(){return this.defaultPrevented}e.event=function(n){return en&&(n=en(n)),n.persist=rn,n.isPropagationStopped=un,n.isDefaultPrevented=on,n.nativeEvent=n};var ln,cn={enumerable:!1,configurable:!0,get:function(){return this.class}},fn=e.vnode;e.vnode=function(n){\"string\"==typeof n.type&&function(n){var t=n.props,e=n.type,u={},o=-1===e.indexOf(\"-\");for(var i in t){var l=t[i];if(!(\"value\"===i&&\"defaultValue\"in t&&null==l||Q&&\"children\"===i&&\"noscript\"===e||\"class\"===i||\"className\"===i)){var c=i.toLowerCase();\"defaultValue\"===i&&\"value\"in t&&null==t.value?i=\"value\":\"download\"===i&&!0===l?l=\"\":\"translate\"===c&&\"no\"===l?l=!1:\"o\"===c[0]&&\"n\"===c[1]?\"ondoubleclick\"===c?i=\"ondblclick\":\"onchange\"!==c||\"input\"!==e&&\"textarea\"!==e||X(t.type)?\"onfocus\"===c?i=\"onfocusin\":\"onblur\"===c?i=\"onfocusout\":J.test(i)&&(i=c):c=i=\"oninput\":o&&G.test(i)?i=i.replace(K,\"-$&\").toLowerCase():null===l&&(l=void 0),\"oninput\"===c&&u[i=c]&&(i=\"oninputCapture\"),u[i]=l}}\"select\"==e&&u.multiple&&Array.isArray(u.value)&&(u.value=r(t.children).forEach(function(n){n.props.selected=-1!=u.value.indexOf(n.props.value)})),\"select\"==e&&null!=u.defaultValue&&(u.value=r(t.children).forEach(function(n){n.props.selected=u.multiple?-1!=u.defaultValue.indexOf(n.props.value):u.defaultValue==n.props.value})),t.class&&!t.className?(u.class=t.class,Object.defineProperty(u,\"className\",cn)):(t.className&&!t.class||t.class&&t.className)&&(u.class=u.className=t.className),n.props=u}(n),n.$$typeof=q,fn&&fn(n)};var an=e.__r;e.__r=function(n){an&&an(n),ln=n.__c};var sn=e.diffed;e.diffed=function(n){sn&&sn(n);var t=n.props,e=n.__e;null!=e&&\"textarea\"===n.type&&\"value\"in t&&t.value!==e.value&&(e.value=null==t.value?\"\":t.value),ln=null};var hn={ReactCurrentDispatcher:{current:{readContext:function(n){return ln.__n[n.__c].props.value},useCallback:v,useContext:d,useDebugValue:m,useDeferredValue:w,useEffect:h,useId:p,useImperativeHandle:y,useInsertionEffect:I,useLayoutEffect:s,useMemo:_,useReducer:b,useRef:S,useState:a,useSyncExternalStore:C,useTransition:k}}},vn=\"18.3.1\";function dn(n){return t.bind(null,n)}function mn(n){return!!n&&n.$$typeof===q}function pn(n){return mn(n)&&n.type===u}function yn(n){return!!n&&!!n.displayName&&(\"string\"==typeof n.displayName||n.displayName instanceof String)&&n.displayName.startsWith(\"Memo(\")}function _n(n){return mn(n)?f.apply(null,arguments):n}function bn(n){return!!n.__k&&(o(null,n),!0)}function Sn(n){return n&&(n.base||1===n.nodeType&&n)||null}var gn=function(n,t){return n(t)},En=function(n,t){return n(t)},Cn=u,xn=mn,Rn={useState:a,useId:p,useReducer:b,useEffect:h,useLayoutEffect:s,useInsertionEffect:I,useTransition:k,useDeferredValue:w,useSyncExternalStore:C,startTransition:R,useRef:S,useImperativeHandle:y,useMemo:_,useCallback:v,useContext:d,useDebugValue:m,version:\"18.3.1\",Children:O,render:nn,hydrate:tn,unmountComponentAtNode:bn,createPortal:$,createElement:t,createContext:l,createFactory:dn,cloneElement:_n,createRef:c,Fragment:u,isValidElement:mn,isElement:xn,isFragment:pn,isMemo:yn,findDOMNode:Sn,Component:n,PureComponent:N,memo:M,forwardRef:D,flushSync:En,unstable_batchedUpdates:gn,StrictMode:Cn,Suspense:P,SuspenseList:B,lazy:z,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:hn};export{O as Children,N as PureComponent,Cn as StrictMode,P as Suspense,B as SuspenseList,hn as __SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_n as cloneElement,dn as createFactory,$ as createPortal,Rn as default,Sn as findDOMNode,En as flushSync,D as forwardRef,tn as hydrate,xn as isElement,pn as isFragment,yn as isMemo,mn as isValidElement,z as lazy,M as memo,nn as render,R as startTransition,bn as unmountComponentAtNode,gn as unstable_batchedUpdates,w as useDeferredValue,I as useInsertionEffect,C as useSyncExternalStore,k as useTransition,vn as version};\n//# sourceMappingURL=compat.module.js.map\n","import { weakHash, coerceQuery, } from '@instantdb/core';\nimport { useCallback, useRef, useSyncExternalStore } from 'react';\nconst defaultState = {\n    isLoading: true,\n    data: undefined,\n    pageInfo: undefined,\n    error: undefined,\n};\nfunction stateForResult(result) {\n    return Object.assign({ isLoading: !Boolean(result), data: undefined, pageInfo: undefined, error: undefined }, (result ? result : {}));\n}\nexport function useQueryInternal(_core, _query, _opts) {\n    if (_query && _opts && 'ruleParams' in _opts) {\n        _query = Object.assign({ $$ruleParams: _opts['ruleParams'] }, _query);\n    }\n    const query = _query ? coerceQuery(_query) : null;\n    const queryHash = weakHash(query);\n    // We use a ref to store the result of the query.\n    // This is becuase `useSyncExternalStore` uses `Object.is`\n    // to compare the previous and next state.\n    // If we don't use a ref, the state will always be considered different, so\n    // the component will always re-render.\n    const resultCacheRef = useRef(stateForResult(_core._reactor.getPreviousResult(query)));\n    // Similar to `resultCacheRef`, `useSyncExternalStore` will unsubscribe\n    // if `subscribe` changes, so we use `useCallback` to memoize the function.\n    const subscribe = useCallback((cb) => {\n        // Don't subscribe if query is null\n        if (!query) {\n            const unsubscribe = () => { };\n            return unsubscribe;\n        }\n        const unsubscribe = _core.subscribeQuery(query, (result) => {\n            resultCacheRef.current = Object.assign({ isLoading: !Boolean(result), data: undefined, pageInfo: undefined, error: undefined }, result);\n            cb();\n        });\n        return unsubscribe;\n    }, \n    // Build a new subscribe function if the query changes\n    [queryHash]);\n    const state = useSyncExternalStore(subscribe, () => resultCacheRef.current, () => defaultState);\n    return { state, query };\n}\n//# sourceMappingURL=useQuery.js.map","import { useEffect, useRef } from 'react';\nexport function useTimeout() {\n    const timeoutRef = useRef(null);\n    useEffect(() => {\n        clear();\n    }, []);\n    function set(delay, fn) {\n        clearTimeout(timeoutRef.current);\n        timeoutRef.current = setTimeout(fn, delay);\n    }\n    function clear() {\n        clearTimeout(timeoutRef.current);\n    }\n    return { set, clear };\n}\n//# sourceMappingURL=useTimeout.js.map","import { useCallback, useEffect, useMemo, useState, } from 'react';\nimport { useTimeout } from \"./useTimeout.js\";\nexport const defaultActivityStopTimeout = 1000;\n// ------\n// Topics\n/**\n * Listen for broadcasted events given a room and topic.\n *\n * @see https://instantdb.com/docs/presence-and-topics\n * @example\n *  function App({ roomId }) {\n *    const room = db.room('chats', roomId);\n *    db.rooms.useTopicEffect(room, 'emoji', (message, peer) => {\n *      console.log(peer.name, 'sent', message);\n *    });\n *    // ...\n *  }\n */\nexport function useTopicEffect(room, topic, onEvent) {\n    useEffect(() => {\n        const unsub = room._core._reactor.subscribeTopic(room.id, topic, (event, peer) => {\n            onEvent(event, peer);\n        });\n        return unsub;\n    }, [room.id, topic]);\n}\n/**\n * Broadcast an event to a room.\n *\n * @see https://instantdb.com/docs/presence-and-topics\n * @example\n * function App({ roomId }) {\n *   const room = db.room('chat', roomId);\n *   const publishTopic = db.rooms.usePublishTopic(room, \"emoji\");\n *\n *   return (\n *     <button onClick={() => publishTopic({ emoji: \"ðŸ”¥\" })}>Send emoji</button>\n *   );\n * }\n *\n */\nexport function usePublishTopic(room, topic) {\n    useEffect(() => room._core._reactor.joinRoom(room.id), [room.id]);\n    const publishTopic = useCallback((data) => {\n        room._core._reactor.publishTopic({\n            roomType: room.type,\n            roomId: room.id,\n            topic,\n            data,\n        });\n    }, [room.id, topic]);\n    return publishTopic;\n}\n// ---------\n// Presence\n/**\n * Listen for peer's presence data in a room, and publish the current user's presence.\n *\n * @see https://instantdb.com/docs/presence-and-topics\n * @example\n *  function App({ roomId }) {\n *    const {\n *      peers,\n *      publishPresence\n *    } = db.room(roomType, roomId).usePresence({ keys: [\"name\", \"avatar\"] });\n *\n *    // ...\n *  }\n */\nexport function usePresence(room, opts = {}) {\n    var _a, _b;\n    const [state, setState] = useState(() => {\n        var _a;\n        return ((_a = room._core._reactor.getPresence(room.type, room.id, opts)) !== null && _a !== void 0 ? _a : {\n            peers: {},\n            isLoading: true,\n        });\n    });\n    useEffect(() => {\n        const unsub = room._core._reactor.subscribePresence(room.type, room.id, opts, (data) => {\n            setState(data);\n        });\n        return unsub;\n    }, [room.id, opts.user, (_a = opts.peers) === null || _a === void 0 ? void 0 : _a.join(), (_b = opts.keys) === null || _b === void 0 ? void 0 : _b.join()]);\n    const publishPresence = useCallback((data) => {\n        room._core._reactor.publishPresence(room.type, room.id, data);\n    }, [room.type, room.id]);\n    const ret = useMemo(() => {\n        return Object.assign(Object.assign({}, state), { publishPresence });\n    }, [state, publishPresence]);\n    return ret;\n}\n/**\n * Publishes presence data to a room\n *\n * @see https://instantdb.com/docs/presence-and-topics\n * @example\n *  function App({ roomId, nickname }) {\n *    const room = db.room('chat', roomId);\n *    db.rooms.useSyncPresence(room, { nickname });\n *  }\n */\nexport function useSyncPresence(room, data, deps) {\n    useEffect(() => room._core._reactor.joinRoom(room.id, data), [room.id]);\n    useEffect(() => {\n        return room._core._reactor.publishPresence(room.type, room.id, data);\n    }, [room.type, room.id, deps !== null && deps !== void 0 ? deps : JSON.stringify(data)]);\n}\n// -----------------\n// Typing Indicator\n/**\n * Manage typing indicator state\n *\n * @see https://instantdb.com/docs/presence-and-topics\n * @example\n *  function App({ roomId }) {\n *    const room = db.room('chat', roomId);\n *    const {\n *      active,\n *      setActive,\n *      inputProps,\n *    } = db.rooms.useTypingIndicator(room, \"chat-input\");\n *\n *    return <input {...inputProps} />;\n *  }\n */\nexport function useTypingIndicator(room, inputName, opts = {}) {\n    const timeout = useTimeout();\n    const observedPresence = rooms.usePresence(room, {\n        keys: [inputName],\n    });\n    const active = useMemo(() => {\n        var _a;\n        const presenceSnapshot = room._core._reactor.getPresence(room.type, room.id);\n        return (opts === null || opts === void 0 ? void 0 : opts.writeOnly)\n            ? []\n            : Object.values((_a = presenceSnapshot === null || presenceSnapshot === void 0 ? void 0 : presenceSnapshot.peers) !== null && _a !== void 0 ? _a : {}).filter((p) => p[inputName] === true);\n    }, [opts === null || opts === void 0 ? void 0 : opts.writeOnly, observedPresence]);\n    const setActive = useCallback((isActive) => {\n        var _a;\n        room._core._reactor.publishPresence(room.type, room.id, {\n            [inputName]: isActive,\n        });\n        if (!isActive)\n            return;\n        if ((opts === null || opts === void 0 ? void 0 : opts.timeout) === null || (opts === null || opts === void 0 ? void 0 : opts.timeout) === 0)\n            return;\n        timeout.set((_a = opts === null || opts === void 0 ? void 0 : opts.timeout) !== null && _a !== void 0 ? _a : defaultActivityStopTimeout, () => {\n            room._core._reactor.publishPresence(room.type, room.id, {\n                [inputName]: null,\n            });\n        });\n    }, [room.type, room.id, inputName, opts === null || opts === void 0 ? void 0 : opts.timeout, timeout]);\n    const onKeyDown = useCallback((e) => {\n        const isEnter = (opts === null || opts === void 0 ? void 0 : opts.stopOnEnter) && e.key === 'Enter';\n        const isActive = !isEnter;\n        setActive(isActive);\n    }, [opts.stopOnEnter, setActive]);\n    const onBlur = useCallback(() => {\n        setActive(false);\n    }, [setActive]);\n    const inputProps = useMemo(() => {\n        return { onKeyDown, onBlur };\n    }, [onKeyDown, onBlur]);\n    return {\n        active,\n        setActive,\n        inputProps,\n    };\n}\n// --------------\n// Hooks\nexport const rooms = {\n    useTopicEffect,\n    usePublishTopic,\n    usePresence,\n    useSyncPresence,\n    useTypingIndicator,\n};\n// ------------\n// Class\nexport class InstantReactRoom {\n    constructor(_core, type, id) {\n        /**\n         * @deprecated\n         * `db.room(...).useTopicEffect` is deprecated. You can replace it with `db.rooms.useTopicEffect`.\n         *\n         * @example\n         *\n         * // Before\n         * const room = db.room('chat', 'room-id');\n         * room.useTopicEffect('emoji', (message, peer) => {  });\n         *\n         * // After\n         * const room = db.room('chat', 'room-id');\n         * db.rooms.useTopicEffect(room, 'emoji', (message, peer) => {  });\n         */\n        this.useTopicEffect = (topic, onEvent) => {\n            rooms.useTopicEffect(this, topic, onEvent);\n        };\n        /**\n         * @deprecated\n         * `db.room(...).usePublishTopic` is deprecated. You can replace it with `db.rooms.usePublishTopic`.\n         *\n         * @example\n         *\n         * // Before\n         * const room = db.room('chat', 'room-id');\n         * const publish = room.usePublishTopic('emoji');\n         *\n         * // After\n         * const room = db.room('chat', 'room-id');\n         * const publish = db.rooms.usePublishTopic(room, 'emoji');\n         */\n        this.usePublishTopic = (topic) => {\n            return rooms.usePublishTopic(this, topic);\n        };\n        /**\n         * @deprecated\n         * `db.room(...).usePresence` is deprecated. You can replace it with `db.rooms.usePresence`.\n         *\n         * @example\n         *\n         * // Before\n         * const room = db.room('chat', 'room-id');\n         * const { peers } = room.usePresence({ keys: [\"name\", \"avatar\"] });\n         *\n         * // After\n         * const room = db.room('chat', 'room-id');\n         * const { peers } = db.rooms.usePresence(room, { keys: [\"name\", \"avatar\"] });\n         */\n        this.usePresence = (opts = {}) => {\n            return rooms.usePresence(this, opts);\n        };\n        /**\n         * @deprecated\n         * `db.room(...).useSyncPresence` is deprecated. You can replace it with `db.rooms.useSyncPresence`.\n         *\n         * @example\n         *\n         * // Before\n         * const room = db.room('chat', 'room-id');\n         * room.useSyncPresence(room, { nickname });\n         *\n         * // After\n         * const room = db.room('chat', 'room-id');\n         * db.rooms.useSyncPresence(room, { nickname });\n         */\n        this.useSyncPresence = (data, deps) => {\n            return rooms.useSyncPresence(this, data, deps);\n        };\n        /**\n         * @deprecated\n         * `db.room(...).useTypingIndicator` is deprecated. You can replace it with `db.rooms.useTypingIndicator`.\n         *\n         * @example\n         *\n         * // Before\n         * const room = db.room('chat', 'room-id');\n         * const typing = room.useTypingIndiactor(room, 'chat-input');\n         *\n         * // After\n         * const room = db.room('chat', 'room-id');\n         * const typing = db.rooms.useTypingIndiactor(room, 'chat-input');\n         */\n        this.useTypingIndicator = (inputName, opts = {}) => {\n            return rooms.useTypingIndicator(this, inputName, opts);\n        };\n        this._core = _core;\n        this.type = type;\n        this.id = id;\n    }\n}\n//# sourceMappingURL=InstantReactRoom.js.map","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { txInit, init as core_init, } from '@instantdb/core';\nimport { useCallback, useEffect, useRef, useState, useSyncExternalStore, } from 'react';\nimport { useQueryInternal } from \"./useQuery.js\";\nimport { InstantReactRoom, rooms } from \"./InstantReactRoom.js\";\nconst defaultAuthState = {\n    isLoading: true,\n    user: undefined,\n    error: undefined,\n};\nexport default class InstantReactAbstractDatabase {\n    constructor(config, versions) {\n        this.tx = txInit();\n        /**\n         * Returns a unique ID for a given `name`. It's stored in local storage,\n         * so you will get the same ID across sessions.\n         *\n         * This is useful for generating IDs that could identify a local device or user.\n         *\n         * @example\n         *  const deviceId = await db.getLocalId('device');\n         */\n        this.getLocalId = (name) => {\n            return this._core.getLocalId(name);\n        };\n        /**\n         * A hook that returns a unique ID for a given `name`. localIds are\n         * stored in local storage, so you will get the same ID across sessions.\n         *\n         * Initially returns `null`, and then loads the localId.\n         *\n         * @example\n         * const deviceId = db.useLocalId('device');\n         * if (!deviceId) return null; // loading\n         * console.log('Device ID:', deviceId)\n         */\n        this.useLocalId = (name) => {\n            const [localId, setLocalId] = useState(null);\n            useEffect(() => {\n                let mounted = true;\n                const f = () => __awaiter(this, void 0, void 0, function* () {\n                    const id = yield this.getLocalId(name);\n                    if (!mounted)\n                        return;\n                    setLocalId(id);\n                });\n                f();\n                return;\n            }, [name]);\n            return localId;\n        };\n        /**\n         * Hooks for working with rooms\n         *\n         * @see https://instantdb.com/docs/presence-and-topics\n         *\n         * @example\n         *  const room = db.room('chat', roomId);\n         *  const { peers } = db.rooms.usePresence(room);\n         *  const publish = db.rooms.usePublishTopic(room, 'emoji');\n         *  // ...\n         */\n        this.rooms = rooms;\n        /**\n         * Use this to write data! You can create, update, delete, and link objects\n         *\n         * @see https://instantdb.com/docs/instaml\n         *\n         * @example\n         *   // Create a new object in the `goals` namespace\n         *   const goalId = id();\n         *   db.transact(db.tx.goals[goalId].update({title: \"Get fit\"}))\n         *\n         *   // Update the title\n         *   db.transact(db.tx.goals[goalId].update({title: \"Get super fit\"}))\n         *\n         *   // Delete it\n         *   db.transact(db.tx.goals[goalId].delete())\n         *\n         *   // Or create an association:\n         *   todoId = id();\n         *   db.transact([\n         *    db.tx.todos[todoId].update({ title: 'Go on a run' }),\n         *    db.tx.goals[goalId].link({todos: todoId}),\n         *  ])\n         */\n        this.transact = (chunks) => {\n            return this._core.transact(chunks);\n        };\n        /**\n         * Use this to query your data!\n         *\n         * @see https://instantdb.com/docs/instaql\n         *\n         * @example\n         *  // listen to all goals\n         *  db.useQuery({ goals: {} })\n         *\n         *  // goals where the title is \"Get Fit\"\n         *  db.useQuery({ goals: { $: { where: { title: \"Get Fit\" } } } })\n         *\n         *  // all goals, _alongside_ their todos\n         *  db.useQuery({ goals: { todos: {} } })\n         *\n         *  // skip if `user` is not logged in\n         *  db.useQuery(auth.user ? { goals: {} } : null)\n         */\n        this.useQuery = (query, opts) => {\n            return useQueryInternal(this._core, query, opts).state;\n        };\n        /**\n         * Listen for the logged in state. This is useful\n         * for deciding when to show a login screen.\n         *\n         * Check out the docs for an example `Login` component too!\n         *\n         * @see https://instantdb.com/docs/auth\n         * @example\n         *  function App() {\n         *    const { isLoading, user, error } = db.useAuth()\n         *    if (isLoading) {\n         *      return <div>Loading...</div>\n         *    }\n         *    if (error) {\n         *      return <div>Uh oh! {error.message}</div>\n         *    }\n         *    if (user) {\n         *      return <Main user={user} />\n         *    }\n         *    return <Login />\n         *  }\n         *\n         */\n        this.useAuth = () => {\n            // We use a ref to store the result of the query.\n            // This is becuase `useSyncExternalStore` uses `Object.is`\n            // to compare the previous and next state.\n            // If we don't use a ref, the state will always be considered different, so\n            // the component will always re-render.\n            const resultCacheRef = useRef(this._core._reactor._currentUserCached);\n            // Similar to `resultCacheRef`, `useSyncExternalStore` will unsubscribe\n            // if `subscribe` changes, so we use `useCallback` to memoize the function.\n            const subscribe = useCallback((cb) => {\n                const unsubscribe = this._core.subscribeAuth((auth) => {\n                    resultCacheRef.current = Object.assign({ isLoading: false }, auth);\n                    cb();\n                });\n                return unsubscribe;\n            }, []);\n            const state = useSyncExternalStore(subscribe, () => resultCacheRef.current, () => defaultAuthState);\n            return state;\n        };\n        /**\n         * Listen for connection status changes to Instant. Use this for things like\n         * showing connection state to users\n         *\n         * @see https://www.instantdb.com/docs/patterns#connection-status\n         * @example\n         *  function App() {\n         *    const status = db.useConnectionStatus()\n         *    const connectionState =\n         *      status === 'connecting' || status === 'opened'\n         *        ? 'authenticating'\n         *      : status === 'authenticated'\n         *        ? 'connected'\n         *      : status === 'closed'\n         *        ? 'closed'\n         *      : status === 'errored'\n         *        ? 'errored'\n         *      : 'unexpected state';\n         *\n         *    return <div>Connection state: {connectionState}</div>\n         *  }\n         */\n        this.useConnectionStatus = () => {\n            const statusRef = useRef(this._core._reactor.status);\n            const subscribe = useCallback((cb) => {\n                const unsubscribe = this._core.subscribeConnectionStatus((newStatus) => {\n                    if (newStatus !== statusRef.current) {\n                        statusRef.current = newStatus;\n                        cb();\n                    }\n                });\n                return unsubscribe;\n            }, []);\n            const status = useSyncExternalStore(subscribe, () => statusRef.current, \n            // For SSR, always return 'connecting' as the initial state\n            () => 'connecting');\n            return status;\n        };\n        /**\n         * Use this for one-off queries.\n         * Returns local data if available, otherwise fetches from the server.\n         * Because we want to avoid stale data, this method will throw an error\n         * if the user is offline or there is no active connection to the server.\n         *\n         * @see https://instantdb.com/docs/instaql\n         *\n         * @example\n         *\n         *  const resp = await db.queryOnce({ goals: {} });\n         *  console.log(resp.data.goals)\n         */\n        this.queryOnce = (query, opts) => {\n            return this._core.queryOnce(query, opts);\n        };\n        this._core = core_init(config, \n        // @ts-expect-error because TS can't resolve subclass statics\n        this.constructor.Storage, \n        // @ts-expect-error because TS can't resolve subclass statics\n        this.constructor.NetworkListener, versions);\n        this.auth = this._core.auth;\n        this.storage = this._core.storage;\n    }\n    /**\n     * Obtain a handle to a room, which allows you to listen to topics and presence data\n     *\n     * If you don't provide a `type` or `id`, Instant will default to `_defaultRoomType` and `_defaultRoomId`\n     * as the room type and id, respectively.\n     *\n     * @see https://instantdb.com/docs/presence-and-topics\n     *\n     * @example\n     *  const room = db.room('chat', roomId);\n     *  const { peers } = db.rooms.usePresence(room);\n     */\n    room(type = '_defaultRoomType', id = '_defaultRoomId') {\n        return new InstantReactRoom(this._core, type, id);\n    }\n    /**\n     * One time query for the logged in state. This is useful\n     * for scenarios where you want to know the current auth\n     * state without subscribing to changes.\n     *\n     * @see https://instantdb.com/docs/auth\n     * @example\n     *   const user = await db.getAuth();\n     *   console.log('logged in as', user.email)\n     */\n    getAuth() {\n        return this._core.getAuth();\n    }\n}\n//# sourceMappingURL=InstantReactAbstractDatabase.js.map","import InstantReactAbstractDatabase from \"./InstantReactAbstractDatabase.js\";\nexport default class InstantReactWebDatabase extends InstantReactAbstractDatabase {\n}\n//# sourceMappingURL=InstantReactWebDatabase.js.map","// Autogenerated by publish_packages.clj\nconst version = 'v0.19.5';\nexport default version;\n//# sourceMappingURL=version.js.map","import InstantReactWebDatabase from \"./InstantReactWebDatabase.js\";\nimport version from './version.js';\n/**\n *\n * The first step: init your application!\n *\n * Visit https://instantdb.com/dash to get your `appId` :)\n *\n * @example\n *  import { init } from \"@instantdb/react\"\n *\n *  const db = init({ appId: \"my-app-id\" })\n *\n *  // You can also provide a schema for type safety and editor autocomplete!\n *\n *  import { init } from \"@instantdb/react\"\n *  import schema from \"\"../instant.schema.ts\";\n *\n *  const db = init({ appId: \"my-app-id\", schema })\n *\n *  // To learn more: https://instantdb.com/docs/modeling-data\n */\nexport function init(config) {\n    return new InstantReactWebDatabase(config, {\n        '@instantdb/react': version,\n    });\n}\n/**\n * @deprecated\n * `init_experimental` is deprecated. You can replace it with `init`.\n *\n * @example\n *\n * // Before\n * import { init_experimental } from \"@instantdb/react\"\n * const db = init_experimental({  ...  });\n *\n * // After\n * import { init } from \"@instantdb/react\"\n * const db = init({ ...  });\n */\nexport const init_experimental = init;\n//# sourceMappingURL=init.js.map","var util;\n(function (util) {\n    util.assertEqual = (val) => val;\n    function assertIs(_arg) { }\n    util.assertIs = assertIs;\n    function assertNever(_x) {\n        throw new Error();\n    }\n    util.assertNever = assertNever;\n    util.arrayToEnum = (items) => {\n        const obj = {};\n        for (const item of items) {\n            obj[item] = item;\n        }\n        return obj;\n    };\n    util.getValidEnumValues = (obj) => {\n        const validKeys = util.objectKeys(obj).filter((k) => typeof obj[obj[k]] !== \"number\");\n        const filtered = {};\n        for (const k of validKeys) {\n            filtered[k] = obj[k];\n        }\n        return util.objectValues(filtered);\n    };\n    util.objectValues = (obj) => {\n        return util.objectKeys(obj).map(function (e) {\n            return obj[e];\n        });\n    };\n    util.objectKeys = typeof Object.keys === \"function\" // eslint-disable-line ban/ban\n        ? (obj) => Object.keys(obj) // eslint-disable-line ban/ban\n        : (object) => {\n            const keys = [];\n            for (const key in object) {\n                if (Object.prototype.hasOwnProperty.call(object, key)) {\n                    keys.push(key);\n                }\n            }\n            return keys;\n        };\n    util.find = (arr, checker) => {\n        for (const item of arr) {\n            if (checker(item))\n                return item;\n        }\n        return undefined;\n    };\n    util.isInteger = typeof Number.isInteger === \"function\"\n        ? (val) => Number.isInteger(val) // eslint-disable-line ban/ban\n        : (val) => typeof val === \"number\" && isFinite(val) && Math.floor(val) === val;\n    function joinValues(array, separator = \" | \") {\n        return array\n            .map((val) => (typeof val === \"string\" ? `'${val}'` : val))\n            .join(separator);\n    }\n    util.joinValues = joinValues;\n    util.jsonStringifyReplacer = (_, value) => {\n        if (typeof value === \"bigint\") {\n            return value.toString();\n        }\n        return value;\n    };\n})(util || (util = {}));\nvar objectUtil;\n(function (objectUtil) {\n    objectUtil.mergeShapes = (first, second) => {\n        return {\n            ...first,\n            ...second, // second overwrites first\n        };\n    };\n})(objectUtil || (objectUtil = {}));\nconst ZodParsedType = util.arrayToEnum([\n    \"string\",\n    \"nan\",\n    \"number\",\n    \"integer\",\n    \"float\",\n    \"boolean\",\n    \"date\",\n    \"bigint\",\n    \"symbol\",\n    \"function\",\n    \"undefined\",\n    \"null\",\n    \"array\",\n    \"object\",\n    \"unknown\",\n    \"promise\",\n    \"void\",\n    \"never\",\n    \"map\",\n    \"set\",\n]);\nconst getParsedType = (data) => {\n    const t = typeof data;\n    switch (t) {\n        case \"undefined\":\n            return ZodParsedType.undefined;\n        case \"string\":\n            return ZodParsedType.string;\n        case \"number\":\n            return isNaN(data) ? ZodParsedType.nan : ZodParsedType.number;\n        case \"boolean\":\n            return ZodParsedType.boolean;\n        case \"function\":\n            return ZodParsedType.function;\n        case \"bigint\":\n            return ZodParsedType.bigint;\n        case \"symbol\":\n            return ZodParsedType.symbol;\n        case \"object\":\n            if (Array.isArray(data)) {\n                return ZodParsedType.array;\n            }\n            if (data === null) {\n                return ZodParsedType.null;\n            }\n            if (data.then &&\n                typeof data.then === \"function\" &&\n                data.catch &&\n                typeof data.catch === \"function\") {\n                return ZodParsedType.promise;\n            }\n            if (typeof Map !== \"undefined\" && data instanceof Map) {\n                return ZodParsedType.map;\n            }\n            if (typeof Set !== \"undefined\" && data instanceof Set) {\n                return ZodParsedType.set;\n            }\n            if (typeof Date !== \"undefined\" && data instanceof Date) {\n                return ZodParsedType.date;\n            }\n            return ZodParsedType.object;\n        default:\n            return ZodParsedType.unknown;\n    }\n};\n\nconst ZodIssueCode = util.arrayToEnum([\n    \"invalid_type\",\n    \"invalid_literal\",\n    \"custom\",\n    \"invalid_union\",\n    \"invalid_union_discriminator\",\n    \"invalid_enum_value\",\n    \"unrecognized_keys\",\n    \"invalid_arguments\",\n    \"invalid_return_type\",\n    \"invalid_date\",\n    \"invalid_string\",\n    \"too_small\",\n    \"too_big\",\n    \"invalid_intersection_types\",\n    \"not_multiple_of\",\n    \"not_finite\",\n]);\nconst quotelessJson = (obj) => {\n    const json = JSON.stringify(obj, null, 2);\n    return json.replace(/\"([^\"]+)\":/g, \"$1:\");\n};\nclass ZodError extends Error {\n    constructor(issues) {\n        super();\n        this.issues = [];\n        this.addIssue = (sub) => {\n            this.issues = [...this.issues, sub];\n        };\n        this.addIssues = (subs = []) => {\n            this.issues = [...this.issues, ...subs];\n        };\n        const actualProto = new.target.prototype;\n        if (Object.setPrototypeOf) {\n            // eslint-disable-next-line ban/ban\n            Object.setPrototypeOf(this, actualProto);\n        }\n        else {\n            this.__proto__ = actualProto;\n        }\n        this.name = \"ZodError\";\n        this.issues = issues;\n    }\n    get errors() {\n        return this.issues;\n    }\n    format(_mapper) {\n        const mapper = _mapper ||\n            function (issue) {\n                return issue.message;\n            };\n        const fieldErrors = { _errors: [] };\n        const processError = (error) => {\n            for (const issue of error.issues) {\n                if (issue.code === \"invalid_union\") {\n                    issue.unionErrors.map(processError);\n                }\n                else if (issue.code === \"invalid_return_type\") {\n                    processError(issue.returnTypeError);\n                }\n                else if (issue.code === \"invalid_arguments\") {\n                    processError(issue.argumentsError);\n                }\n                else if (issue.path.length === 0) {\n                    fieldErrors._errors.push(mapper(issue));\n                }\n                else {\n                    let curr = fieldErrors;\n                    let i = 0;\n                    while (i < issue.path.length) {\n                        const el = issue.path[i];\n                        const terminal = i === issue.path.length - 1;\n                        if (!terminal) {\n                            curr[el] = curr[el] || { _errors: [] };\n                            // if (typeof el === \"string\") {\n                            //   curr[el] = curr[el] || { _errors: [] };\n                            // } else if (typeof el === \"number\") {\n                            //   const errorArray: any = [];\n                            //   errorArray._errors = [];\n                            //   curr[el] = curr[el] || errorArray;\n                            // }\n                        }\n                        else {\n                            curr[el] = curr[el] || { _errors: [] };\n                            curr[el]._errors.push(mapper(issue));\n                        }\n                        curr = curr[el];\n                        i++;\n                    }\n                }\n            }\n        };\n        processError(this);\n        return fieldErrors;\n    }\n    toString() {\n        return this.message;\n    }\n    get message() {\n        return JSON.stringify(this.issues, util.jsonStringifyReplacer, 2);\n    }\n    get isEmpty() {\n        return this.issues.length === 0;\n    }\n    flatten(mapper = (issue) => issue.message) {\n        const fieldErrors = {};\n        const formErrors = [];\n        for (const sub of this.issues) {\n            if (sub.path.length > 0) {\n                fieldErrors[sub.path[0]] = fieldErrors[sub.path[0]] || [];\n                fieldErrors[sub.path[0]].push(mapper(sub));\n            }\n            else {\n                formErrors.push(mapper(sub));\n            }\n        }\n        return { formErrors, fieldErrors };\n    }\n    get formErrors() {\n        return this.flatten();\n    }\n}\nZodError.create = (issues) => {\n    const error = new ZodError(issues);\n    return error;\n};\n\nconst errorMap = (issue, _ctx) => {\n    let message;\n    switch (issue.code) {\n        case ZodIssueCode.invalid_type:\n            if (issue.received === ZodParsedType.undefined) {\n                message = \"Required\";\n            }\n            else {\n                message = `Expected ${issue.expected}, received ${issue.received}`;\n            }\n            break;\n        case ZodIssueCode.invalid_literal:\n            message = `Invalid literal value, expected ${JSON.stringify(issue.expected, util.jsonStringifyReplacer)}`;\n            break;\n        case ZodIssueCode.unrecognized_keys:\n            message = `Unrecognized key(s) in object: ${util.joinValues(issue.keys, \", \")}`;\n            break;\n        case ZodIssueCode.invalid_union:\n            message = `Invalid input`;\n            break;\n        case ZodIssueCode.invalid_union_discriminator:\n            message = `Invalid discriminator value. Expected ${util.joinValues(issue.options)}`;\n            break;\n        case ZodIssueCode.invalid_enum_value:\n            message = `Invalid enum value. Expected ${util.joinValues(issue.options)}, received '${issue.received}'`;\n            break;\n        case ZodIssueCode.invalid_arguments:\n            message = `Invalid function arguments`;\n            break;\n        case ZodIssueCode.invalid_return_type:\n            message = `Invalid function return type`;\n            break;\n        case ZodIssueCode.invalid_date:\n            message = `Invalid date`;\n            break;\n        case ZodIssueCode.invalid_string:\n            if (typeof issue.validation === \"object\") {\n                if (\"includes\" in issue.validation) {\n                    message = `Invalid input: must include \"${issue.validation.includes}\"`;\n                    if (typeof issue.validation.position === \"number\") {\n                        message = `${message} at one or more positions greater than or equal to ${issue.validation.position}`;\n                    }\n                }\n                else if (\"startsWith\" in issue.validation) {\n                    message = `Invalid input: must start with \"${issue.validation.startsWith}\"`;\n                }\n                else if (\"endsWith\" in issue.validation) {\n                    message = `Invalid input: must end with \"${issue.validation.endsWith}\"`;\n                }\n                else {\n                    util.assertNever(issue.validation);\n                }\n            }\n            else if (issue.validation !== \"regex\") {\n                message = `Invalid ${issue.validation}`;\n            }\n            else {\n                message = \"Invalid\";\n            }\n            break;\n        case ZodIssueCode.too_small:\n            if (issue.type === \"array\")\n                message = `Array must contain ${issue.exact ? \"exactly\" : issue.inclusive ? `at least` : `more than`} ${issue.minimum} element(s)`;\n            else if (issue.type === \"string\")\n                message = `String must contain ${issue.exact ? \"exactly\" : issue.inclusive ? `at least` : `over`} ${issue.minimum} character(s)`;\n            else if (issue.type === \"number\")\n                message = `Number must be ${issue.exact\n                    ? `exactly equal to `\n                    : issue.inclusive\n                        ? `greater than or equal to `\n                        : `greater than `}${issue.minimum}`;\n            else if (issue.type === \"date\")\n                message = `Date must be ${issue.exact\n                    ? `exactly equal to `\n                    : issue.inclusive\n                        ? `greater than or equal to `\n                        : `greater than `}${new Date(Number(issue.minimum))}`;\n            else\n                message = \"Invalid input\";\n            break;\n        case ZodIssueCode.too_big:\n            if (issue.type === \"array\")\n                message = `Array must contain ${issue.exact ? `exactly` : issue.inclusive ? `at most` : `less than`} ${issue.maximum} element(s)`;\n            else if (issue.type === \"string\")\n                message = `String must contain ${issue.exact ? `exactly` : issue.inclusive ? `at most` : `under`} ${issue.maximum} character(s)`;\n            else if (issue.type === \"number\")\n                message = `Number must be ${issue.exact\n                    ? `exactly`\n                    : issue.inclusive\n                        ? `less than or equal to`\n                        : `less than`} ${issue.maximum}`;\n            else if (issue.type === \"bigint\")\n                message = `BigInt must be ${issue.exact\n                    ? `exactly`\n                    : issue.inclusive\n                        ? `less than or equal to`\n                        : `less than`} ${issue.maximum}`;\n            else if (issue.type === \"date\")\n                message = `Date must be ${issue.exact\n                    ? `exactly`\n                    : issue.inclusive\n                        ? `smaller than or equal to`\n                        : `smaller than`} ${new Date(Number(issue.maximum))}`;\n            else\n                message = \"Invalid input\";\n            break;\n        case ZodIssueCode.custom:\n            message = `Invalid input`;\n            break;\n        case ZodIssueCode.invalid_intersection_types:\n            message = `Intersection results could not be merged`;\n            break;\n        case ZodIssueCode.not_multiple_of:\n            message = `Number must be a multiple of ${issue.multipleOf}`;\n            break;\n        case ZodIssueCode.not_finite:\n            message = \"Number must be finite\";\n            break;\n        default:\n            message = _ctx.defaultError;\n            util.assertNever(issue);\n    }\n    return { message };\n};\n\nlet overrideErrorMap = errorMap;\nfunction setErrorMap(map) {\n    overrideErrorMap = map;\n}\nfunction getErrorMap() {\n    return overrideErrorMap;\n}\n\nconst makeIssue = (params) => {\n    const { data, path, errorMaps, issueData } = params;\n    const fullPath = [...path, ...(issueData.path || [])];\n    const fullIssue = {\n        ...issueData,\n        path: fullPath,\n    };\n    let errorMessage = \"\";\n    const maps = errorMaps\n        .filter((m) => !!m)\n        .slice()\n        .reverse();\n    for (const map of maps) {\n        errorMessage = map(fullIssue, { data, defaultError: errorMessage }).message;\n    }\n    return {\n        ...issueData,\n        path: fullPath,\n        message: issueData.message || errorMessage,\n    };\n};\nconst EMPTY_PATH = [];\nfunction addIssueToContext(ctx, issueData) {\n    const issue = makeIssue({\n        issueData: issueData,\n        data: ctx.data,\n        path: ctx.path,\n        errorMaps: [\n            ctx.common.contextualErrorMap,\n            ctx.schemaErrorMap,\n            getErrorMap(),\n            errorMap, // then global default map\n        ].filter((x) => !!x),\n    });\n    ctx.common.issues.push(issue);\n}\nclass ParseStatus {\n    constructor() {\n        this.value = \"valid\";\n    }\n    dirty() {\n        if (this.value === \"valid\")\n            this.value = \"dirty\";\n    }\n    abort() {\n        if (this.value !== \"aborted\")\n            this.value = \"aborted\";\n    }\n    static mergeArray(status, results) {\n        const arrayValue = [];\n        for (const s of results) {\n            if (s.status === \"aborted\")\n                return INVALID;\n            if (s.status === \"dirty\")\n                status.dirty();\n            arrayValue.push(s.value);\n        }\n        return { status: status.value, value: arrayValue };\n    }\n    static async mergeObjectAsync(status, pairs) {\n        const syncPairs = [];\n        for (const pair of pairs) {\n            syncPairs.push({\n                key: await pair.key,\n                value: await pair.value,\n            });\n        }\n        return ParseStatus.mergeObjectSync(status, syncPairs);\n    }\n    static mergeObjectSync(status, pairs) {\n        const finalObject = {};\n        for (const pair of pairs) {\n            const { key, value } = pair;\n            if (key.status === \"aborted\")\n                return INVALID;\n            if (value.status === \"aborted\")\n                return INVALID;\n            if (key.status === \"dirty\")\n                status.dirty();\n            if (value.status === \"dirty\")\n                status.dirty();\n            if (key.value !== \"__proto__\" &&\n                (typeof value.value !== \"undefined\" || pair.alwaysSet)) {\n                finalObject[key.value] = value.value;\n            }\n        }\n        return { status: status.value, value: finalObject };\n    }\n}\nconst INVALID = Object.freeze({\n    status: \"aborted\",\n});\nconst DIRTY = (value) => ({ status: \"dirty\", value });\nconst OK = (value) => ({ status: \"valid\", value });\nconst isAborted = (x) => x.status === \"aborted\";\nconst isDirty = (x) => x.status === \"dirty\";\nconst isValid = (x) => x.status === \"valid\";\nconst isAsync = (x) => typeof Promise !== \"undefined\" && x instanceof Promise;\n\nvar errorUtil;\n(function (errorUtil) {\n    errorUtil.errToObj = (message) => typeof message === \"string\" ? { message } : message || {};\n    errorUtil.toString = (message) => typeof message === \"string\" ? message : message === null || message === void 0 ? void 0 : message.message;\n})(errorUtil || (errorUtil = {}));\n\nclass ParseInputLazyPath {\n    constructor(parent, value, path, key) {\n        this._cachedPath = [];\n        this.parent = parent;\n        this.data = value;\n        this._path = path;\n        this._key = key;\n    }\n    get path() {\n        if (!this._cachedPath.length) {\n            if (this._key instanceof Array) {\n                this._cachedPath.push(...this._path, ...this._key);\n            }\n            else {\n                this._cachedPath.push(...this._path, this._key);\n            }\n        }\n        return this._cachedPath;\n    }\n}\nconst handleResult = (ctx, result) => {\n    if (isValid(result)) {\n        return { success: true, data: result.value };\n    }\n    else {\n        if (!ctx.common.issues.length) {\n            throw new Error(\"Validation failed but no issues detected.\");\n        }\n        return {\n            success: false,\n            get error() {\n                if (this._error)\n                    return this._error;\n                const error = new ZodError(ctx.common.issues);\n                this._error = error;\n                return this._error;\n            },\n        };\n    }\n};\nfunction processCreateParams(params) {\n    if (!params)\n        return {};\n    const { errorMap, invalid_type_error, required_error, description } = params;\n    if (errorMap && (invalid_type_error || required_error)) {\n        throw new Error(`Can't use \"invalid_type_error\" or \"required_error\" in conjunction with custom error map.`);\n    }\n    if (errorMap)\n        return { errorMap: errorMap, description };\n    const customMap = (iss, ctx) => {\n        if (iss.code !== \"invalid_type\")\n            return { message: ctx.defaultError };\n        if (typeof ctx.data === \"undefined\") {\n            return { message: required_error !== null && required_error !== void 0 ? required_error : ctx.defaultError };\n        }\n        return { message: invalid_type_error !== null && invalid_type_error !== void 0 ? invalid_type_error : ctx.defaultError };\n    };\n    return { errorMap: customMap, description };\n}\nclass ZodType {\n    constructor(def) {\n        /** Alias of safeParseAsync */\n        this.spa = this.safeParseAsync;\n        this._def = def;\n        this.parse = this.parse.bind(this);\n        this.safeParse = this.safeParse.bind(this);\n        this.parseAsync = this.parseAsync.bind(this);\n        this.safeParseAsync = this.safeParseAsync.bind(this);\n        this.spa = this.spa.bind(this);\n        this.refine = this.refine.bind(this);\n        this.refinement = this.refinement.bind(this);\n        this.superRefine = this.superRefine.bind(this);\n        this.optional = this.optional.bind(this);\n        this.nullable = this.nullable.bind(this);\n        this.nullish = this.nullish.bind(this);\n        this.array = this.array.bind(this);\n        this.promise = this.promise.bind(this);\n        this.or = this.or.bind(this);\n        this.and = this.and.bind(this);\n        this.transform = this.transform.bind(this);\n        this.brand = this.brand.bind(this);\n        this.default = this.default.bind(this);\n        this.catch = this.catch.bind(this);\n        this.describe = this.describe.bind(this);\n        this.pipe = this.pipe.bind(this);\n        this.readonly = this.readonly.bind(this);\n        this.isNullable = this.isNullable.bind(this);\n        this.isOptional = this.isOptional.bind(this);\n    }\n    get description() {\n        return this._def.description;\n    }\n    _getType(input) {\n        return getParsedType(input.data);\n    }\n    _getOrReturnCtx(input, ctx) {\n        return (ctx || {\n            common: input.parent.common,\n            data: input.data,\n            parsedType: getParsedType(input.data),\n            schemaErrorMap: this._def.errorMap,\n            path: input.path,\n            parent: input.parent,\n        });\n    }\n    _processInputParams(input) {\n        return {\n            status: new ParseStatus(),\n            ctx: {\n                common: input.parent.common,\n                data: input.data,\n                parsedType: getParsedType(input.data),\n                schemaErrorMap: this._def.errorMap,\n                path: input.path,\n                parent: input.parent,\n            },\n        };\n    }\n    _parseSync(input) {\n        const result = this._parse(input);\n        if (isAsync(result)) {\n            throw new Error(\"Synchronous parse encountered promise.\");\n        }\n        return result;\n    }\n    _parseAsync(input) {\n        const result = this._parse(input);\n        return Promise.resolve(result);\n    }\n    parse(data, params) {\n        const result = this.safeParse(data, params);\n        if (result.success)\n            return result.data;\n        throw result.error;\n    }\n    safeParse(data, params) {\n        var _a;\n        const ctx = {\n            common: {\n                issues: [],\n                async: (_a = params === null || params === void 0 ? void 0 : params.async) !== null && _a !== void 0 ? _a : false,\n                contextualErrorMap: params === null || params === void 0 ? void 0 : params.errorMap,\n            },\n            path: (params === null || params === void 0 ? void 0 : params.path) || [],\n            schemaErrorMap: this._def.errorMap,\n            parent: null,\n            data,\n            parsedType: getParsedType(data),\n        };\n        const result = this._parseSync({ data, path: ctx.path, parent: ctx });\n        return handleResult(ctx, result);\n    }\n    async parseAsync(data, params) {\n        const result = await this.safeParseAsync(data, params);\n        if (result.success)\n            return result.data;\n        throw result.error;\n    }\n    async safeParseAsync(data, params) {\n        const ctx = {\n            common: {\n                issues: [],\n                contextualErrorMap: params === null || params === void 0 ? void 0 : params.errorMap,\n                async: true,\n            },\n            path: (params === null || params === void 0 ? void 0 : params.path) || [],\n            schemaErrorMap: this._def.errorMap,\n            parent: null,\n            data,\n            parsedType: getParsedType(data),\n        };\n        const maybeAsyncResult = this._parse({ data, path: ctx.path, parent: ctx });\n        const result = await (isAsync(maybeAsyncResult)\n            ? maybeAsyncResult\n            : Promise.resolve(maybeAsyncResult));\n        return handleResult(ctx, result);\n    }\n    refine(check, message) {\n        const getIssueProperties = (val) => {\n            if (typeof message === \"string\" || typeof message === \"undefined\") {\n                return { message };\n            }\n            else if (typeof message === \"function\") {\n                return message(val);\n            }\n            else {\n                return message;\n            }\n        };\n        return this._refinement((val, ctx) => {\n            const result = check(val);\n            const setError = () => ctx.addIssue({\n                code: ZodIssueCode.custom,\n                ...getIssueProperties(val),\n            });\n            if (typeof Promise !== \"undefined\" && result instanceof Promise) {\n                return result.then((data) => {\n                    if (!data) {\n                        setError();\n                        return false;\n                    }\n                    else {\n                        return true;\n                    }\n                });\n            }\n            if (!result) {\n                setError();\n                return false;\n            }\n            else {\n                return true;\n            }\n        });\n    }\n    refinement(check, refinementData) {\n        return this._refinement((val, ctx) => {\n            if (!check(val)) {\n                ctx.addIssue(typeof refinementData === \"function\"\n                    ? refinementData(val, ctx)\n                    : refinementData);\n                return false;\n            }\n            else {\n                return true;\n            }\n        });\n    }\n    _refinement(refinement) {\n        return new ZodEffects({\n            schema: this,\n            typeName: ZodFirstPartyTypeKind.ZodEffects,\n            effect: { type: \"refinement\", refinement },\n        });\n    }\n    superRefine(refinement) {\n        return this._refinement(refinement);\n    }\n    optional() {\n        return ZodOptional.create(this, this._def);\n    }\n    nullable() {\n        return ZodNullable.create(this, this._def);\n    }\n    nullish() {\n        return this.nullable().optional();\n    }\n    array() {\n        return ZodArray.create(this, this._def);\n    }\n    promise() {\n        return ZodPromise.create(this, this._def);\n    }\n    or(option) {\n        return ZodUnion.create([this, option], this._def);\n    }\n    and(incoming) {\n        return ZodIntersection.create(this, incoming, this._def);\n    }\n    transform(transform) {\n        return new ZodEffects({\n            ...processCreateParams(this._def),\n            schema: this,\n            typeName: ZodFirstPartyTypeKind.ZodEffects,\n            effect: { type: \"transform\", transform },\n        });\n    }\n    default(def) {\n        const defaultValueFunc = typeof def === \"function\" ? def : () => def;\n        return new ZodDefault({\n            ...processCreateParams(this._def),\n            innerType: this,\n            defaultValue: defaultValueFunc,\n            typeName: ZodFirstPartyTypeKind.ZodDefault,\n        });\n    }\n    brand() {\n        return new ZodBranded({\n            typeName: ZodFirstPartyTypeKind.ZodBranded,\n            type: this,\n            ...processCreateParams(this._def),\n        });\n    }\n    catch(def) {\n        const catchValueFunc = typeof def === \"function\" ? def : () => def;\n        return new ZodCatch({\n            ...processCreateParams(this._def),\n            innerType: this,\n            catchValue: catchValueFunc,\n            typeName: ZodFirstPartyTypeKind.ZodCatch,\n        });\n    }\n    describe(description) {\n        const This = this.constructor;\n        return new This({\n            ...this._def,\n            description,\n        });\n    }\n    pipe(target) {\n        return ZodPipeline.create(this, target);\n    }\n    readonly() {\n        return ZodReadonly.create(this);\n    }\n    isOptional() {\n        return this.safeParse(undefined).success;\n    }\n    isNullable() {\n        return this.safeParse(null).success;\n    }\n}\nconst cuidRegex = /^c[^\\s-]{8,}$/i;\nconst cuid2Regex = /^[a-z][a-z0-9]*$/;\nconst ulidRegex = /^[0-9A-HJKMNP-TV-Z]{26}$/;\n// const uuidRegex =\n//   /^([a-f0-9]{8}-[a-f0-9]{4}-[1-5][a-f0-9]{3}-[a-f0-9]{4}-[a-f0-9]{12}|00000000-0000-0000-0000-000000000000)$/i;\nconst uuidRegex = /^[0-9a-fA-F]{8}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{12}$/i;\n// from https://stackoverflow.com/a/46181/1550155\n// old version: too slow, didn't support unicode\n// const emailRegex = /^((([a-z]|\\d|[!#\\$%&'\\*\\+\\-\\/=\\?\\^_`{\\|}~]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])+(\\.([a-z]|\\d|[!#\\$%&'\\*\\+\\-\\/=\\?\\^_`{\\|}~]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])+)*)|((\\x22)((((\\x20|\\x09)*(\\x0d\\x0a))?(\\x20|\\x09)+)?(([\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x7f]|\\x21|[\\x23-\\x5b]|[\\x5d-\\x7e]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(\\\\([\\x01-\\x09\\x0b\\x0c\\x0d-\\x7f]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]))))*(((\\x20|\\x09)*(\\x0d\\x0a))?(\\x20|\\x09)+)?(\\x22)))@((([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])*([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])))\\.)+(([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])*([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])))$/i;\n//old email regex\n// const emailRegex = /^(([^<>()[\\].,;:\\s@\"]+(\\.[^<>()[\\].,;:\\s@\"]+)*)|(\".+\"))@((?!-)([^<>()[\\].,;:\\s@\"]+\\.)+[^<>()[\\].,;:\\s@\"]{1,})[^-<>()[\\].,;:\\s@\"]$/i;\n// eslint-disable-next-line\n// const emailRegex =\n//   /^(([^<>()[\\]\\\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@((\\[(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\\])|(\\[IPv6:(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))\\])|([A-Za-z0-9]([A-Za-z0-9-]*[A-Za-z0-9])*(\\.[A-Za-z]{2,})+))$/;\n// const emailRegex =\n//   /^[a-zA-Z0-9\\.\\!\\#\\$\\%\\&\\'\\*\\+\\/\\=\\?\\^\\_\\`\\{\\|\\}\\~\\-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;\n// const emailRegex =\n//   /^(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|\"(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21\\x23-\\x5b\\x5d-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])*\")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21-\\x5a\\x53-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])+)\\])$/i;\nconst emailRegex = /^(?!\\.)(?!.*\\.\\.)([A-Z0-9_+-\\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\\-]*\\.)+[A-Z]{2,}$/i;\n// const emailRegex =\n//   /^[a-z0-9.!#$%&â€™*+/=?^_`{|}~-]+@[a-z0-9-]+(?:\\.[a-z0-9\\-]+)*$/i;\n// from https://thekevinscott.com/emojis-in-javascript/#writing-a-regular-expression\nconst _emojiRegex = `^(\\\\p{Extended_Pictographic}|\\\\p{Emoji_Component})+$`;\nlet emojiRegex;\nconst ipv4Regex = /^(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))$/;\nconst ipv6Regex = /^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/;\n// Adapted from https://stackoverflow.com/a/3143231\nconst datetimeRegex = (args) => {\n    if (args.precision) {\n        if (args.offset) {\n            return new RegExp(`^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}\\\\.\\\\d{${args.precision}}(([+-]\\\\d{2}(:?\\\\d{2})?)|Z)$`);\n        }\n        else {\n            return new RegExp(`^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}\\\\.\\\\d{${args.precision}}Z$`);\n        }\n    }\n    else if (args.precision === 0) {\n        if (args.offset) {\n            return new RegExp(`^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(([+-]\\\\d{2}(:?\\\\d{2})?)|Z)$`);\n        }\n        else {\n            return new RegExp(`^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}Z$`);\n        }\n    }\n    else {\n        if (args.offset) {\n            return new RegExp(`^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(([+-]\\\\d{2}(:?\\\\d{2})?)|Z)$`);\n        }\n        else {\n            return new RegExp(`^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?Z$`);\n        }\n    }\n};\nfunction isValidIP(ip, version) {\n    if ((version === \"v4\" || !version) && ipv4Regex.test(ip)) {\n        return true;\n    }\n    if ((version === \"v6\" || !version) && ipv6Regex.test(ip)) {\n        return true;\n    }\n    return false;\n}\nclass ZodString extends ZodType {\n    _parse(input) {\n        if (this._def.coerce) {\n            input.data = String(input.data);\n        }\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.string) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.string,\n                received: ctx.parsedType,\n            }\n            //\n            );\n            return INVALID;\n        }\n        const status = new ParseStatus();\n        let ctx = undefined;\n        for (const check of this._def.checks) {\n            if (check.kind === \"min\") {\n                if (input.data.length < check.value) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.too_small,\n                        minimum: check.value,\n                        type: \"string\",\n                        inclusive: true,\n                        exact: false,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"max\") {\n                if (input.data.length > check.value) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.too_big,\n                        maximum: check.value,\n                        type: \"string\",\n                        inclusive: true,\n                        exact: false,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"length\") {\n                const tooBig = input.data.length > check.value;\n                const tooSmall = input.data.length < check.value;\n                if (tooBig || tooSmall) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    if (tooBig) {\n                        addIssueToContext(ctx, {\n                            code: ZodIssueCode.too_big,\n                            maximum: check.value,\n                            type: \"string\",\n                            inclusive: true,\n                            exact: true,\n                            message: check.message,\n                        });\n                    }\n                    else if (tooSmall) {\n                        addIssueToContext(ctx, {\n                            code: ZodIssueCode.too_small,\n                            minimum: check.value,\n                            type: \"string\",\n                            inclusive: true,\n                            exact: true,\n                            message: check.message,\n                        });\n                    }\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"email\") {\n                if (!emailRegex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"email\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"emoji\") {\n                if (!emojiRegex) {\n                    emojiRegex = new RegExp(_emojiRegex, \"u\");\n                }\n                if (!emojiRegex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"emoji\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"uuid\") {\n                if (!uuidRegex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"uuid\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"cuid\") {\n                if (!cuidRegex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"cuid\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"cuid2\") {\n                if (!cuid2Regex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"cuid2\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"ulid\") {\n                if (!ulidRegex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"ulid\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"url\") {\n                try {\n                    new URL(input.data);\n                }\n                catch (_a) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"url\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"regex\") {\n                check.regex.lastIndex = 0;\n                const testResult = check.regex.test(input.data);\n                if (!testResult) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"regex\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"trim\") {\n                input.data = input.data.trim();\n            }\n            else if (check.kind === \"includes\") {\n                if (!input.data.includes(check.value, check.position)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.invalid_string,\n                        validation: { includes: check.value, position: check.position },\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"toLowerCase\") {\n                input.data = input.data.toLowerCase();\n            }\n            else if (check.kind === \"toUpperCase\") {\n                input.data = input.data.toUpperCase();\n            }\n            else if (check.kind === \"startsWith\") {\n                if (!input.data.startsWith(check.value)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.invalid_string,\n                        validation: { startsWith: check.value },\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"endsWith\") {\n                if (!input.data.endsWith(check.value)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.invalid_string,\n                        validation: { endsWith: check.value },\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"datetime\") {\n                const regex = datetimeRegex(check);\n                if (!regex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.invalid_string,\n                        validation: \"datetime\",\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"ip\") {\n                if (!isValidIP(input.data, check.version)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"ip\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else {\n                util.assertNever(check);\n            }\n        }\n        return { status: status.value, value: input.data };\n    }\n    _regex(regex, validation, message) {\n        return this.refinement((data) => regex.test(data), {\n            validation,\n            code: ZodIssueCode.invalid_string,\n            ...errorUtil.errToObj(message),\n        });\n    }\n    _addCheck(check) {\n        return new ZodString({\n            ...this._def,\n            checks: [...this._def.checks, check],\n        });\n    }\n    email(message) {\n        return this._addCheck({ kind: \"email\", ...errorUtil.errToObj(message) });\n    }\n    url(message) {\n        return this._addCheck({ kind: \"url\", ...errorUtil.errToObj(message) });\n    }\n    emoji(message) {\n        return this._addCheck({ kind: \"emoji\", ...errorUtil.errToObj(message) });\n    }\n    uuid(message) {\n        return this._addCheck({ kind: \"uuid\", ...errorUtil.errToObj(message) });\n    }\n    cuid(message) {\n        return this._addCheck({ kind: \"cuid\", ...errorUtil.errToObj(message) });\n    }\n    cuid2(message) {\n        return this._addCheck({ kind: \"cuid2\", ...errorUtil.errToObj(message) });\n    }\n    ulid(message) {\n        return this._addCheck({ kind: \"ulid\", ...errorUtil.errToObj(message) });\n    }\n    ip(options) {\n        return this._addCheck({ kind: \"ip\", ...errorUtil.errToObj(options) });\n    }\n    datetime(options) {\n        var _a;\n        if (typeof options === \"string\") {\n            return this._addCheck({\n                kind: \"datetime\",\n                precision: null,\n                offset: false,\n                message: options,\n            });\n        }\n        return this._addCheck({\n            kind: \"datetime\",\n            precision: typeof (options === null || options === void 0 ? void 0 : options.precision) === \"undefined\" ? null : options === null || options === void 0 ? void 0 : options.precision,\n            offset: (_a = options === null || options === void 0 ? void 0 : options.offset) !== null && _a !== void 0 ? _a : false,\n            ...errorUtil.errToObj(options === null || options === void 0 ? void 0 : options.message),\n        });\n    }\n    regex(regex, message) {\n        return this._addCheck({\n            kind: \"regex\",\n            regex: regex,\n            ...errorUtil.errToObj(message),\n        });\n    }\n    includes(value, options) {\n        return this._addCheck({\n            kind: \"includes\",\n            value: value,\n            position: options === null || options === void 0 ? void 0 : options.position,\n            ...errorUtil.errToObj(options === null || options === void 0 ? void 0 : options.message),\n        });\n    }\n    startsWith(value, message) {\n        return this._addCheck({\n            kind: \"startsWith\",\n            value: value,\n            ...errorUtil.errToObj(message),\n        });\n    }\n    endsWith(value, message) {\n        return this._addCheck({\n            kind: \"endsWith\",\n            value: value,\n            ...errorUtil.errToObj(message),\n        });\n    }\n    min(minLength, message) {\n        return this._addCheck({\n            kind: \"min\",\n            value: minLength,\n            ...errorUtil.errToObj(message),\n        });\n    }\n    max(maxLength, message) {\n        return this._addCheck({\n            kind: \"max\",\n            value: maxLength,\n            ...errorUtil.errToObj(message),\n        });\n    }\n    length(len, message) {\n        return this._addCheck({\n            kind: \"length\",\n            value: len,\n            ...errorUtil.errToObj(message),\n        });\n    }\n    /**\n     * @deprecated Use z.string().min(1) instead.\n     * @see {@link ZodString.min}\n     */\n    nonempty(message) {\n        return this.min(1, errorUtil.errToObj(message));\n    }\n    trim() {\n        return new ZodString({\n            ...this._def,\n            checks: [...this._def.checks, { kind: \"trim\" }],\n        });\n    }\n    toLowerCase() {\n        return new ZodString({\n            ...this._def,\n            checks: [...this._def.checks, { kind: \"toLowerCase\" }],\n        });\n    }\n    toUpperCase() {\n        return new ZodString({\n            ...this._def,\n            checks: [...this._def.checks, { kind: \"toUpperCase\" }],\n        });\n    }\n    get isDatetime() {\n        return !!this._def.checks.find((ch) => ch.kind === \"datetime\");\n    }\n    get isEmail() {\n        return !!this._def.checks.find((ch) => ch.kind === \"email\");\n    }\n    get isURL() {\n        return !!this._def.checks.find((ch) => ch.kind === \"url\");\n    }\n    get isEmoji() {\n        return !!this._def.checks.find((ch) => ch.kind === \"emoji\");\n    }\n    get isUUID() {\n        return !!this._def.checks.find((ch) => ch.kind === \"uuid\");\n    }\n    get isCUID() {\n        return !!this._def.checks.find((ch) => ch.kind === \"cuid\");\n    }\n    get isCUID2() {\n        return !!this._def.checks.find((ch) => ch.kind === \"cuid2\");\n    }\n    get isULID() {\n        return !!this._def.checks.find((ch) => ch.kind === \"ulid\");\n    }\n    get isIP() {\n        return !!this._def.checks.find((ch) => ch.kind === \"ip\");\n    }\n    get minLength() {\n        let min = null;\n        for (const ch of this._def.checks) {\n            if (ch.kind === \"min\") {\n                if (min === null || ch.value > min)\n                    min = ch.value;\n            }\n        }\n        return min;\n    }\n    get maxLength() {\n        let max = null;\n        for (const ch of this._def.checks) {\n            if (ch.kind === \"max\") {\n                if (max === null || ch.value < max)\n                    max = ch.value;\n            }\n        }\n        return max;\n    }\n}\nZodString.create = (params) => {\n    var _a;\n    return new ZodString({\n        checks: [],\n        typeName: ZodFirstPartyTypeKind.ZodString,\n        coerce: (_a = params === null || params === void 0 ? void 0 : params.coerce) !== null && _a !== void 0 ? _a : false,\n        ...processCreateParams(params),\n    });\n};\n// https://stackoverflow.com/questions/3966484/why-does-modulus-operator-return-fractional-number-in-javascript/31711034#31711034\nfunction floatSafeRemainder(val, step) {\n    const valDecCount = (val.toString().split(\".\")[1] || \"\").length;\n    const stepDecCount = (step.toString().split(\".\")[1] || \"\").length;\n    const decCount = valDecCount > stepDecCount ? valDecCount : stepDecCount;\n    const valInt = parseInt(val.toFixed(decCount).replace(\".\", \"\"));\n    const stepInt = parseInt(step.toFixed(decCount).replace(\".\", \"\"));\n    return (valInt % stepInt) / Math.pow(10, decCount);\n}\nclass ZodNumber extends ZodType {\n    constructor() {\n        super(...arguments);\n        this.min = this.gte;\n        this.max = this.lte;\n        this.step = this.multipleOf;\n    }\n    _parse(input) {\n        if (this._def.coerce) {\n            input.data = Number(input.data);\n        }\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.number) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.number,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        let ctx = undefined;\n        const status = new ParseStatus();\n        for (const check of this._def.checks) {\n            if (check.kind === \"int\") {\n                if (!util.isInteger(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.invalid_type,\n                        expected: \"integer\",\n                        received: \"float\",\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"min\") {\n                const tooSmall = check.inclusive\n                    ? input.data < check.value\n                    : input.data <= check.value;\n                if (tooSmall) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.too_small,\n                        minimum: check.value,\n                        type: \"number\",\n                        inclusive: check.inclusive,\n                        exact: false,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"max\") {\n                const tooBig = check.inclusive\n                    ? input.data > check.value\n                    : input.data >= check.value;\n                if (tooBig) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.too_big,\n                        maximum: check.value,\n                        type: \"number\",\n                        inclusive: check.inclusive,\n                        exact: false,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"multipleOf\") {\n                if (floatSafeRemainder(input.data, check.value) !== 0) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.not_multiple_of,\n                        multipleOf: check.value,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"finite\") {\n                if (!Number.isFinite(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.not_finite,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else {\n                util.assertNever(check);\n            }\n        }\n        return { status: status.value, value: input.data };\n    }\n    gte(value, message) {\n        return this.setLimit(\"min\", value, true, errorUtil.toString(message));\n    }\n    gt(value, message) {\n        return this.setLimit(\"min\", value, false, errorUtil.toString(message));\n    }\n    lte(value, message) {\n        return this.setLimit(\"max\", value, true, errorUtil.toString(message));\n    }\n    lt(value, message) {\n        return this.setLimit(\"max\", value, false, errorUtil.toString(message));\n    }\n    setLimit(kind, value, inclusive, message) {\n        return new ZodNumber({\n            ...this._def,\n            checks: [\n                ...this._def.checks,\n                {\n                    kind,\n                    value,\n                    inclusive,\n                    message: errorUtil.toString(message),\n                },\n            ],\n        });\n    }\n    _addCheck(check) {\n        return new ZodNumber({\n            ...this._def,\n            checks: [...this._def.checks, check],\n        });\n    }\n    int(message) {\n        return this._addCheck({\n            kind: \"int\",\n            message: errorUtil.toString(message),\n        });\n    }\n    positive(message) {\n        return this._addCheck({\n            kind: \"min\",\n            value: 0,\n            inclusive: false,\n            message: errorUtil.toString(message),\n        });\n    }\n    negative(message) {\n        return this._addCheck({\n            kind: \"max\",\n            value: 0,\n            inclusive: false,\n            message: errorUtil.toString(message),\n        });\n    }\n    nonpositive(message) {\n        return this._addCheck({\n            kind: \"max\",\n            value: 0,\n            inclusive: true,\n            message: errorUtil.toString(message),\n        });\n    }\n    nonnegative(message) {\n        return this._addCheck({\n            kind: \"min\",\n            value: 0,\n            inclusive: true,\n            message: errorUtil.toString(message),\n        });\n    }\n    multipleOf(value, message) {\n        return this._addCheck({\n            kind: \"multipleOf\",\n            value: value,\n            message: errorUtil.toString(message),\n        });\n    }\n    finite(message) {\n        return this._addCheck({\n            kind: \"finite\",\n            message: errorUtil.toString(message),\n        });\n    }\n    safe(message) {\n        return this._addCheck({\n            kind: \"min\",\n            inclusive: true,\n            value: Number.MIN_SAFE_INTEGER,\n            message: errorUtil.toString(message),\n        })._addCheck({\n            kind: \"max\",\n            inclusive: true,\n            value: Number.MAX_SAFE_INTEGER,\n            message: errorUtil.toString(message),\n        });\n    }\n    get minValue() {\n        let min = null;\n        for (const ch of this._def.checks) {\n            if (ch.kind === \"min\") {\n                if (min === null || ch.value > min)\n                    min = ch.value;\n            }\n        }\n        return min;\n    }\n    get maxValue() {\n        let max = null;\n        for (const ch of this._def.checks) {\n            if (ch.kind === \"max\") {\n                if (max === null || ch.value < max)\n                    max = ch.value;\n            }\n        }\n        return max;\n    }\n    get isInt() {\n        return !!this._def.checks.find((ch) => ch.kind === \"int\" ||\n            (ch.kind === \"multipleOf\" && util.isInteger(ch.value)));\n    }\n    get isFinite() {\n        let max = null, min = null;\n        for (const ch of this._def.checks) {\n            if (ch.kind === \"finite\" ||\n                ch.kind === \"int\" ||\n                ch.kind === \"multipleOf\") {\n                return true;\n            }\n            else if (ch.kind === \"min\") {\n                if (min === null || ch.value > min)\n                    min = ch.value;\n            }\n            else if (ch.kind === \"max\") {\n                if (max === null || ch.value < max)\n                    max = ch.value;\n            }\n        }\n        return Number.isFinite(min) && Number.isFinite(max);\n    }\n}\nZodNumber.create = (params) => {\n    return new ZodNumber({\n        checks: [],\n        typeName: ZodFirstPartyTypeKind.ZodNumber,\n        coerce: (params === null || params === void 0 ? void 0 : params.coerce) || false,\n        ...processCreateParams(params),\n    });\n};\nclass ZodBigInt extends ZodType {\n    constructor() {\n        super(...arguments);\n        this.min = this.gte;\n        this.max = this.lte;\n    }\n    _parse(input) {\n        if (this._def.coerce) {\n            input.data = BigInt(input.data);\n        }\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.bigint) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.bigint,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        let ctx = undefined;\n        const status = new ParseStatus();\n        for (const check of this._def.checks) {\n            if (check.kind === \"min\") {\n                const tooSmall = check.inclusive\n                    ? input.data < check.value\n                    : input.data <= check.value;\n                if (tooSmall) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.too_small,\n                        type: \"bigint\",\n                        minimum: check.value,\n                        inclusive: check.inclusive,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"max\") {\n                const tooBig = check.inclusive\n                    ? input.data > check.value\n                    : input.data >= check.value;\n                if (tooBig) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.too_big,\n                        type: \"bigint\",\n                        maximum: check.value,\n                        inclusive: check.inclusive,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"multipleOf\") {\n                if (input.data % check.value !== BigInt(0)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.not_multiple_of,\n                        multipleOf: check.value,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else {\n                util.assertNever(check);\n            }\n        }\n        return { status: status.value, value: input.data };\n    }\n    gte(value, message) {\n        return this.setLimit(\"min\", value, true, errorUtil.toString(message));\n    }\n    gt(value, message) {\n        return this.setLimit(\"min\", value, false, errorUtil.toString(message));\n    }\n    lte(value, message) {\n        return this.setLimit(\"max\", value, true, errorUtil.toString(message));\n    }\n    lt(value, message) {\n        return this.setLimit(\"max\", value, false, errorUtil.toString(message));\n    }\n    setLimit(kind, value, inclusive, message) {\n        return new ZodBigInt({\n            ...this._def,\n            checks: [\n                ...this._def.checks,\n                {\n                    kind,\n                    value,\n                    inclusive,\n                    message: errorUtil.toString(message),\n                },\n            ],\n        });\n    }\n    _addCheck(check) {\n        return new ZodBigInt({\n            ...this._def,\n            checks: [...this._def.checks, check],\n        });\n    }\n    positive(message) {\n        return this._addCheck({\n            kind: \"min\",\n            value: BigInt(0),\n            inclusive: false,\n            message: errorUtil.toString(message),\n        });\n    }\n    negative(message) {\n        return this._addCheck({\n            kind: \"max\",\n            value: BigInt(0),\n            inclusive: false,\n            message: errorUtil.toString(message),\n        });\n    }\n    nonpositive(message) {\n        return this._addCheck({\n            kind: \"max\",\n            value: BigInt(0),\n            inclusive: true,\n            message: errorUtil.toString(message),\n        });\n    }\n    nonnegative(message) {\n        return this._addCheck({\n            kind: \"min\",\n            value: BigInt(0),\n            inclusive: true,\n            message: errorUtil.toString(message),\n        });\n    }\n    multipleOf(value, message) {\n        return this._addCheck({\n            kind: \"multipleOf\",\n            value,\n            message: errorUtil.toString(message),\n        });\n    }\n    get minValue() {\n        let min = null;\n        for (const ch of this._def.checks) {\n            if (ch.kind === \"min\") {\n                if (min === null || ch.value > min)\n                    min = ch.value;\n            }\n        }\n        return min;\n    }\n    get maxValue() {\n        let max = null;\n        for (const ch of this._def.checks) {\n            if (ch.kind === \"max\") {\n                if (max === null || ch.value < max)\n                    max = ch.value;\n            }\n        }\n        return max;\n    }\n}\nZodBigInt.create = (params) => {\n    var _a;\n    return new ZodBigInt({\n        checks: [],\n        typeName: ZodFirstPartyTypeKind.ZodBigInt,\n        coerce: (_a = params === null || params === void 0 ? void 0 : params.coerce) !== null && _a !== void 0 ? _a : false,\n        ...processCreateParams(params),\n    });\n};\nclass ZodBoolean extends ZodType {\n    _parse(input) {\n        if (this._def.coerce) {\n            input.data = Boolean(input.data);\n        }\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.boolean) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.boolean,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        return OK(input.data);\n    }\n}\nZodBoolean.create = (params) => {\n    return new ZodBoolean({\n        typeName: ZodFirstPartyTypeKind.ZodBoolean,\n        coerce: (params === null || params === void 0 ? void 0 : params.coerce) || false,\n        ...processCreateParams(params),\n    });\n};\nclass ZodDate extends ZodType {\n    _parse(input) {\n        if (this._def.coerce) {\n            input.data = new Date(input.data);\n        }\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.date) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.date,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        if (isNaN(input.data.getTime())) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_date,\n            });\n            return INVALID;\n        }\n        const status = new ParseStatus();\n        let ctx = undefined;\n        for (const check of this._def.checks) {\n            if (check.kind === \"min\") {\n                if (input.data.getTime() < check.value) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.too_small,\n                        message: check.message,\n                        inclusive: true,\n                        exact: false,\n                        minimum: check.value,\n                        type: \"date\",\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"max\") {\n                if (input.data.getTime() > check.value) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.too_big,\n                        message: check.message,\n                        inclusive: true,\n                        exact: false,\n                        maximum: check.value,\n                        type: \"date\",\n                    });\n                    status.dirty();\n                }\n            }\n            else {\n                util.assertNever(check);\n            }\n        }\n        return {\n            status: status.value,\n            value: new Date(input.data.getTime()),\n        };\n    }\n    _addCheck(check) {\n        return new ZodDate({\n            ...this._def,\n            checks: [...this._def.checks, check],\n        });\n    }\n    min(minDate, message) {\n        return this._addCheck({\n            kind: \"min\",\n            value: minDate.getTime(),\n            message: errorUtil.toString(message),\n        });\n    }\n    max(maxDate, message) {\n        return this._addCheck({\n            kind: \"max\",\n            value: maxDate.getTime(),\n            message: errorUtil.toString(message),\n        });\n    }\n    get minDate() {\n        let min = null;\n        for (const ch of this._def.checks) {\n            if (ch.kind === \"min\") {\n                if (min === null || ch.value > min)\n                    min = ch.value;\n            }\n        }\n        return min != null ? new Date(min) : null;\n    }\n    get maxDate() {\n        let max = null;\n        for (const ch of this._def.checks) {\n            if (ch.kind === \"max\") {\n                if (max === null || ch.value < max)\n                    max = ch.value;\n            }\n        }\n        return max != null ? new Date(max) : null;\n    }\n}\nZodDate.create = (params) => {\n    return new ZodDate({\n        checks: [],\n        coerce: (params === null || params === void 0 ? void 0 : params.coerce) || false,\n        typeName: ZodFirstPartyTypeKind.ZodDate,\n        ...processCreateParams(params),\n    });\n};\nclass ZodSymbol extends ZodType {\n    _parse(input) {\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.symbol) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.symbol,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        return OK(input.data);\n    }\n}\nZodSymbol.create = (params) => {\n    return new ZodSymbol({\n        typeName: ZodFirstPartyTypeKind.ZodSymbol,\n        ...processCreateParams(params),\n    });\n};\nclass ZodUndefined extends ZodType {\n    _parse(input) {\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.undefined) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.undefined,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        return OK(input.data);\n    }\n}\nZodUndefined.create = (params) => {\n    return new ZodUndefined({\n        typeName: ZodFirstPartyTypeKind.ZodUndefined,\n        ...processCreateParams(params),\n    });\n};\nclass ZodNull extends ZodType {\n    _parse(input) {\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.null) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.null,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        return OK(input.data);\n    }\n}\nZodNull.create = (params) => {\n    return new ZodNull({\n        typeName: ZodFirstPartyTypeKind.ZodNull,\n        ...processCreateParams(params),\n    });\n};\nclass ZodAny extends ZodType {\n    constructor() {\n        super(...arguments);\n        // to prevent instances of other classes from extending ZodAny. this causes issues with catchall in ZodObject.\n        this._any = true;\n    }\n    _parse(input) {\n        return OK(input.data);\n    }\n}\nZodAny.create = (params) => {\n    return new ZodAny({\n        typeName: ZodFirstPartyTypeKind.ZodAny,\n        ...processCreateParams(params),\n    });\n};\nclass ZodUnknown extends ZodType {\n    constructor() {\n        super(...arguments);\n        // required\n        this._unknown = true;\n    }\n    _parse(input) {\n        return OK(input.data);\n    }\n}\nZodUnknown.create = (params) => {\n    return new ZodUnknown({\n        typeName: ZodFirstPartyTypeKind.ZodUnknown,\n        ...processCreateParams(params),\n    });\n};\nclass ZodNever extends ZodType {\n    _parse(input) {\n        const ctx = this._getOrReturnCtx(input);\n        addIssueToContext(ctx, {\n            code: ZodIssueCode.invalid_type,\n            expected: ZodParsedType.never,\n            received: ctx.parsedType,\n        });\n        return INVALID;\n    }\n}\nZodNever.create = (params) => {\n    return new ZodNever({\n        typeName: ZodFirstPartyTypeKind.ZodNever,\n        ...processCreateParams(params),\n    });\n};\nclass ZodVoid extends ZodType {\n    _parse(input) {\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.undefined) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.void,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        return OK(input.data);\n    }\n}\nZodVoid.create = (params) => {\n    return new ZodVoid({\n        typeName: ZodFirstPartyTypeKind.ZodVoid,\n        ...processCreateParams(params),\n    });\n};\nclass ZodArray extends ZodType {\n    _parse(input) {\n        const { ctx, status } = this._processInputParams(input);\n        const def = this._def;\n        if (ctx.parsedType !== ZodParsedType.array) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.array,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        if (def.exactLength !== null) {\n            const tooBig = ctx.data.length > def.exactLength.value;\n            const tooSmall = ctx.data.length < def.exactLength.value;\n            if (tooBig || tooSmall) {\n                addIssueToContext(ctx, {\n                    code: tooBig ? ZodIssueCode.too_big : ZodIssueCode.too_small,\n                    minimum: (tooSmall ? def.exactLength.value : undefined),\n                    maximum: (tooBig ? def.exactLength.value : undefined),\n                    type: \"array\",\n                    inclusive: true,\n                    exact: true,\n                    message: def.exactLength.message,\n                });\n                status.dirty();\n            }\n        }\n        if (def.minLength !== null) {\n            if (ctx.data.length < def.minLength.value) {\n                addIssueToContext(ctx, {\n                    code: ZodIssueCode.too_small,\n                    minimum: def.minLength.value,\n                    type: \"array\",\n                    inclusive: true,\n                    exact: false,\n                    message: def.minLength.message,\n                });\n                status.dirty();\n            }\n        }\n        if (def.maxLength !== null) {\n            if (ctx.data.length > def.maxLength.value) {\n                addIssueToContext(ctx, {\n                    code: ZodIssueCode.too_big,\n                    maximum: def.maxLength.value,\n                    type: \"array\",\n                    inclusive: true,\n                    exact: false,\n                    message: def.maxLength.message,\n                });\n                status.dirty();\n            }\n        }\n        if (ctx.common.async) {\n            return Promise.all([...ctx.data].map((item, i) => {\n                return def.type._parseAsync(new ParseInputLazyPath(ctx, item, ctx.path, i));\n            })).then((result) => {\n                return ParseStatus.mergeArray(status, result);\n            });\n        }\n        const result = [...ctx.data].map((item, i) => {\n            return def.type._parseSync(new ParseInputLazyPath(ctx, item, ctx.path, i));\n        });\n        return ParseStatus.mergeArray(status, result);\n    }\n    get element() {\n        return this._def.type;\n    }\n    min(minLength, message) {\n        return new ZodArray({\n            ...this._def,\n            minLength: { value: minLength, message: errorUtil.toString(message) },\n        });\n    }\n    max(maxLength, message) {\n        return new ZodArray({\n            ...this._def,\n            maxLength: { value: maxLength, message: errorUtil.toString(message) },\n        });\n    }\n    length(len, message) {\n        return new ZodArray({\n            ...this._def,\n            exactLength: { value: len, message: errorUtil.toString(message) },\n        });\n    }\n    nonempty(message) {\n        return this.min(1, message);\n    }\n}\nZodArray.create = (schema, params) => {\n    return new ZodArray({\n        type: schema,\n        minLength: null,\n        maxLength: null,\n        exactLength: null,\n        typeName: ZodFirstPartyTypeKind.ZodArray,\n        ...processCreateParams(params),\n    });\n};\nfunction deepPartialify(schema) {\n    if (schema instanceof ZodObject) {\n        const newShape = {};\n        for (const key in schema.shape) {\n            const fieldSchema = schema.shape[key];\n            newShape[key] = ZodOptional.create(deepPartialify(fieldSchema));\n        }\n        return new ZodObject({\n            ...schema._def,\n            shape: () => newShape,\n        });\n    }\n    else if (schema instanceof ZodArray) {\n        return new ZodArray({\n            ...schema._def,\n            type: deepPartialify(schema.element),\n        });\n    }\n    else if (schema instanceof ZodOptional) {\n        return ZodOptional.create(deepPartialify(schema.unwrap()));\n    }\n    else if (schema instanceof ZodNullable) {\n        return ZodNullable.create(deepPartialify(schema.unwrap()));\n    }\n    else if (schema instanceof ZodTuple) {\n        return ZodTuple.create(schema.items.map((item) => deepPartialify(item)));\n    }\n    else {\n        return schema;\n    }\n}\nclass ZodObject extends ZodType {\n    constructor() {\n        super(...arguments);\n        this._cached = null;\n        /**\n         * @deprecated In most cases, this is no longer needed - unknown properties are now silently stripped.\n         * If you want to pass through unknown properties, use `.passthrough()` instead.\n         */\n        this.nonstrict = this.passthrough;\n        // extend<\n        //   Augmentation extends ZodRawShape,\n        //   NewOutput extends util.flatten<{\n        //     [k in keyof Augmentation | keyof Output]: k extends keyof Augmentation\n        //       ? Augmentation[k][\"_output\"]\n        //       : k extends keyof Output\n        //       ? Output[k]\n        //       : never;\n        //   }>,\n        //   NewInput extends util.flatten<{\n        //     [k in keyof Augmentation | keyof Input]: k extends keyof Augmentation\n        //       ? Augmentation[k][\"_input\"]\n        //       : k extends keyof Input\n        //       ? Input[k]\n        //       : never;\n        //   }>\n        // >(\n        //   augmentation: Augmentation\n        // ): ZodObject<\n        //   extendShape<T, Augmentation>,\n        //   UnknownKeys,\n        //   Catchall,\n        //   NewOutput,\n        //   NewInput\n        // > {\n        //   return new ZodObject({\n        //     ...this._def,\n        //     shape: () => ({\n        //       ...this._def.shape(),\n        //       ...augmentation,\n        //     }),\n        //   }) as any;\n        // }\n        /**\n         * @deprecated Use `.extend` instead\n         *  */\n        this.augment = this.extend;\n    }\n    _getCached() {\n        if (this._cached !== null)\n            return this._cached;\n        const shape = this._def.shape();\n        const keys = util.objectKeys(shape);\n        return (this._cached = { shape, keys });\n    }\n    _parse(input) {\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.object) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.object,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        const { status, ctx } = this._processInputParams(input);\n        const { shape, keys: shapeKeys } = this._getCached();\n        const extraKeys = [];\n        if (!(this._def.catchall instanceof ZodNever &&\n            this._def.unknownKeys === \"strip\")) {\n            for (const key in ctx.data) {\n                if (!shapeKeys.includes(key)) {\n                    extraKeys.push(key);\n                }\n            }\n        }\n        const pairs = [];\n        for (const key of shapeKeys) {\n            const keyValidator = shape[key];\n            const value = ctx.data[key];\n            pairs.push({\n                key: { status: \"valid\", value: key },\n                value: keyValidator._parse(new ParseInputLazyPath(ctx, value, ctx.path, key)),\n                alwaysSet: key in ctx.data,\n            });\n        }\n        if (this._def.catchall instanceof ZodNever) {\n            const unknownKeys = this._def.unknownKeys;\n            if (unknownKeys === \"passthrough\") {\n                for (const key of extraKeys) {\n                    pairs.push({\n                        key: { status: \"valid\", value: key },\n                        value: { status: \"valid\", value: ctx.data[key] },\n                    });\n                }\n            }\n            else if (unknownKeys === \"strict\") {\n                if (extraKeys.length > 0) {\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.unrecognized_keys,\n                        keys: extraKeys,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (unknownKeys === \"strip\") ;\n            else {\n                throw new Error(`Internal ZodObject error: invalid unknownKeys value.`);\n            }\n        }\n        else {\n            // run catchall validation\n            const catchall = this._def.catchall;\n            for (const key of extraKeys) {\n                const value = ctx.data[key];\n                pairs.push({\n                    key: { status: \"valid\", value: key },\n                    value: catchall._parse(new ParseInputLazyPath(ctx, value, ctx.path, key) //, ctx.child(key), value, getParsedType(value)\n                    ),\n                    alwaysSet: key in ctx.data,\n                });\n            }\n        }\n        if (ctx.common.async) {\n            return Promise.resolve()\n                .then(async () => {\n                const syncPairs = [];\n                for (const pair of pairs) {\n                    const key = await pair.key;\n                    syncPairs.push({\n                        key,\n                        value: await pair.value,\n                        alwaysSet: pair.alwaysSet,\n                    });\n                }\n                return syncPairs;\n            })\n                .then((syncPairs) => {\n                return ParseStatus.mergeObjectSync(status, syncPairs);\n            });\n        }\n        else {\n            return ParseStatus.mergeObjectSync(status, pairs);\n        }\n    }\n    get shape() {\n        return this._def.shape();\n    }\n    strict(message) {\n        errorUtil.errToObj;\n        return new ZodObject({\n            ...this._def,\n            unknownKeys: \"strict\",\n            ...(message !== undefined\n                ? {\n                    errorMap: (issue, ctx) => {\n                        var _a, _b, _c, _d;\n                        const defaultError = (_c = (_b = (_a = this._def).errorMap) === null || _b === void 0 ? void 0 : _b.call(_a, issue, ctx).message) !== null && _c !== void 0 ? _c : ctx.defaultError;\n                        if (issue.code === \"unrecognized_keys\")\n                            return {\n                                message: (_d = errorUtil.errToObj(message).message) !== null && _d !== void 0 ? _d : defaultError,\n                            };\n                        return {\n                            message: defaultError,\n                        };\n                    },\n                }\n                : {}),\n        });\n    }\n    strip() {\n        return new ZodObject({\n            ...this._def,\n            unknownKeys: \"strip\",\n        });\n    }\n    passthrough() {\n        return new ZodObject({\n            ...this._def,\n            unknownKeys: \"passthrough\",\n        });\n    }\n    // const AugmentFactory =\n    //   <Def extends ZodObjectDef>(def: Def) =>\n    //   <Augmentation extends ZodRawShape>(\n    //     augmentation: Augmentation\n    //   ): ZodObject<\n    //     extendShape<ReturnType<Def[\"shape\"]>, Augmentation>,\n    //     Def[\"unknownKeys\"],\n    //     Def[\"catchall\"]\n    //   > => {\n    //     return new ZodObject({\n    //       ...def,\n    //       shape: () => ({\n    //         ...def.shape(),\n    //         ...augmentation,\n    //       }),\n    //     }) as any;\n    //   };\n    extend(augmentation) {\n        return new ZodObject({\n            ...this._def,\n            shape: () => ({\n                ...this._def.shape(),\n                ...augmentation,\n            }),\n        });\n    }\n    /**\n     * Prior to zod@1.0.12 there was a bug in the\n     * inferred type of merged objects. Please\n     * upgrade if you are experiencing issues.\n     */\n    merge(merging) {\n        const merged = new ZodObject({\n            unknownKeys: merging._def.unknownKeys,\n            catchall: merging._def.catchall,\n            shape: () => ({\n                ...this._def.shape(),\n                ...merging._def.shape(),\n            }),\n            typeName: ZodFirstPartyTypeKind.ZodObject,\n        });\n        return merged;\n    }\n    // merge<\n    //   Incoming extends AnyZodObject,\n    //   Augmentation extends Incoming[\"shape\"],\n    //   NewOutput extends {\n    //     [k in keyof Augmentation | keyof Output]: k extends keyof Augmentation\n    //       ? Augmentation[k][\"_output\"]\n    //       : k extends keyof Output\n    //       ? Output[k]\n    //       : never;\n    //   },\n    //   NewInput extends {\n    //     [k in keyof Augmentation | keyof Input]: k extends keyof Augmentation\n    //       ? Augmentation[k][\"_input\"]\n    //       : k extends keyof Input\n    //       ? Input[k]\n    //       : never;\n    //   }\n    // >(\n    //   merging: Incoming\n    // ): ZodObject<\n    //   extendShape<T, ReturnType<Incoming[\"_def\"][\"shape\"]>>,\n    //   Incoming[\"_def\"][\"unknownKeys\"],\n    //   Incoming[\"_def\"][\"catchall\"],\n    //   NewOutput,\n    //   NewInput\n    // > {\n    //   const merged: any = new ZodObject({\n    //     unknownKeys: merging._def.unknownKeys,\n    //     catchall: merging._def.catchall,\n    //     shape: () =>\n    //       objectUtil.mergeShapes(this._def.shape(), merging._def.shape()),\n    //     typeName: ZodFirstPartyTypeKind.ZodObject,\n    //   }) as any;\n    //   return merged;\n    // }\n    setKey(key, schema) {\n        return this.augment({ [key]: schema });\n    }\n    // merge<Incoming extends AnyZodObject>(\n    //   merging: Incoming\n    // ): //ZodObject<T & Incoming[\"_shape\"], UnknownKeys, Catchall> = (merging) => {\n    // ZodObject<\n    //   extendShape<T, ReturnType<Incoming[\"_def\"][\"shape\"]>>,\n    //   Incoming[\"_def\"][\"unknownKeys\"],\n    //   Incoming[\"_def\"][\"catchall\"]\n    // > {\n    //   // const mergedShape = objectUtil.mergeShapes(\n    //   //   this._def.shape(),\n    //   //   merging._def.shape()\n    //   // );\n    //   const merged: any = new ZodObject({\n    //     unknownKeys: merging._def.unknownKeys,\n    //     catchall: merging._def.catchall,\n    //     shape: () =>\n    //       objectUtil.mergeShapes(this._def.shape(), merging._def.shape()),\n    //     typeName: ZodFirstPartyTypeKind.ZodObject,\n    //   }) as any;\n    //   return merged;\n    // }\n    catchall(index) {\n        return new ZodObject({\n            ...this._def,\n            catchall: index,\n        });\n    }\n    pick(mask) {\n        const shape = {};\n        util.objectKeys(mask).forEach((key) => {\n            if (mask[key] && this.shape[key]) {\n                shape[key] = this.shape[key];\n            }\n        });\n        return new ZodObject({\n            ...this._def,\n            shape: () => shape,\n        });\n    }\n    omit(mask) {\n        const shape = {};\n        util.objectKeys(this.shape).forEach((key) => {\n            if (!mask[key]) {\n                shape[key] = this.shape[key];\n            }\n        });\n        return new ZodObject({\n            ...this._def,\n            shape: () => shape,\n        });\n    }\n    /**\n     * @deprecated\n     */\n    deepPartial() {\n        return deepPartialify(this);\n    }\n    partial(mask) {\n        const newShape = {};\n        util.objectKeys(this.shape).forEach((key) => {\n            const fieldSchema = this.shape[key];\n            if (mask && !mask[key]) {\n                newShape[key] = fieldSchema;\n            }\n            else {\n                newShape[key] = fieldSchema.optional();\n            }\n        });\n        return new ZodObject({\n            ...this._def,\n            shape: () => newShape,\n        });\n    }\n    required(mask) {\n        const newShape = {};\n        util.objectKeys(this.shape).forEach((key) => {\n            if (mask && !mask[key]) {\n                newShape[key] = this.shape[key];\n            }\n            else {\n                const fieldSchema = this.shape[key];\n                let newField = fieldSchema;\n                while (newField instanceof ZodOptional) {\n                    newField = newField._def.innerType;\n                }\n                newShape[key] = newField;\n            }\n        });\n        return new ZodObject({\n            ...this._def,\n            shape: () => newShape,\n        });\n    }\n    keyof() {\n        return createZodEnum(util.objectKeys(this.shape));\n    }\n}\nZodObject.create = (shape, params) => {\n    return new ZodObject({\n        shape: () => shape,\n        unknownKeys: \"strip\",\n        catchall: ZodNever.create(),\n        typeName: ZodFirstPartyTypeKind.ZodObject,\n        ...processCreateParams(params),\n    });\n};\nZodObject.strictCreate = (shape, params) => {\n    return new ZodObject({\n        shape: () => shape,\n        unknownKeys: \"strict\",\n        catchall: ZodNever.create(),\n        typeName: ZodFirstPartyTypeKind.ZodObject,\n        ...processCreateParams(params),\n    });\n};\nZodObject.lazycreate = (shape, params) => {\n    return new ZodObject({\n        shape,\n        unknownKeys: \"strip\",\n        catchall: ZodNever.create(),\n        typeName: ZodFirstPartyTypeKind.ZodObject,\n        ...processCreateParams(params),\n    });\n};\nclass ZodUnion extends ZodType {\n    _parse(input) {\n        const { ctx } = this._processInputParams(input);\n        const options = this._def.options;\n        function handleResults(results) {\n            // return first issue-free validation if it exists\n            for (const result of results) {\n                if (result.result.status === \"valid\") {\n                    return result.result;\n                }\n            }\n            for (const result of results) {\n                if (result.result.status === \"dirty\") {\n                    // add issues from dirty option\n                    ctx.common.issues.push(...result.ctx.common.issues);\n                    return result.result;\n                }\n            }\n            // return invalid\n            const unionErrors = results.map((result) => new ZodError(result.ctx.common.issues));\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_union,\n                unionErrors,\n            });\n            return INVALID;\n        }\n        if (ctx.common.async) {\n            return Promise.all(options.map(async (option) => {\n                const childCtx = {\n                    ...ctx,\n                    common: {\n                        ...ctx.common,\n                        issues: [],\n                    },\n                    parent: null,\n                };\n                return {\n                    result: await option._parseAsync({\n                        data: ctx.data,\n                        path: ctx.path,\n                        parent: childCtx,\n                    }),\n                    ctx: childCtx,\n                };\n            })).then(handleResults);\n        }\n        else {\n            let dirty = undefined;\n            const issues = [];\n            for (const option of options) {\n                const childCtx = {\n                    ...ctx,\n                    common: {\n                        ...ctx.common,\n                        issues: [],\n                    },\n                    parent: null,\n                };\n                const result = option._parseSync({\n                    data: ctx.data,\n                    path: ctx.path,\n                    parent: childCtx,\n                });\n                if (result.status === \"valid\") {\n                    return result;\n                }\n                else if (result.status === \"dirty\" && !dirty) {\n                    dirty = { result, ctx: childCtx };\n                }\n                if (childCtx.common.issues.length) {\n                    issues.push(childCtx.common.issues);\n                }\n            }\n            if (dirty) {\n                ctx.common.issues.push(...dirty.ctx.common.issues);\n                return dirty.result;\n            }\n            const unionErrors = issues.map((issues) => new ZodError(issues));\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_union,\n                unionErrors,\n            });\n            return INVALID;\n        }\n    }\n    get options() {\n        return this._def.options;\n    }\n}\nZodUnion.create = (types, params) => {\n    return new ZodUnion({\n        options: types,\n        typeName: ZodFirstPartyTypeKind.ZodUnion,\n        ...processCreateParams(params),\n    });\n};\n/////////////////////////////////////////////////////\n/////////////////////////////////////////////////////\n//////////                                 //////////\n//////////      ZodDiscriminatedUnion      //////////\n//////////                                 //////////\n/////////////////////////////////////////////////////\n/////////////////////////////////////////////////////\nconst getDiscriminator = (type) => {\n    if (type instanceof ZodLazy) {\n        return getDiscriminator(type.schema);\n    }\n    else if (type instanceof ZodEffects) {\n        return getDiscriminator(type.innerType());\n    }\n    else if (type instanceof ZodLiteral) {\n        return [type.value];\n    }\n    else if (type instanceof ZodEnum) {\n        return type.options;\n    }\n    else if (type instanceof ZodNativeEnum) {\n        // eslint-disable-next-line ban/ban\n        return Object.keys(type.enum);\n    }\n    else if (type instanceof ZodDefault) {\n        return getDiscriminator(type._def.innerType);\n    }\n    else if (type instanceof ZodUndefined) {\n        return [undefined];\n    }\n    else if (type instanceof ZodNull) {\n        return [null];\n    }\n    else {\n        return null;\n    }\n};\nclass ZodDiscriminatedUnion extends ZodType {\n    _parse(input) {\n        const { ctx } = this._processInputParams(input);\n        if (ctx.parsedType !== ZodParsedType.object) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.object,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        const discriminator = this.discriminator;\n        const discriminatorValue = ctx.data[discriminator];\n        const option = this.optionsMap.get(discriminatorValue);\n        if (!option) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_union_discriminator,\n                options: Array.from(this.optionsMap.keys()),\n                path: [discriminator],\n            });\n            return INVALID;\n        }\n        if (ctx.common.async) {\n            return option._parseAsync({\n                data: ctx.data,\n                path: ctx.path,\n                parent: ctx,\n            });\n        }\n        else {\n            return option._parseSync({\n                data: ctx.data,\n                path: ctx.path,\n                parent: ctx,\n            });\n        }\n    }\n    get discriminator() {\n        return this._def.discriminator;\n    }\n    get options() {\n        return this._def.options;\n    }\n    get optionsMap() {\n        return this._def.optionsMap;\n    }\n    /**\n     * The constructor of the discriminated union schema. Its behaviour is very similar to that of the normal z.union() constructor.\n     * However, it only allows a union of objects, all of which need to share a discriminator property. This property must\n     * have a different value for each object in the union.\n     * @param discriminator the name of the discriminator property\n     * @param types an array of object schemas\n     * @param params\n     */\n    static create(discriminator, options, params) {\n        // Get all the valid discriminator values\n        const optionsMap = new Map();\n        // try {\n        for (const type of options) {\n            const discriminatorValues = getDiscriminator(type.shape[discriminator]);\n            if (!discriminatorValues) {\n                throw new Error(`A discriminator value for key \\`${discriminator}\\` could not be extracted from all schema options`);\n            }\n            for (const value of discriminatorValues) {\n                if (optionsMap.has(value)) {\n                    throw new Error(`Discriminator property ${String(discriminator)} has duplicate value ${String(value)}`);\n                }\n                optionsMap.set(value, type);\n            }\n        }\n        return new ZodDiscriminatedUnion({\n            typeName: ZodFirstPartyTypeKind.ZodDiscriminatedUnion,\n            discriminator,\n            options,\n            optionsMap,\n            ...processCreateParams(params),\n        });\n    }\n}\nfunction mergeValues(a, b) {\n    const aType = getParsedType(a);\n    const bType = getParsedType(b);\n    if (a === b) {\n        return { valid: true, data: a };\n    }\n    else if (aType === ZodParsedType.object && bType === ZodParsedType.object) {\n        const bKeys = util.objectKeys(b);\n        const sharedKeys = util\n            .objectKeys(a)\n            .filter((key) => bKeys.indexOf(key) !== -1);\n        const newObj = { ...a, ...b };\n        for (const key of sharedKeys) {\n            const sharedValue = mergeValues(a[key], b[key]);\n            if (!sharedValue.valid) {\n                return { valid: false };\n            }\n            newObj[key] = sharedValue.data;\n        }\n        return { valid: true, data: newObj };\n    }\n    else if (aType === ZodParsedType.array && bType === ZodParsedType.array) {\n        if (a.length !== b.length) {\n            return { valid: false };\n        }\n        const newArray = [];\n        for (let index = 0; index < a.length; index++) {\n            const itemA = a[index];\n            const itemB = b[index];\n            const sharedValue = mergeValues(itemA, itemB);\n            if (!sharedValue.valid) {\n                return { valid: false };\n            }\n            newArray.push(sharedValue.data);\n        }\n        return { valid: true, data: newArray };\n    }\n    else if (aType === ZodParsedType.date &&\n        bType === ZodParsedType.date &&\n        +a === +b) {\n        return { valid: true, data: a };\n    }\n    else {\n        return { valid: false };\n    }\n}\nclass ZodIntersection extends ZodType {\n    _parse(input) {\n        const { status, ctx } = this._processInputParams(input);\n        const handleParsed = (parsedLeft, parsedRight) => {\n            if (isAborted(parsedLeft) || isAborted(parsedRight)) {\n                return INVALID;\n            }\n            const merged = mergeValues(parsedLeft.value, parsedRight.value);\n            if (!merged.valid) {\n                addIssueToContext(ctx, {\n                    code: ZodIssueCode.invalid_intersection_types,\n                });\n                return INVALID;\n            }\n            if (isDirty(parsedLeft) || isDirty(parsedRight)) {\n                status.dirty();\n            }\n            return { status: status.value, value: merged.data };\n        };\n        if (ctx.common.async) {\n            return Promise.all([\n                this._def.left._parseAsync({\n                    data: ctx.data,\n                    path: ctx.path,\n                    parent: ctx,\n                }),\n                this._def.right._parseAsync({\n                    data: ctx.data,\n                    path: ctx.path,\n                    parent: ctx,\n                }),\n            ]).then(([left, right]) => handleParsed(left, right));\n        }\n        else {\n            return handleParsed(this._def.left._parseSync({\n                data: ctx.data,\n                path: ctx.path,\n                parent: ctx,\n            }), this._def.right._parseSync({\n                data: ctx.data,\n                path: ctx.path,\n                parent: ctx,\n            }));\n        }\n    }\n}\nZodIntersection.create = (left, right, params) => {\n    return new ZodIntersection({\n        left: left,\n        right: right,\n        typeName: ZodFirstPartyTypeKind.ZodIntersection,\n        ...processCreateParams(params),\n    });\n};\nclass ZodTuple extends ZodType {\n    _parse(input) {\n        const { status, ctx } = this._processInputParams(input);\n        if (ctx.parsedType !== ZodParsedType.array) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.array,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        if (ctx.data.length < this._def.items.length) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.too_small,\n                minimum: this._def.items.length,\n                inclusive: true,\n                exact: false,\n                type: \"array\",\n            });\n            return INVALID;\n        }\n        const rest = this._def.rest;\n        if (!rest && ctx.data.length > this._def.items.length) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.too_big,\n                maximum: this._def.items.length,\n                inclusive: true,\n                exact: false,\n                type: \"array\",\n            });\n            status.dirty();\n        }\n        const items = [...ctx.data]\n            .map((item, itemIndex) => {\n            const schema = this._def.items[itemIndex] || this._def.rest;\n            if (!schema)\n                return null;\n            return schema._parse(new ParseInputLazyPath(ctx, item, ctx.path, itemIndex));\n        })\n            .filter((x) => !!x); // filter nulls\n        if (ctx.common.async) {\n            return Promise.all(items).then((results) => {\n                return ParseStatus.mergeArray(status, results);\n            });\n        }\n        else {\n            return ParseStatus.mergeArray(status, items);\n        }\n    }\n    get items() {\n        return this._def.items;\n    }\n    rest(rest) {\n        return new ZodTuple({\n            ...this._def,\n            rest,\n        });\n    }\n}\nZodTuple.create = (schemas, params) => {\n    if (!Array.isArray(schemas)) {\n        throw new Error(\"You must pass an array of schemas to z.tuple([ ... ])\");\n    }\n    return new ZodTuple({\n        items: schemas,\n        typeName: ZodFirstPartyTypeKind.ZodTuple,\n        rest: null,\n        ...processCreateParams(params),\n    });\n};\nclass ZodRecord extends ZodType {\n    get keySchema() {\n        return this._def.keyType;\n    }\n    get valueSchema() {\n        return this._def.valueType;\n    }\n    _parse(input) {\n        const { status, ctx } = this._processInputParams(input);\n        if (ctx.parsedType !== ZodParsedType.object) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.object,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        const pairs = [];\n        const keyType = this._def.keyType;\n        const valueType = this._def.valueType;\n        for (const key in ctx.data) {\n            pairs.push({\n                key: keyType._parse(new ParseInputLazyPath(ctx, key, ctx.path, key)),\n                value: valueType._parse(new ParseInputLazyPath(ctx, ctx.data[key], ctx.path, key)),\n            });\n        }\n        if (ctx.common.async) {\n            return ParseStatus.mergeObjectAsync(status, pairs);\n        }\n        else {\n            return ParseStatus.mergeObjectSync(status, pairs);\n        }\n    }\n    get element() {\n        return this._def.valueType;\n    }\n    static create(first, second, third) {\n        if (second instanceof ZodType) {\n            return new ZodRecord({\n                keyType: first,\n                valueType: second,\n                typeName: ZodFirstPartyTypeKind.ZodRecord,\n                ...processCreateParams(third),\n            });\n        }\n        return new ZodRecord({\n            keyType: ZodString.create(),\n            valueType: first,\n            typeName: ZodFirstPartyTypeKind.ZodRecord,\n            ...processCreateParams(second),\n        });\n    }\n}\nclass ZodMap extends ZodType {\n    get keySchema() {\n        return this._def.keyType;\n    }\n    get valueSchema() {\n        return this._def.valueType;\n    }\n    _parse(input) {\n        const { status, ctx } = this._processInputParams(input);\n        if (ctx.parsedType !== ZodParsedType.map) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.map,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        const keyType = this._def.keyType;\n        const valueType = this._def.valueType;\n        const pairs = [...ctx.data.entries()].map(([key, value], index) => {\n            return {\n                key: keyType._parse(new ParseInputLazyPath(ctx, key, ctx.path, [index, \"key\"])),\n                value: valueType._parse(new ParseInputLazyPath(ctx, value, ctx.path, [index, \"value\"])),\n            };\n        });\n        if (ctx.common.async) {\n            const finalMap = new Map();\n            return Promise.resolve().then(async () => {\n                for (const pair of pairs) {\n                    const key = await pair.key;\n                    const value = await pair.value;\n                    if (key.status === \"aborted\" || value.status === \"aborted\") {\n                        return INVALID;\n                    }\n                    if (key.status === \"dirty\" || value.status === \"dirty\") {\n                        status.dirty();\n                    }\n                    finalMap.set(key.value, value.value);\n                }\n                return { status: status.value, value: finalMap };\n            });\n        }\n        else {\n            const finalMap = new Map();\n            for (const pair of pairs) {\n                const key = pair.key;\n                const value = pair.value;\n                if (key.status === \"aborted\" || value.status === \"aborted\") {\n                    return INVALID;\n                }\n                if (key.status === \"dirty\" || value.status === \"dirty\") {\n                    status.dirty();\n                }\n                finalMap.set(key.value, value.value);\n            }\n            return { status: status.value, value: finalMap };\n        }\n    }\n}\nZodMap.create = (keyType, valueType, params) => {\n    return new ZodMap({\n        valueType,\n        keyType,\n        typeName: ZodFirstPartyTypeKind.ZodMap,\n        ...processCreateParams(params),\n    });\n};\nclass ZodSet extends ZodType {\n    _parse(input) {\n        const { status, ctx } = this._processInputParams(input);\n        if (ctx.parsedType !== ZodParsedType.set) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.set,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        const def = this._def;\n        if (def.minSize !== null) {\n            if (ctx.data.size < def.minSize.value) {\n                addIssueToContext(ctx, {\n                    code: ZodIssueCode.too_small,\n                    minimum: def.minSize.value,\n                    type: \"set\",\n                    inclusive: true,\n                    exact: false,\n                    message: def.minSize.message,\n                });\n                status.dirty();\n            }\n        }\n        if (def.maxSize !== null) {\n            if (ctx.data.size > def.maxSize.value) {\n                addIssueToContext(ctx, {\n                    code: ZodIssueCode.too_big,\n                    maximum: def.maxSize.value,\n                    type: \"set\",\n                    inclusive: true,\n                    exact: false,\n                    message: def.maxSize.message,\n                });\n                status.dirty();\n            }\n        }\n        const valueType = this._def.valueType;\n        function finalizeSet(elements) {\n            const parsedSet = new Set();\n            for (const element of elements) {\n                if (element.status === \"aborted\")\n                    return INVALID;\n                if (element.status === \"dirty\")\n                    status.dirty();\n                parsedSet.add(element.value);\n            }\n            return { status: status.value, value: parsedSet };\n        }\n        const elements = [...ctx.data.values()].map((item, i) => valueType._parse(new ParseInputLazyPath(ctx, item, ctx.path, i)));\n        if (ctx.common.async) {\n            return Promise.all(elements).then((elements) => finalizeSet(elements));\n        }\n        else {\n            return finalizeSet(elements);\n        }\n    }\n    min(minSize, message) {\n        return new ZodSet({\n            ...this._def,\n            minSize: { value: minSize, message: errorUtil.toString(message) },\n        });\n    }\n    max(maxSize, message) {\n        return new ZodSet({\n            ...this._def,\n            maxSize: { value: maxSize, message: errorUtil.toString(message) },\n        });\n    }\n    size(size, message) {\n        return this.min(size, message).max(size, message);\n    }\n    nonempty(message) {\n        return this.min(1, message);\n    }\n}\nZodSet.create = (valueType, params) => {\n    return new ZodSet({\n        valueType,\n        minSize: null,\n        maxSize: null,\n        typeName: ZodFirstPartyTypeKind.ZodSet,\n        ...processCreateParams(params),\n    });\n};\nclass ZodFunction extends ZodType {\n    constructor() {\n        super(...arguments);\n        this.validate = this.implement;\n    }\n    _parse(input) {\n        const { ctx } = this._processInputParams(input);\n        if (ctx.parsedType !== ZodParsedType.function) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.function,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        function makeArgsIssue(args, error) {\n            return makeIssue({\n                data: args,\n                path: ctx.path,\n                errorMaps: [\n                    ctx.common.contextualErrorMap,\n                    ctx.schemaErrorMap,\n                    getErrorMap(),\n                    errorMap,\n                ].filter((x) => !!x),\n                issueData: {\n                    code: ZodIssueCode.invalid_arguments,\n                    argumentsError: error,\n                },\n            });\n        }\n        function makeReturnsIssue(returns, error) {\n            return makeIssue({\n                data: returns,\n                path: ctx.path,\n                errorMaps: [\n                    ctx.common.contextualErrorMap,\n                    ctx.schemaErrorMap,\n                    getErrorMap(),\n                    errorMap,\n                ].filter((x) => !!x),\n                issueData: {\n                    code: ZodIssueCode.invalid_return_type,\n                    returnTypeError: error,\n                },\n            });\n        }\n        const params = { errorMap: ctx.common.contextualErrorMap };\n        const fn = ctx.data;\n        if (this._def.returns instanceof ZodPromise) {\n            // Would love a way to avoid disabling this rule, but we need\n            // an alias (using an arrow function was what caused 2651).\n            // eslint-disable-next-line @typescript-eslint/no-this-alias\n            const me = this;\n            return OK(async function (...args) {\n                const error = new ZodError([]);\n                const parsedArgs = await me._def.args\n                    .parseAsync(args, params)\n                    .catch((e) => {\n                    error.addIssue(makeArgsIssue(args, e));\n                    throw error;\n                });\n                const result = await Reflect.apply(fn, this, parsedArgs);\n                const parsedReturns = await me._def.returns._def.type\n                    .parseAsync(result, params)\n                    .catch((e) => {\n                    error.addIssue(makeReturnsIssue(result, e));\n                    throw error;\n                });\n                return parsedReturns;\n            });\n        }\n        else {\n            // Would love a way to avoid disabling this rule, but we need\n            // an alias (using an arrow function was what caused 2651).\n            // eslint-disable-next-line @typescript-eslint/no-this-alias\n            const me = this;\n            return OK(function (...args) {\n                const parsedArgs = me._def.args.safeParse(args, params);\n                if (!parsedArgs.success) {\n                    throw new ZodError([makeArgsIssue(args, parsedArgs.error)]);\n                }\n                const result = Reflect.apply(fn, this, parsedArgs.data);\n                const parsedReturns = me._def.returns.safeParse(result, params);\n                if (!parsedReturns.success) {\n                    throw new ZodError([makeReturnsIssue(result, parsedReturns.error)]);\n                }\n                return parsedReturns.data;\n            });\n        }\n    }\n    parameters() {\n        return this._def.args;\n    }\n    returnType() {\n        return this._def.returns;\n    }\n    args(...items) {\n        return new ZodFunction({\n            ...this._def,\n            args: ZodTuple.create(items).rest(ZodUnknown.create()),\n        });\n    }\n    returns(returnType) {\n        return new ZodFunction({\n            ...this._def,\n            returns: returnType,\n        });\n    }\n    implement(func) {\n        const validatedFunc = this.parse(func);\n        return validatedFunc;\n    }\n    strictImplement(func) {\n        const validatedFunc = this.parse(func);\n        return validatedFunc;\n    }\n    static create(args, returns, params) {\n        return new ZodFunction({\n            args: (args\n                ? args\n                : ZodTuple.create([]).rest(ZodUnknown.create())),\n            returns: returns || ZodUnknown.create(),\n            typeName: ZodFirstPartyTypeKind.ZodFunction,\n            ...processCreateParams(params),\n        });\n    }\n}\nclass ZodLazy extends ZodType {\n    get schema() {\n        return this._def.getter();\n    }\n    _parse(input) {\n        const { ctx } = this._processInputParams(input);\n        const lazySchema = this._def.getter();\n        return lazySchema._parse({ data: ctx.data, path: ctx.path, parent: ctx });\n    }\n}\nZodLazy.create = (getter, params) => {\n    return new ZodLazy({\n        getter: getter,\n        typeName: ZodFirstPartyTypeKind.ZodLazy,\n        ...processCreateParams(params),\n    });\n};\nclass ZodLiteral extends ZodType {\n    _parse(input) {\n        if (input.data !== this._def.value) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                received: ctx.data,\n                code: ZodIssueCode.invalid_literal,\n                expected: this._def.value,\n            });\n            return INVALID;\n        }\n        return { status: \"valid\", value: input.data };\n    }\n    get value() {\n        return this._def.value;\n    }\n}\nZodLiteral.create = (value, params) => {\n    return new ZodLiteral({\n        value: value,\n        typeName: ZodFirstPartyTypeKind.ZodLiteral,\n        ...processCreateParams(params),\n    });\n};\nfunction createZodEnum(values, params) {\n    return new ZodEnum({\n        values,\n        typeName: ZodFirstPartyTypeKind.ZodEnum,\n        ...processCreateParams(params),\n    });\n}\nclass ZodEnum extends ZodType {\n    _parse(input) {\n        if (typeof input.data !== \"string\") {\n            const ctx = this._getOrReturnCtx(input);\n            const expectedValues = this._def.values;\n            addIssueToContext(ctx, {\n                expected: util.joinValues(expectedValues),\n                received: ctx.parsedType,\n                code: ZodIssueCode.invalid_type,\n            });\n            return INVALID;\n        }\n        if (this._def.values.indexOf(input.data) === -1) {\n            const ctx = this._getOrReturnCtx(input);\n            const expectedValues = this._def.values;\n            addIssueToContext(ctx, {\n                received: ctx.data,\n                code: ZodIssueCode.invalid_enum_value,\n                options: expectedValues,\n            });\n            return INVALID;\n        }\n        return OK(input.data);\n    }\n    get options() {\n        return this._def.values;\n    }\n    get enum() {\n        const enumValues = {};\n        for (const val of this._def.values) {\n            enumValues[val] = val;\n        }\n        return enumValues;\n    }\n    get Values() {\n        const enumValues = {};\n        for (const val of this._def.values) {\n            enumValues[val] = val;\n        }\n        return enumValues;\n    }\n    get Enum() {\n        const enumValues = {};\n        for (const val of this._def.values) {\n            enumValues[val] = val;\n        }\n        return enumValues;\n    }\n    extract(values) {\n        return ZodEnum.create(values);\n    }\n    exclude(values) {\n        return ZodEnum.create(this.options.filter((opt) => !values.includes(opt)));\n    }\n}\nZodEnum.create = createZodEnum;\nclass ZodNativeEnum extends ZodType {\n    _parse(input) {\n        const nativeEnumValues = util.getValidEnumValues(this._def.values);\n        const ctx = this._getOrReturnCtx(input);\n        if (ctx.parsedType !== ZodParsedType.string &&\n            ctx.parsedType !== ZodParsedType.number) {\n            const expectedValues = util.objectValues(nativeEnumValues);\n            addIssueToContext(ctx, {\n                expected: util.joinValues(expectedValues),\n                received: ctx.parsedType,\n                code: ZodIssueCode.invalid_type,\n            });\n            return INVALID;\n        }\n        if (nativeEnumValues.indexOf(input.data) === -1) {\n            const expectedValues = util.objectValues(nativeEnumValues);\n            addIssueToContext(ctx, {\n                received: ctx.data,\n                code: ZodIssueCode.invalid_enum_value,\n                options: expectedValues,\n            });\n            return INVALID;\n        }\n        return OK(input.data);\n    }\n    get enum() {\n        return this._def.values;\n    }\n}\nZodNativeEnum.create = (values, params) => {\n    return new ZodNativeEnum({\n        values: values,\n        typeName: ZodFirstPartyTypeKind.ZodNativeEnum,\n        ...processCreateParams(params),\n    });\n};\nclass ZodPromise extends ZodType {\n    unwrap() {\n        return this._def.type;\n    }\n    _parse(input) {\n        const { ctx } = this._processInputParams(input);\n        if (ctx.parsedType !== ZodParsedType.promise &&\n            ctx.common.async === false) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.promise,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        const promisified = ctx.parsedType === ZodParsedType.promise\n            ? ctx.data\n            : Promise.resolve(ctx.data);\n        return OK(promisified.then((data) => {\n            return this._def.type.parseAsync(data, {\n                path: ctx.path,\n                errorMap: ctx.common.contextualErrorMap,\n            });\n        }));\n    }\n}\nZodPromise.create = (schema, params) => {\n    return new ZodPromise({\n        type: schema,\n        typeName: ZodFirstPartyTypeKind.ZodPromise,\n        ...processCreateParams(params),\n    });\n};\nclass ZodEffects extends ZodType {\n    innerType() {\n        return this._def.schema;\n    }\n    sourceType() {\n        return this._def.schema._def.typeName === ZodFirstPartyTypeKind.ZodEffects\n            ? this._def.schema.sourceType()\n            : this._def.schema;\n    }\n    _parse(input) {\n        const { status, ctx } = this._processInputParams(input);\n        const effect = this._def.effect || null;\n        const checkCtx = {\n            addIssue: (arg) => {\n                addIssueToContext(ctx, arg);\n                if (arg.fatal) {\n                    status.abort();\n                }\n                else {\n                    status.dirty();\n                }\n            },\n            get path() {\n                return ctx.path;\n            },\n        };\n        checkCtx.addIssue = checkCtx.addIssue.bind(checkCtx);\n        if (effect.type === \"preprocess\") {\n            const processed = effect.transform(ctx.data, checkCtx);\n            if (ctx.common.issues.length) {\n                return {\n                    status: \"dirty\",\n                    value: ctx.data,\n                };\n            }\n            if (ctx.common.async) {\n                return Promise.resolve(processed).then((processed) => {\n                    return this._def.schema._parseAsync({\n                        data: processed,\n                        path: ctx.path,\n                        parent: ctx,\n                    });\n                });\n            }\n            else {\n                return this._def.schema._parseSync({\n                    data: processed,\n                    path: ctx.path,\n                    parent: ctx,\n                });\n            }\n        }\n        if (effect.type === \"refinement\") {\n            const executeRefinement = (acc\n            // effect: RefinementEffect<any>\n            ) => {\n                const result = effect.refinement(acc, checkCtx);\n                if (ctx.common.async) {\n                    return Promise.resolve(result);\n                }\n                if (result instanceof Promise) {\n                    throw new Error(\"Async refinement encountered during synchronous parse operation. Use .parseAsync instead.\");\n                }\n                return acc;\n            };\n            if (ctx.common.async === false) {\n                const inner = this._def.schema._parseSync({\n                    data: ctx.data,\n                    path: ctx.path,\n                    parent: ctx,\n                });\n                if (inner.status === \"aborted\")\n                    return INVALID;\n                if (inner.status === \"dirty\")\n                    status.dirty();\n                // return value is ignored\n                executeRefinement(inner.value);\n                return { status: status.value, value: inner.value };\n            }\n            else {\n                return this._def.schema\n                    ._parseAsync({ data: ctx.data, path: ctx.path, parent: ctx })\n                    .then((inner) => {\n                    if (inner.status === \"aborted\")\n                        return INVALID;\n                    if (inner.status === \"dirty\")\n                        status.dirty();\n                    return executeRefinement(inner.value).then(() => {\n                        return { status: status.value, value: inner.value };\n                    });\n                });\n            }\n        }\n        if (effect.type === \"transform\") {\n            if (ctx.common.async === false) {\n                const base = this._def.schema._parseSync({\n                    data: ctx.data,\n                    path: ctx.path,\n                    parent: ctx,\n                });\n                if (!isValid(base))\n                    return base;\n                const result = effect.transform(base.value, checkCtx);\n                if (result instanceof Promise) {\n                    throw new Error(`Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.`);\n                }\n                return { status: status.value, value: result };\n            }\n            else {\n                return this._def.schema\n                    ._parseAsync({ data: ctx.data, path: ctx.path, parent: ctx })\n                    .then((base) => {\n                    if (!isValid(base))\n                        return base;\n                    return Promise.resolve(effect.transform(base.value, checkCtx)).then((result) => ({ status: status.value, value: result }));\n                });\n            }\n        }\n        util.assertNever(effect);\n    }\n}\nZodEffects.create = (schema, effect, params) => {\n    return new ZodEffects({\n        schema,\n        typeName: ZodFirstPartyTypeKind.ZodEffects,\n        effect,\n        ...processCreateParams(params),\n    });\n};\nZodEffects.createWithPreprocess = (preprocess, schema, params) => {\n    return new ZodEffects({\n        schema,\n        effect: { type: \"preprocess\", transform: preprocess },\n        typeName: ZodFirstPartyTypeKind.ZodEffects,\n        ...processCreateParams(params),\n    });\n};\nclass ZodOptional extends ZodType {\n    _parse(input) {\n        const parsedType = this._getType(input);\n        if (parsedType === ZodParsedType.undefined) {\n            return OK(undefined);\n        }\n        return this._def.innerType._parse(input);\n    }\n    unwrap() {\n        return this._def.innerType;\n    }\n}\nZodOptional.create = (type, params) => {\n    return new ZodOptional({\n        innerType: type,\n        typeName: ZodFirstPartyTypeKind.ZodOptional,\n        ...processCreateParams(params),\n    });\n};\nclass ZodNullable extends ZodType {\n    _parse(input) {\n        const parsedType = this._getType(input);\n        if (parsedType === ZodParsedType.null) {\n            return OK(null);\n        }\n        return this._def.innerType._parse(input);\n    }\n    unwrap() {\n        return this._def.innerType;\n    }\n}\nZodNullable.create = (type, params) => {\n    return new ZodNullable({\n        innerType: type,\n        typeName: ZodFirstPartyTypeKind.ZodNullable,\n        ...processCreateParams(params),\n    });\n};\nclass ZodDefault extends ZodType {\n    _parse(input) {\n        const { ctx } = this._processInputParams(input);\n        let data = ctx.data;\n        if (ctx.parsedType === ZodParsedType.undefined) {\n            data = this._def.defaultValue();\n        }\n        return this._def.innerType._parse({\n            data,\n            path: ctx.path,\n            parent: ctx,\n        });\n    }\n    removeDefault() {\n        return this._def.innerType;\n    }\n}\nZodDefault.create = (type, params) => {\n    return new ZodDefault({\n        innerType: type,\n        typeName: ZodFirstPartyTypeKind.ZodDefault,\n        defaultValue: typeof params.default === \"function\"\n            ? params.default\n            : () => params.default,\n        ...processCreateParams(params),\n    });\n};\nclass ZodCatch extends ZodType {\n    _parse(input) {\n        const { ctx } = this._processInputParams(input);\n        // newCtx is used to not collect issues from inner types in ctx\n        const newCtx = {\n            ...ctx,\n            common: {\n                ...ctx.common,\n                issues: [],\n            },\n        };\n        const result = this._def.innerType._parse({\n            data: newCtx.data,\n            path: newCtx.path,\n            parent: {\n                ...newCtx,\n            },\n        });\n        if (isAsync(result)) {\n            return result.then((result) => {\n                return {\n                    status: \"valid\",\n                    value: result.status === \"valid\"\n                        ? result.value\n                        : this._def.catchValue({\n                            get error() {\n                                return new ZodError(newCtx.common.issues);\n                            },\n                            input: newCtx.data,\n                        }),\n                };\n            });\n        }\n        else {\n            return {\n                status: \"valid\",\n                value: result.status === \"valid\"\n                    ? result.value\n                    : this._def.catchValue({\n                        get error() {\n                            return new ZodError(newCtx.common.issues);\n                        },\n                        input: newCtx.data,\n                    }),\n            };\n        }\n    }\n    removeCatch() {\n        return this._def.innerType;\n    }\n}\nZodCatch.create = (type, params) => {\n    return new ZodCatch({\n        innerType: type,\n        typeName: ZodFirstPartyTypeKind.ZodCatch,\n        catchValue: typeof params.catch === \"function\" ? params.catch : () => params.catch,\n        ...processCreateParams(params),\n    });\n};\nclass ZodNaN extends ZodType {\n    _parse(input) {\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.nan) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.nan,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        return { status: \"valid\", value: input.data };\n    }\n}\nZodNaN.create = (params) => {\n    return new ZodNaN({\n        typeName: ZodFirstPartyTypeKind.ZodNaN,\n        ...processCreateParams(params),\n    });\n};\nconst BRAND = Symbol(\"zod_brand\");\nclass ZodBranded extends ZodType {\n    _parse(input) {\n        const { ctx } = this._processInputParams(input);\n        const data = ctx.data;\n        return this._def.type._parse({\n            data,\n            path: ctx.path,\n            parent: ctx,\n        });\n    }\n    unwrap() {\n        return this._def.type;\n    }\n}\nclass ZodPipeline extends ZodType {\n    _parse(input) {\n        const { status, ctx } = this._processInputParams(input);\n        if (ctx.common.async) {\n            const handleAsync = async () => {\n                const inResult = await this._def.in._parseAsync({\n                    data: ctx.data,\n                    path: ctx.path,\n                    parent: ctx,\n                });\n                if (inResult.status === \"aborted\")\n                    return INVALID;\n                if (inResult.status === \"dirty\") {\n                    status.dirty();\n                    return DIRTY(inResult.value);\n                }\n                else {\n                    return this._def.out._parseAsync({\n                        data: inResult.value,\n                        path: ctx.path,\n                        parent: ctx,\n                    });\n                }\n            };\n            return handleAsync();\n        }\n        else {\n            const inResult = this._def.in._parseSync({\n                data: ctx.data,\n                path: ctx.path,\n                parent: ctx,\n            });\n            if (inResult.status === \"aborted\")\n                return INVALID;\n            if (inResult.status === \"dirty\") {\n                status.dirty();\n                return {\n                    status: \"dirty\",\n                    value: inResult.value,\n                };\n            }\n            else {\n                return this._def.out._parseSync({\n                    data: inResult.value,\n                    path: ctx.path,\n                    parent: ctx,\n                });\n            }\n        }\n    }\n    static create(a, b) {\n        return new ZodPipeline({\n            in: a,\n            out: b,\n            typeName: ZodFirstPartyTypeKind.ZodPipeline,\n        });\n    }\n}\nclass ZodReadonly extends ZodType {\n    _parse(input) {\n        const result = this._def.innerType._parse(input);\n        if (isValid(result)) {\n            result.value = Object.freeze(result.value);\n        }\n        return result;\n    }\n}\nZodReadonly.create = (type, params) => {\n    return new ZodReadonly({\n        innerType: type,\n        typeName: ZodFirstPartyTypeKind.ZodReadonly,\n        ...processCreateParams(params),\n    });\n};\nconst custom = (check, params = {}, \n/**\n * @deprecated\n *\n * Pass `fatal` into the params object instead:\n *\n * ```ts\n * z.string().custom((val) => val.length > 5, { fatal: false })\n * ```\n *\n */\nfatal) => {\n    if (check)\n        return ZodAny.create().superRefine((data, ctx) => {\n            var _a, _b;\n            if (!check(data)) {\n                const p = typeof params === \"function\"\n                    ? params(data)\n                    : typeof params === \"string\"\n                        ? { message: params }\n                        : params;\n                const _fatal = (_b = (_a = p.fatal) !== null && _a !== void 0 ? _a : fatal) !== null && _b !== void 0 ? _b : true;\n                const p2 = typeof p === \"string\" ? { message: p } : p;\n                ctx.addIssue({ code: \"custom\", ...p2, fatal: _fatal });\n            }\n        });\n    return ZodAny.create();\n};\nconst late = {\n    object: ZodObject.lazycreate,\n};\nvar ZodFirstPartyTypeKind;\n(function (ZodFirstPartyTypeKind) {\n    ZodFirstPartyTypeKind[\"ZodString\"] = \"ZodString\";\n    ZodFirstPartyTypeKind[\"ZodNumber\"] = \"ZodNumber\";\n    ZodFirstPartyTypeKind[\"ZodNaN\"] = \"ZodNaN\";\n    ZodFirstPartyTypeKind[\"ZodBigInt\"] = \"ZodBigInt\";\n    ZodFirstPartyTypeKind[\"ZodBoolean\"] = \"ZodBoolean\";\n    ZodFirstPartyTypeKind[\"ZodDate\"] = \"ZodDate\";\n    ZodFirstPartyTypeKind[\"ZodSymbol\"] = \"ZodSymbol\";\n    ZodFirstPartyTypeKind[\"ZodUndefined\"] = \"ZodUndefined\";\n    ZodFirstPartyTypeKind[\"ZodNull\"] = \"ZodNull\";\n    ZodFirstPartyTypeKind[\"ZodAny\"] = \"ZodAny\";\n    ZodFirstPartyTypeKind[\"ZodUnknown\"] = \"ZodUnknown\";\n    ZodFirstPartyTypeKind[\"ZodNever\"] = \"ZodNever\";\n    ZodFirstPartyTypeKind[\"ZodVoid\"] = \"ZodVoid\";\n    ZodFirstPartyTypeKind[\"ZodArray\"] = \"ZodArray\";\n    ZodFirstPartyTypeKind[\"ZodObject\"] = \"ZodObject\";\n    ZodFirstPartyTypeKind[\"ZodUnion\"] = \"ZodUnion\";\n    ZodFirstPartyTypeKind[\"ZodDiscriminatedUnion\"] = \"ZodDiscriminatedUnion\";\n    ZodFirstPartyTypeKind[\"ZodIntersection\"] = \"ZodIntersection\";\n    ZodFirstPartyTypeKind[\"ZodTuple\"] = \"ZodTuple\";\n    ZodFirstPartyTypeKind[\"ZodRecord\"] = \"ZodRecord\";\n    ZodFirstPartyTypeKind[\"ZodMap\"] = \"ZodMap\";\n    ZodFirstPartyTypeKind[\"ZodSet\"] = \"ZodSet\";\n    ZodFirstPartyTypeKind[\"ZodFunction\"] = \"ZodFunction\";\n    ZodFirstPartyTypeKind[\"ZodLazy\"] = \"ZodLazy\";\n    ZodFirstPartyTypeKind[\"ZodLiteral\"] = \"ZodLiteral\";\n    ZodFirstPartyTypeKind[\"ZodEnum\"] = \"ZodEnum\";\n    ZodFirstPartyTypeKind[\"ZodEffects\"] = \"ZodEffects\";\n    ZodFirstPartyTypeKind[\"ZodNativeEnum\"] = \"ZodNativeEnum\";\n    ZodFirstPartyTypeKind[\"ZodOptional\"] = \"ZodOptional\";\n    ZodFirstPartyTypeKind[\"ZodNullable\"] = \"ZodNullable\";\n    ZodFirstPartyTypeKind[\"ZodDefault\"] = \"ZodDefault\";\n    ZodFirstPartyTypeKind[\"ZodCatch\"] = \"ZodCatch\";\n    ZodFirstPartyTypeKind[\"ZodPromise\"] = \"ZodPromise\";\n    ZodFirstPartyTypeKind[\"ZodBranded\"] = \"ZodBranded\";\n    ZodFirstPartyTypeKind[\"ZodPipeline\"] = \"ZodPipeline\";\n    ZodFirstPartyTypeKind[\"ZodReadonly\"] = \"ZodReadonly\";\n})(ZodFirstPartyTypeKind || (ZodFirstPartyTypeKind = {}));\nconst instanceOfType = (\n// const instanceOfType = <T extends new (...args: any[]) => any>(\ncls, params = {\n    message: `Input not instance of ${cls.name}`,\n}) => custom((data) => data instanceof cls, params);\nconst stringType = ZodString.create;\nconst numberType = ZodNumber.create;\nconst nanType = ZodNaN.create;\nconst bigIntType = ZodBigInt.create;\nconst booleanType = ZodBoolean.create;\nconst dateType = ZodDate.create;\nconst symbolType = ZodSymbol.create;\nconst undefinedType = ZodUndefined.create;\nconst nullType = ZodNull.create;\nconst anyType = ZodAny.create;\nconst unknownType = ZodUnknown.create;\nconst neverType = ZodNever.create;\nconst voidType = ZodVoid.create;\nconst arrayType = ZodArray.create;\nconst objectType = ZodObject.create;\nconst strictObjectType = ZodObject.strictCreate;\nconst unionType = ZodUnion.create;\nconst discriminatedUnionType = ZodDiscriminatedUnion.create;\nconst intersectionType = ZodIntersection.create;\nconst tupleType = ZodTuple.create;\nconst recordType = ZodRecord.create;\nconst mapType = ZodMap.create;\nconst setType = ZodSet.create;\nconst functionType = ZodFunction.create;\nconst lazyType = ZodLazy.create;\nconst literalType = ZodLiteral.create;\nconst enumType = ZodEnum.create;\nconst nativeEnumType = ZodNativeEnum.create;\nconst promiseType = ZodPromise.create;\nconst effectsType = ZodEffects.create;\nconst optionalType = ZodOptional.create;\nconst nullableType = ZodNullable.create;\nconst preprocessType = ZodEffects.createWithPreprocess;\nconst pipelineType = ZodPipeline.create;\nconst ostring = () => stringType().optional();\nconst onumber = () => numberType().optional();\nconst oboolean = () => booleanType().optional();\nconst coerce = {\n    string: ((arg) => ZodString.create({ ...arg, coerce: true })),\n    number: ((arg) => ZodNumber.create({ ...arg, coerce: true })),\n    boolean: ((arg) => ZodBoolean.create({\n        ...arg,\n        coerce: true,\n    })),\n    bigint: ((arg) => ZodBigInt.create({ ...arg, coerce: true })),\n    date: ((arg) => ZodDate.create({ ...arg, coerce: true })),\n};\nconst NEVER = INVALID;\n\nvar z = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    defaultErrorMap: errorMap,\n    setErrorMap: setErrorMap,\n    getErrorMap: getErrorMap,\n    makeIssue: makeIssue,\n    EMPTY_PATH: EMPTY_PATH,\n    addIssueToContext: addIssueToContext,\n    ParseStatus: ParseStatus,\n    INVALID: INVALID,\n    DIRTY: DIRTY,\n    OK: OK,\n    isAborted: isAborted,\n    isDirty: isDirty,\n    isValid: isValid,\n    isAsync: isAsync,\n    get util () { return util; },\n    get objectUtil () { return objectUtil; },\n    ZodParsedType: ZodParsedType,\n    getParsedType: getParsedType,\n    ZodType: ZodType,\n    ZodString: ZodString,\n    ZodNumber: ZodNumber,\n    ZodBigInt: ZodBigInt,\n    ZodBoolean: ZodBoolean,\n    ZodDate: ZodDate,\n    ZodSymbol: ZodSymbol,\n    ZodUndefined: ZodUndefined,\n    ZodNull: ZodNull,\n    ZodAny: ZodAny,\n    ZodUnknown: ZodUnknown,\n    ZodNever: ZodNever,\n    ZodVoid: ZodVoid,\n    ZodArray: ZodArray,\n    ZodObject: ZodObject,\n    ZodUnion: ZodUnion,\n    ZodDiscriminatedUnion: ZodDiscriminatedUnion,\n    ZodIntersection: ZodIntersection,\n    ZodTuple: ZodTuple,\n    ZodRecord: ZodRecord,\n    ZodMap: ZodMap,\n    ZodSet: ZodSet,\n    ZodFunction: ZodFunction,\n    ZodLazy: ZodLazy,\n    ZodLiteral: ZodLiteral,\n    ZodEnum: ZodEnum,\n    ZodNativeEnum: ZodNativeEnum,\n    ZodPromise: ZodPromise,\n    ZodEffects: ZodEffects,\n    ZodTransformer: ZodEffects,\n    ZodOptional: ZodOptional,\n    ZodNullable: ZodNullable,\n    ZodDefault: ZodDefault,\n    ZodCatch: ZodCatch,\n    ZodNaN: ZodNaN,\n    BRAND: BRAND,\n    ZodBranded: ZodBranded,\n    ZodPipeline: ZodPipeline,\n    ZodReadonly: ZodReadonly,\n    custom: custom,\n    Schema: ZodType,\n    ZodSchema: ZodType,\n    late: late,\n    get ZodFirstPartyTypeKind () { return ZodFirstPartyTypeKind; },\n    coerce: coerce,\n    any: anyType,\n    array: arrayType,\n    bigint: bigIntType,\n    boolean: booleanType,\n    date: dateType,\n    discriminatedUnion: discriminatedUnionType,\n    effect: effectsType,\n    'enum': enumType,\n    'function': functionType,\n    'instanceof': instanceOfType,\n    intersection: intersectionType,\n    lazy: lazyType,\n    literal: literalType,\n    map: mapType,\n    nan: nanType,\n    nativeEnum: nativeEnumType,\n    never: neverType,\n    'null': nullType,\n    nullable: nullableType,\n    number: numberType,\n    object: objectType,\n    oboolean: oboolean,\n    onumber: onumber,\n    optional: optionalType,\n    ostring: ostring,\n    pipeline: pipelineType,\n    preprocess: preprocessType,\n    promise: promiseType,\n    record: recordType,\n    set: setType,\n    strictObject: strictObjectType,\n    string: stringType,\n    symbol: symbolType,\n    transformer: effectsType,\n    tuple: tupleType,\n    'undefined': undefinedType,\n    union: unionType,\n    unknown: unknownType,\n    'void': voidType,\n    NEVER: NEVER,\n    ZodIssueCode: ZodIssueCode,\n    quotelessJson: quotelessJson,\n    ZodError: ZodError\n});\n\nexport { BRAND, DIRTY, EMPTY_PATH, INVALID, NEVER, OK, ParseStatus, ZodType as Schema, ZodAny, ZodArray, ZodBigInt, ZodBoolean, ZodBranded, ZodCatch, ZodDate, ZodDefault, ZodDiscriminatedUnion, ZodEffects, ZodEnum, ZodError, ZodFirstPartyTypeKind, ZodFunction, ZodIntersection, ZodIssueCode, ZodLazy, ZodLiteral, ZodMap, ZodNaN, ZodNativeEnum, ZodNever, ZodNull, ZodNullable, ZodNumber, ZodObject, ZodOptional, ZodParsedType, ZodPipeline, ZodPromise, ZodReadonly, ZodRecord, ZodType as ZodSchema, ZodSet, ZodString, ZodSymbol, ZodEffects as ZodTransformer, ZodTuple, ZodType, ZodUndefined, ZodUnion, ZodUnknown, ZodVoid, addIssueToContext, anyType as any, arrayType as array, bigIntType as bigint, booleanType as boolean, coerce, custom, dateType as date, z as default, errorMap as defaultErrorMap, discriminatedUnionType as discriminatedUnion, effectsType as effect, enumType as enum, functionType as function, getErrorMap, getParsedType, instanceOfType as instanceof, intersectionType as intersection, isAborted, isAsync, isDirty, isValid, late, lazyType as lazy, literalType as literal, makeIssue, mapType as map, nanType as nan, nativeEnumType as nativeEnum, neverType as never, nullType as null, nullableType as nullable, numberType as number, objectType as object, objectUtil, oboolean, onumber, optionalType as optional, ostring, pipelineType as pipeline, preprocessType as preprocess, promiseType as promise, quotelessJson, recordType as record, setType as set, setErrorMap, strictObjectType as strictObject, stringType as string, symbolType as symbol, effectsType as transformer, tupleType as tuple, undefinedType as undefined, unionType as union, unknownType as unknown, util, voidType as void, z };\n","import { apiClient as apiClientMaker, httpCommunication } from \"typed-api\";\n\nimport { z } from \"zod\";\nimport { endpoint } from \"typed-api\";\n\nexport type CreateConversationOutput = z.infer<\n  typeof backendApiSchema.createConversation.output\n>;\n\nexport type SetWebhookOutput = z.infer<\n  typeof backendApiSchema.setWebhook.output\n>;\n\nexport const backendApiSchema = {\n  conversationKey: endpoint({\n    authRequired: false,\n    input: z.object({\n      conversationId: z.string(),\n      publicSignKey: z.string(),\n    }),\n    output: z.union([\n      z.object({ conversationKey: z.string() }),\n      z.object({ error: z.literal(\"no-such-key\") }),\n    ]),\n  }),\n  createConversation: endpoint({\n    authRequired: false,\n    input: z.object({\n      publicSignKeyToEncryptedSymmetricKey: z.record(z.string(), z.string()),\n      title: z.string(),\n    }),\n    output: z.union([\n      z.object({ conversationId: z.string() }),\n      z.object({\n        error: z.enum([\"invalid-participants\", \"must-own-an-identity\"]),\n      }),\n    ]),\n  }),\n  createAccount: endpoint({\n    authRequired: false,\n    input: z.object({}),\n    output: z.object({\n      success: z.literal(true),\n      accountId: z.string(),\n      accessToken: z.string(),\n    }),\n  }),\n  createAnonymousIdentity: endpoint({\n    authRequired: false,\n    input: z.object({\n      name: z.string(),\n      publicSignKey: z.string(),\n      publicEncryptKey: z.string(),\n    }),\n    output: z.object({}),\n  }),\n  createIdentity: endpoint({\n    authRequired: true,\n    input: z.object({\n      publicSignKey: z.string(),\n      publicEncryptKey: z.string(),\n    }),\n    output: z.object({}),\n  }),\n  sendMessage: endpoint({\n    authRequired: false,\n    input: z.object({ encryptedMessage: z.string(), conversation: z.string() }),\n    output: z.object({ messageId: z.string() }),\n  }),\n  setWebhook: endpoint({\n    authRequired: false,\n    input: z.object({\n      url: z.string(),\n      publicSignKey: z.string(),\n    }),\n    output: z.union([\n      z.object({ success: z.literal(true) }),\n      z.object({\n        success: z.literal(false),\n        error: z.literal(\"identity-does-not-exist\"),\n      }),\n    ]),\n  }),\n} as const;\n\nexport type backendApi = typeof backendApiSchema;\n\nexport const apiClient = apiClientMaker(\n  httpCommunication(\"https://alice-and-bot.deno.dev\"),\n  backendApiSchema,\n);\n","import type { InstantReactWebDatabase } from \"@instantdb/react\";\nimport type schema from \"../../../instant.schema.ts\";\nimport type { Credentials } from \"../../../protocol/src/api.ts\";\n\nexport const useConversations =\n  (db: () => InstantReactWebDatabase<typeof schema>) =>\n  ({ publicSignKey }: Credentials) => {\n    const { data, error } = db().useQuery({\n      conversations: {\n        participants: {},\n        $: { where: { \"participants.publicSignKey\": publicSignKey } },\n      },\n    });\n    if (error) {\n      console.error(\"Error fetching conversations:\", error);\n    }\n    return data?.conversations ?? [];\n  };\n","// Cannot be made point free.\nexport const promiseAll = (promises) => Promise.all(promises);\n// Cannot be made point free.\nexport const wrapPromise = (x) => Promise.resolve(x);\n// deno-lint-ignore no-explicit-any\nexport const isPromise = (x) => typeof x?.then === \"function\" && typeof x?.catch === \"function\" &&\n    typeof x?.finally === \"function\";\nexport const doInSequence = (head, ...rest) => wrapPromise(head()).then((x) => rest.length ? doInSequence(rest[0], ...rest.slice(1)) : x);\n","import { isPromise } from \"./promise.js\";\nconst firstTrue = (promises) => {\n    const newPromises = promises.map((p) => new Promise((resolve, reject) => p.then((v) => v && resolve(true), reject)));\n    newPromises.push(Promise.all(promises).then(() => false));\n    return Promise.race(newPromises);\n};\nexport const anymap = (f) => (xs) => {\n    const promises = [];\n    for (const x of xs) {\n        const result = f(x);\n        if (isPromise(result)) {\n            promises.push(result);\n            // @ts-expect-error cannot infer\n        }\n        else if (result)\n            return true;\n    }\n    // @ts-expect-error cannot infer\n    return (promises.length) ? firstTrue(promises) : false;\n};\nexport const any = (a) => a.some((x) => x);\nexport const allmap = (f) => (xs) => {\n    const promises = [];\n    for (const x of xs) {\n        const result = f(x);\n        if (isPromise(result)) {\n            promises.push(result);\n            // @ts-expect-error cannot infer\n        }\n        else if (!result)\n            return false;\n    }\n    // @ts-expect-error cannot infer\n    return !promises.length ||\n        firstTrue(promises.map((x) => x.then((x) => !x))).then((x) => !x);\n};\nexport const all = (a) => a.every((x) => x);\nexport const join = (str) => (x) => x.join(str);\nexport const length = (array) => array.length;\n// deno-lint-ignore no-explicit-any\nexport const uniqueBy = (key) => (array) => {\n    const seen = new Set();\n    const result = [];\n    for (const x of array) {\n        const k = key(x);\n        if (!seen.has(k)) {\n            result.push(x);\n            seen.add(k);\n        }\n    }\n    return result;\n};\nexport const unique = (array) => Array.from(new Set(array));\nexport const concat = (array) => {\n    const result = [];\n    for (const xs of array) {\n        for (const x of xs) {\n            result.push(x);\n        }\n    }\n    return result;\n};\nexport const reverse = (array) => array.slice().reverse();\nexport const tail = (x) => x.slice(1);\n// deno-lint-ignore no-explicit-any\nexport const head = (x) => x[0];\nexport const init = (x) => x.slice(0, -1);\n// deno-lint-ignore no-explicit-any\nexport const second = (x) => x[1];\n// deno-lint-ignore no-explicit-any\nexport const third = (x) => x[2];\nexport const last = (x) => x[x.length - 1];\nexport const empty = (x) => !x.length;\nexport const nonempty = (x) => !!x.length;\nexport const wrapArray = (x) => [x];\n// deno-lint-ignore no-explicit-any\nexport const zip = (args) => range(0, Math.min(...args.map(length))).map((i) => args.map((arr) => arr[i]));\nconst compareArrays = (a, b) => {\n    for (const [x, y] of zip([a, b])) {\n        const result = comparator(x, y);\n        if (result)\n            return result;\n    }\n    return 0;\n};\nconst comparator = (a, b) => typeof a === \"boolean\" && typeof b === \"boolean\"\n    ? Number(a) - Number(b)\n    : typeof a === \"string\" && typeof b === \"string\"\n        ? a.localeCompare(b)\n        : typeof a === \"number\" && typeof b === \"number\"\n            ? a - b\n            : compareArrays(a, b);\nconst castToInt = (x) => x === true ? 1 : x === false ? -1 : x;\nexport const sortCompare = (comparator) => (xs) => xs.slice().sort((x, y) => castToInt(comparator(x, y)));\nexport const sort = sortCompare(comparator);\nexport const sortKey = (key) => sortCompare((a, b) => comparator(key(a), key(b)));\nexport const range = (start, end) => {\n    const result = [];\n    for (let i = start; i < end; i++)\n        result.push(i);\n    return result;\n};\nexport const contains = (x) => (array) => array.includes(x);\nexport const includedIn = (array) => (x) => array.includes(x);\nexport const take = (n) => (xs) => xs.slice(0, n);\nexport const sample = (n) => (xs) => xs.slice()\n    .map((value, index) => [Math.random(), value, index])\n    .sort(([a], [b]) => a - b)\n    .slice(0, Math.min(n, xs.length))\n    .map(([, value]) => value);\nexport const drop = (n) => (xs) => xs.slice(n);\nexport const enumerate = (xs) => xs.map((x, i) => [i, x]);\nexport const slidingWindow = (l) => (xs) => xs.flatMap((_, i) => (i <= xs.length - l ? [xs.slice(i, i + l)] : []));\nexport const append = (element) => (arr) => [...arr, element];\n","import { isPromise } from \"./promise.js\";\nconst reduceHelper = (reducer, s, xs, firstIndex) => {\n    let current = s;\n    for (let i = firstIndex; i < xs.length; i++) {\n        if (isPromise(current)) {\n            return current.then((s) => reduceHelper(reducer, s, xs, i));\n        }\n        current = reducer(current, xs[i]);\n    }\n    return current;\n};\n// deno-lint-ignore no-explicit-any\nexport const reduce = (reducer, initial) => (xs) => reduceHelper(reducer, initial(), xs, 0);\nexport const min = (key) => (xs) => reduceHelper((s, x) => {\n    const keyS = key(s);\n    const keyX = key(x);\n    return ((isPromise(keyS) || isPromise(keyX))\n        ? Promise.all([keyS, keyX]).then(([keyS, keyX]) => keyS < keyX ? s : x)\n        : key(s) < key(x)\n            ? s\n            : x);\n}, xs[0], xs, 1);\nexport const max = (key) => (xs) => reduceHelper((s, x) => {\n    const keyS = key(s);\n    const keyX = key(x);\n    return ((isPromise(keyS) || isPromise(keyX))\n        ? Promise.all([keyS, keyX]).then(([keyS, keyX]) => keyS < keyX ? x : s)\n        : key(s) < key(x)\n            ? x\n            : s);\n}, xs[0], xs, 1);\n","const frameToString = ({ line, file, column }) => `${file}:${line}:${column}`;\nconst parseStackLine = (stackLine) => {\n    const matches = /\\s+at\\s+(.+\\s)?\\(?(.+):(\\d+):(\\d+)\\)?/.exec(stackLine) ||\n        /(.+)@(.+):(\\d+):(\\d+)/g.exec(stackLine); // Safari style\n    if (!matches)\n        return null;\n    const [, , file, line, column] = matches;\n    return { file, line: parseInt(line), column: parseInt(column) };\n};\nconst parseStackTrace = (trace, picker) => parseStackLine(picker(trace.split(\"\\n\")));\nexport const currentLocation = (depth) => {\n    const x = parseStackTrace(new Error().stack, (x) => x[depth]);\n    return x ? frameToString(x) : \"stack line could not be parsed\";\n};\n","import { reverse } from \"./array.js\";\nimport { not } from \"./operator.js\";\nimport { isPromise } from \"./promise.js\";\nimport { reduce } from \"./reduce.js\";\nimport { currentLocation } from \"./trace.js\";\nconst pipeWithoutStack = (...fs) => ((...x) => reduce((v, f) => f(v), () => fs[0](...x))(fs.slice(1)));\n// deno-lint-ignore no-explicit-any\nconst augmentAndRethrowException = (location) => (e) => {\n    if (e === undefined) {\n        console.error(`undefined error within ${location}`);\n        throw e;\n    }\n    try {\n        e.message = (e.message ? (e.message + \"\\n\") : \"\") + location;\n    }\n    catch (augmentError) {\n        console.error(`error within ${location}, gamla could not augment error stack`, augmentError, e);\n    }\n    throw e;\n};\nexport const errorBoundry = (f) => {\n    const location = currentLocation(4);\n    return ((...x) => {\n        try {\n            const result = f(...x);\n            return (isPromise(result))\n                ? result.catch(augmentAndRethrowException(location))\n                : result;\n        }\n        catch (e) {\n            augmentAndRethrowException(location)(e);\n        }\n    });\n};\nexport const pipe = (...fs) => \n// @ts-ignore-error error in deno but not in node\nerrorBoundry(pipeWithoutStack(...fs));\nexport const compose = (...fs) => pipe(...reverse(fs));\nexport const after = (f) => (g) => pipe(g, f);\nexport const before = (f1) => (f2) => pipe(f1, f2);\nexport const complement = (f) => \n// @ts-expect-error compiler cannot dynamically infer\npipe(f, not);\nexport const sideEffect = (f) => (x) => {\n    const result = f(x);\n    return (isPromise(result)) ? result.then(() => x) : x;\n};\nexport const wrapSideEffect = (cleanup) => (f) => (...args) => {\n    const result = f(...args);\n    if (isPromise(result)) {\n        return result.then((result) => {\n            const cleanUpResult = cleanup(...args);\n            return isPromise(cleanUpResult)\n                ? cleanUpResult.then(() => result)\n                : result;\n        });\n    }\n    else {\n        const cleanUpResult = cleanup(...args);\n        return isPromise(cleanUpResult) ? cleanUpResult.then(() => result) : result;\n    }\n};\nexport const applyTo = (...args) => (f) => f(...args);\nexport const always = (x) => () => x;\nexport const identity = (x) => x;\nexport const thunk = (f) => ((...x) => f()(...x));\n","import { errorBoundry, pipe } from \"./composition.js\";\nimport { reduce } from \"./reduce.js\";\nimport { isPromise } from \"./promise.js\";\nconst mapWithoutStack = (f) => (xs) => {\n    const results = [];\n    for (const x of xs) {\n        results.push(f(x));\n    }\n    // @ts-expect-error ts cannot reason about this dynamic ternary\n    return results.some(isPromise) ? Promise.all(results) : results;\n};\nexport const map = (...fs) => errorBoundry(mapWithoutStack(...fs));\nexport const each = (f) => \n// @ts-expect-error ts cannot reason about this\n(xs) => {\n    const results = [];\n    for (const x of xs) {\n        const result = f(x);\n        if (isPromise(result))\n            results.push(result);\n    }\n    // @ts-expect-error ts cannot reason about this dynamic ternary\n    if (results.length)\n        return Promise.all(results).then();\n};\nexport const mapCat = (f) => (x) => pipe(map(f), reduce((a, b) => a.concat(b), () => []))(x);\n","import { allmap, anymap, concat, zip } from \"./array.js\";\nimport { identity, pipe } from \"./composition.js\";\nimport { isPromise } from \"./promise.js\";\nimport { map } from \"./map.js\";\nexport const juxt = (...fs) => (...x) => {\n    const result = [];\n    let anyAsync = false;\n    for (const f of fs) {\n        result.push(f(...x));\n        anyAsync = anyAsync || isPromise(result[result.length - 1]);\n    }\n    // @ts-expect-error reason=ts does not understand me :_(\n    return anyAsync ? Promise.all(result) : result;\n};\nexport const pairRight = (f) => juxt((identity), f);\nexport const pairLeft = (f) => juxt(f, (identity));\nexport const stack = (...functions) => \n// @ts-expect-error reason: too complex\npipe((values) => zip([functions, values]), map(([f, x]) => f(x)));\nexport const juxtCat = (...fs) => \n// @ts-expect-error too complex\npipe(juxt(...fs), concat);\nexport const alljuxt = (...fs) => (...xs) => \n// @ts-expect-error cannot infer\nallmap((f) => f(...xs))(fs);\nexport const anyjuxt = (...fs) => (...xs) => \n// @ts-expect-error cannot infer\nanymap((f) => f(...xs))(fs);\n","import { head, second } from \"./array.js\";\nimport { complement, pipe } from \"./composition.js\";\nimport { pairRight } from \"./juxt.js\";\nimport { map } from \"./map.js\";\nimport { isPromise } from \"./promise.js\";\nexport const filter = (f) => \n// @ts-expect-error typing head is hard.\npipe(map(pairRight(f)), (array) => array.filter(second), map(head));\nexport const find = (predicate) => (xs) => {\n    const asyncResults = [];\n    for (const x of xs) {\n        const result = predicate(x);\n        if (isPromise(result)) {\n            asyncResults.push(result.then((predicateResult) => new Promise((resolve, reject) => predicateResult ? resolve(x) : reject(new Error(\"failed check\")))));\n        }\n        else if (result)\n            return x;\n    }\n    // @ts-expect-error ts cannot infer\n    return (asyncResults.length)\n        ? Promise.any(asyncResults).catch(() => undefined)\n        : undefined;\n};\nexport const remove = (f) => \n// @ts-expect-error compiler cannot infer\nfilter(complement(f));\nconst toContainmentCheck = (xs) => {\n    const set = new Set(xs);\n    return (k) => set.has(k);\n};\nexport const intersectBy = (f) => (arrays) => arrays.reduce((current, next) => current.filter(pipe(f, toContainmentCheck(next.map(f)))));\nexport const removeNulls = (x) => x.filter((x) => x !== null);\n","/**\n * Utilities for hex, bytes, CSPRNG.\n * @module\n */\n/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n// We use WebCrypto aka globalThis.crypto, which exists in browsers and node.js 16+.\n// node.js versions earlier than v19 don't declare it in global scope.\n// For node.js, package.json#exports field mapping rewrites import\n// from `crypto` to `cryptoNode`, which imports native module.\n// Makes the utils un-importable in browsers without a bundler.\n// Once node.js 18 is deprecated (2025-04-30), we can just drop the import.\nimport { crypto } from './crypto.js';\nimport { abytes } from './_assert.js';\n// export { isBytes } from './_assert.ts';\n// We can't reuse isBytes from _assert, because somehow this causes huge perf issues\nexport function isBytes(a) {\n    return a instanceof Uint8Array || (ArrayBuffer.isView(a) && a.constructor.name === 'Uint8Array');\n}\n// Cast array to different type\nexport function u8(arr) {\n    return new Uint8Array(arr.buffer, arr.byteOffset, arr.byteLength);\n}\nexport function u32(arr) {\n    return new Uint32Array(arr.buffer, arr.byteOffset, Math.floor(arr.byteLength / 4));\n}\n// Cast array to view\nexport function createView(arr) {\n    return new DataView(arr.buffer, arr.byteOffset, arr.byteLength);\n}\n/** The rotate right (circular right shift) operation for uint32 */\nexport function rotr(word, shift) {\n    return (word << (32 - shift)) | (word >>> shift);\n}\n/** The rotate left (circular left shift) operation for uint32 */\nexport function rotl(word, shift) {\n    return (word << shift) | ((word >>> (32 - shift)) >>> 0);\n}\n/** Is current platform little-endian? Most are. Big-Endian platform: IBM */\nexport const isLE = /* @__PURE__ */ (() => new Uint8Array(new Uint32Array([0x11223344]).buffer)[0] === 0x44)();\n// The byte swap operation for uint32\nexport function byteSwap(word) {\n    return (((word << 24) & 0xff000000) |\n        ((word << 8) & 0xff0000) |\n        ((word >>> 8) & 0xff00) |\n        ((word >>> 24) & 0xff));\n}\n/** Conditionally byte swap if on a big-endian platform */\nexport const byteSwapIfBE = isLE\n    ? (n) => n\n    : (n) => byteSwap(n);\n/** In place byte swap for Uint32Array */\nexport function byteSwap32(arr) {\n    for (let i = 0; i < arr.length; i++) {\n        arr[i] = byteSwap(arr[i]);\n    }\n}\n// Built-in hex conversion https://caniuse.com/mdn-javascript_builtins_uint8array_fromhex\nconst hasHexBuiltin = \n// @ts-ignore\ntypeof Uint8Array.from([]).toHex === 'function' && typeof Uint8Array.fromHex === 'function';\n// Array where index 0xf0 (240) is mapped to string 'f0'\nconst hexes = /* @__PURE__ */ Array.from({ length: 256 }, (_, i) => i.toString(16).padStart(2, '0'));\n/**\n * Convert byte array to hex string. Uses built-in function, when available.\n * @example bytesToHex(Uint8Array.from([0xca, 0xfe, 0x01, 0x23])) // 'cafe0123'\n */\nexport function bytesToHex(bytes) {\n    abytes(bytes);\n    // @ts-ignore\n    if (hasHexBuiltin)\n        return bytes.toHex();\n    // pre-caching improves the speed 6x\n    let hex = '';\n    for (let i = 0; i < bytes.length; i++) {\n        hex += hexes[bytes[i]];\n    }\n    return hex;\n}\n// We use optimized technique to convert hex string to byte array\nconst asciis = { _0: 48, _9: 57, A: 65, F: 70, a: 97, f: 102 };\nfunction asciiToBase16(ch) {\n    if (ch >= asciis._0 && ch <= asciis._9)\n        return ch - asciis._0; // '2' => 50-48\n    if (ch >= asciis.A && ch <= asciis.F)\n        return ch - (asciis.A - 10); // 'B' => 66-(65-10)\n    if (ch >= asciis.a && ch <= asciis.f)\n        return ch - (asciis.a - 10); // 'b' => 98-(97-10)\n    return;\n}\n/**\n * Convert hex string to byte array. Uses built-in function, when available.\n * @example hexToBytes('cafe0123') // Uint8Array.from([0xca, 0xfe, 0x01, 0x23])\n */\nexport function hexToBytes(hex) {\n    if (typeof hex !== 'string')\n        throw new Error('hex string expected, got ' + typeof hex);\n    // @ts-ignore\n    if (hasHexBuiltin)\n        return Uint8Array.fromHex(hex);\n    const hl = hex.length;\n    const al = hl / 2;\n    if (hl % 2)\n        throw new Error('hex string expected, got unpadded hex of length ' + hl);\n    const array = new Uint8Array(al);\n    for (let ai = 0, hi = 0; ai < al; ai++, hi += 2) {\n        const n1 = asciiToBase16(hex.charCodeAt(hi));\n        const n2 = asciiToBase16(hex.charCodeAt(hi + 1));\n        if (n1 === undefined || n2 === undefined) {\n            const char = hex[hi] + hex[hi + 1];\n            throw new Error('hex string expected, got non-hex character \"' + char + '\" at index ' + hi);\n        }\n        array[ai] = n1 * 16 + n2; // multiply first octet, e.g. 'a3' => 10*16+3 => 160 + 3 => 163\n    }\n    return array;\n}\n/**\n * There is no setImmediate in browser and setTimeout is slow.\n * Call of async fn will return Promise, which will be fullfiled only on\n * next scheduler queue processing step and this is exactly what we need.\n */\nexport const nextTick = async () => { };\n/** Returns control to thread each 'tick' ms to avoid blocking. */\nexport async function asyncLoop(iters, tick, cb) {\n    let ts = Date.now();\n    for (let i = 0; i < iters; i++) {\n        cb(i);\n        // Date.now() is not monotonic, so in case if clock goes backwards we return return control too\n        const diff = Date.now() - ts;\n        if (diff >= 0 && diff < tick)\n            continue;\n        await nextTick();\n        ts += diff;\n    }\n}\n/**\n * Convert JS string to byte array.\n * @example utf8ToBytes('abc') // new Uint8Array([97, 98, 99])\n */\nexport function utf8ToBytes(str) {\n    if (typeof str !== 'string')\n        throw new Error('utf8ToBytes expected string, got ' + typeof str);\n    return new Uint8Array(new TextEncoder().encode(str)); // https://bugzil.la/1681809\n}\n/**\n * Normalizes (non-hex) string or Uint8Array to Uint8Array.\n * Warning: when Uint8Array is passed, it would NOT get copied.\n * Keep in mind for future mutable operations.\n */\nexport function toBytes(data) {\n    if (typeof data === 'string')\n        data = utf8ToBytes(data);\n    abytes(data);\n    return data;\n}\n/**\n * Copies several Uint8Arrays into one.\n */\nexport function concatBytes(...arrays) {\n    let sum = 0;\n    for (let i = 0; i < arrays.length; i++) {\n        const a = arrays[i];\n        abytes(a);\n        sum += a.length;\n    }\n    const res = new Uint8Array(sum);\n    for (let i = 0, pad = 0; i < arrays.length; i++) {\n        const a = arrays[i];\n        res.set(a, pad);\n        pad += a.length;\n    }\n    return res;\n}\n/** For runtime check if class implements interface */\nexport class Hash {\n    // Safe version that clones internal state\n    clone() {\n        return this._cloneInto();\n    }\n}\nexport function checkOpts(defaults, opts) {\n    if (opts !== undefined && {}.toString.call(opts) !== '[object Object]')\n        throw new Error('Options should be object or undefined');\n    const merged = Object.assign(defaults, opts);\n    return merged;\n}\n/** Wraps hash function, creating an interface on top of it */\nexport function wrapConstructor(hashCons) {\n    const hashC = (msg) => hashCons().update(toBytes(msg)).digest();\n    const tmp = hashCons();\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = () => hashCons();\n    return hashC;\n}\nexport function wrapConstructorWithOpts(hashCons) {\n    const hashC = (msg, opts) => hashCons(opts).update(toBytes(msg)).digest();\n    const tmp = hashCons({});\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = (opts) => hashCons(opts);\n    return hashC;\n}\nexport function wrapXOFConstructorWithOpts(hashCons) {\n    const hashC = (msg, opts) => hashCons(opts).update(toBytes(msg)).digest();\n    const tmp = hashCons({});\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = (opts) => hashCons(opts);\n    return hashC;\n}\n/** Cryptographically secure PRNG. Uses internal OS-level `crypto.getRandomValues`. */\nexport function randomBytes(bytesLength = 32) {\n    if (crypto && typeof crypto.getRandomValues === 'function') {\n        return crypto.getRandomValues(new Uint8Array(bytesLength));\n    }\n    // Legacy Node.js compatibility\n    if (crypto && typeof crypto.randomBytes === 'function') {\n        return Uint8Array.from(crypto.randomBytes(bytesLength));\n    }\n    throw new Error('crypto.getRandomValues must be defined');\n}\n","// Copyright 2018-2025 the Deno authors. MIT license.\nexport const alphabet = new TextEncoder().encode(\"0123456789abcdef\");\nexport const rAlphabet = new Uint8Array(128).fill(16); // alphabet.Hex.length\nalphabet.forEach((byte, i) => rAlphabet[byte] = i);\nnew TextEncoder()\n    .encode(\"ABCDEF\")\n    .forEach((byte, i) => rAlphabet[byte] = i + 10);\n/**\n * Calculate the output size needed to encode a given input size for\n * {@linkcode encodeRawHex}.\n *\n * @param originalSize The size of the input buffer.\n * @returns The size of the output buffer.\n *\n * @example Basic Usage\n * ```ts\n * import { assertEquals } from \"@std/assert\";\n * import { calcSizeHex } from \"@std/encoding/unstable-hex\";\n *\n * assertEquals(calcSizeHex(1), 2);\n * ```\n */\nexport function calcSizeHex(originalSize) {\n    return originalSize * 2;\n}\nexport function encode(buffer, i, o, alphabet) {\n    for (; i < buffer.length; ++i) {\n        const x = buffer[i];\n        buffer[o++] = alphabet[x >> 4];\n        buffer[o++] = alphabet[x & 0xF];\n    }\n    return o;\n}\nexport function decode(buffer, i, o, alphabet) {\n    if ((buffer.length - o) % 2 === 1) {\n        throw new RangeError(`Cannot decode input as hex: Length (${buffer.length - o}) must be divisible by 2`);\n    }\n    i += 1;\n    for (; i < buffer.length; i += 2) {\n        buffer[o++] = (getByte(buffer[i - 1], alphabet) << 4) |\n            getByte(buffer[i], alphabet);\n    }\n    return o;\n}\nfunction getByte(char, alphabet) {\n    const byte = alphabet[char] ?? 16;\n    if (byte === 16) { // alphabet.Hex.length\n        throw new TypeError(`Cannot decode input as hex: Invalid character (${String.fromCharCode(char)})`);\n    }\n    return byte;\n}\n","// Copyright 2009 The Go Authors. All rights reserved.\n// https://github.com/golang/go/blob/master/LICENSE\n// Copyright 2018-2025 the Deno authors. MIT license.\n// This module is browser compatible.\n/**\n * Port of the Go\n * {@link https://github.com/golang/go/blob/go1.12.5/src/encoding/hex/hex.go | encoding/hex}\n * library.\n *\n * ```ts\n * import {\n *   decodeHex,\n *   encodeHex,\n * } from \"@std/encoding/hex\";\n * import { assertEquals } from \"@std/assert\";\n *\n * assertEquals(encodeHex(\"abc\"), \"616263\");\n *\n * assertEquals(\n *   decodeHex(\"616263\"),\n *   new TextEncoder().encode(\"abc\"),\n * );\n * ```\n *\n * @module\n */\nimport { calcSizeHex, decode, encode } from \"./_common16.js\";\nimport { detach } from \"./_common_detach.js\";\nconst alphabet = new TextEncoder()\n    .encode(\"0123456789abcdef\");\nconst rAlphabet = new Uint8Array(128).fill(16); // alphabet.length\nalphabet.forEach((byte, i) => rAlphabet[byte] = i);\nnew TextEncoder()\n    .encode(\"ABCDEF\")\n    .forEach((byte, i) => rAlphabet[byte] = i + 10);\n/**\n * Converts data into a hex-encoded string.\n *\n * @param src The data to encode.\n *\n * @returns The hex-encoded string.\n *\n * @example Usage\n * ```ts\n * import { encodeHex } from \"@std/encoding/hex\";\n * import { assertEquals } from \"@std/assert\";\n *\n * assertEquals(encodeHex(\"abc\"), \"616263\");\n * ```\n */\nexport function encodeHex(src) {\n    if (typeof src === \"string\") {\n        src = new TextEncoder().encode(src);\n    }\n    else if (src instanceof ArrayBuffer)\n        src = new Uint8Array(src).slice();\n    else\n        src = src.slice();\n    const [output, i] = detach(src, calcSizeHex(src.length));\n    encode(output, i, 0, alphabet);\n    return new TextDecoder().decode(output);\n}\n/**\n * Decodes the given hex-encoded string. If the input is malformed, an error is\n * thrown.\n *\n * @param src The hex-encoded string to decode.\n *\n * @returns The decoded data.\n *\n * @example Usage\n * ```ts\n * import { decodeHex } from \"@std/encoding/hex\";\n * import { assertEquals } from \"@std/assert\";\n *\n * assertEquals(\n *   decodeHex(\"616263\"),\n *   new TextEncoder().encode(\"abc\"),\n * );\n * ```\n */\nexport function decodeHex(src) {\n    const output = new TextEncoder().encode(src);\n    // deno-lint-ignore no-explicit-any\n    return new Uint8Array(output.buffer\n        .transfer(decode(output, 0, 0, rAlphabet)));\n}\n","import { head, second, wrapArray } from \"./array.js\";\nimport { applyTo, identity, pipe } from \"./composition.js\";\nimport { filter } from \"./filter.js\";\nimport { stack } from \"./juxt.js\";\nimport { map } from \"./map.js\";\nimport { reduce } from \"./reduce.js\";\nexport const wrapObject = (key) => (value) => ({ [key]: value });\nexport const groupByManyReduce = (keys, reducer, initial) => (it) => {\n    const result = {};\n    for (const x of it) {\n        for (const key of keys(x)) {\n            result[key] = reducer(key in result ? result[key] : initial(), x);\n        }\n    }\n    return result;\n};\nexport const count = reduce((counts, element) => {\n    counts[element] = (counts[element] || 0) + 1;\n    return counts;\n}, () => ({}));\nexport const groupByReduce = (key, reducer, initial) => \n// @ts-expect-error reason: TODO - fix typing\ngroupByManyReduce(pipe(key, wrapArray), reducer, initial);\nexport const groupByMany = (keys) => groupByManyReduce(keys, (s, x) => {\n    s.push(x);\n    return s;\n}, () => []);\nexport const addEntry = (key, value) => (obj) => ({\n    ...obj,\n    [key]: value,\n});\nexport const groupBy = (f) => \n// @ts-expect-error reason: TODO - fix typing\ngroupByMany(pipe(f, wrapArray));\nexport const edgesToGraph = groupByReduce(head, (s, [_, destination]) => {\n    s.add(destination);\n    return s;\n}, () => new Set());\nconst onEntries = (transformation) => \n// @ts-expect-error: too hard\npipe(Object.entries, \n// @ts-expect-error: too hard\ntransformation, Object.fromEntries);\nexport const entryMap = pipe(map, onEntries);\nexport const entryFilter = pipe(filter, onEntries);\nexport const valFilter = (f) => \n// @ts-expect-error can't infer typing here\nentryFilter(pipe(second, f));\nexport const keyFilter = (f) => \n// @ts-expect-error can't infer typing here\nentryFilter(pipe(head, f));\nexport const valMap = (f) => \n// @ts-expect-error can't infer typing here\nentryMap(stack(identity, f));\nexport const keyMap = (f) => \n// @ts-expect-error can't infer typing here\nentryMap(stack(f, identity));\nexport const mapTerminals = (terminalMapper) => (obj) => Array.isArray(obj)\n    ? map(mapTerminals(terminalMapper))(obj)\n    : typeof obj === \"object\" && !(obj instanceof Function)\n        // @ts-expect-error too complicated\n        ? valMap(mapTerminals(terminalMapper))(obj)\n        : terminalMapper(obj);\nexport const applySpec = (spec) => (...args) => \n// @ts-expect-error too to bother.\nmapTerminals(applyTo(...args))(spec);\n","'use strict'\n\nconst { hasOwnProperty } = Object.prototype\n\nconst stringify = configure()\n\n// @ts-expect-error\nstringify.configure = configure\n// @ts-expect-error\nstringify.stringify = stringify\n\n// @ts-expect-error\nstringify.default = stringify\n\n// @ts-expect-error used for named export\nexports.stringify = stringify\n// @ts-expect-error used for named export\nexports.configure = configure\n\nmodule.exports = stringify\n\n// eslint-disable-next-line no-control-regex\nconst strEscapeSequencesRegExp = /[\\u0000-\\u001f\\u0022\\u005c\\ud800-\\udfff]/\n\n// Escape C0 control characters, double quotes, the backslash and every code\n// unit with a numeric value in the inclusive range 0xD800 to 0xDFFF.\nfunction strEscape (str) {\n  // Some magic numbers that worked out fine while benchmarking with v8 8.0\n  if (str.length < 5000 && !strEscapeSequencesRegExp.test(str)) {\n    return `\"${str}\"`\n  }\n  return JSON.stringify(str)\n}\n\nfunction sort (array, comparator) {\n  // Insertion sort is very efficient for small input sizes, but it has a bad\n  // worst case complexity. Thus, use native array sort for bigger values.\n  if (array.length > 2e2 || comparator) {\n    return array.sort(comparator)\n  }\n  for (let i = 1; i < array.length; i++) {\n    const currentValue = array[i]\n    let position = i\n    while (position !== 0 && array[position - 1] > currentValue) {\n      array[position] = array[position - 1]\n      position--\n    }\n    array[position] = currentValue\n  }\n  return array\n}\n\nconst typedArrayPrototypeGetSymbolToStringTag =\n  Object.getOwnPropertyDescriptor(\n    Object.getPrototypeOf(\n      Object.getPrototypeOf(\n        new Int8Array()\n      )\n    ),\n    Symbol.toStringTag\n  ).get\n\nfunction isTypedArrayWithEntries (value) {\n  return typedArrayPrototypeGetSymbolToStringTag.call(value) !== undefined && value.length !== 0\n}\n\nfunction stringifyTypedArray (array, separator, maximumBreadth) {\n  if (array.length < maximumBreadth) {\n    maximumBreadth = array.length\n  }\n  const whitespace = separator === ',' ? '' : ' '\n  let res = `\"0\":${whitespace}${array[0]}`\n  for (let i = 1; i < maximumBreadth; i++) {\n    res += `${separator}\"${i}\":${whitespace}${array[i]}`\n  }\n  return res\n}\n\nfunction getCircularValueOption (options) {\n  if (hasOwnProperty.call(options, 'circularValue')) {\n    const circularValue = options.circularValue\n    if (typeof circularValue === 'string') {\n      return `\"${circularValue}\"`\n    }\n    if (circularValue == null) {\n      return circularValue\n    }\n    if (circularValue === Error || circularValue === TypeError) {\n      return {\n        toString () {\n          throw new TypeError('Converting circular structure to JSON')\n        }\n      }\n    }\n    throw new TypeError('The \"circularValue\" argument must be of type string or the value null or undefined')\n  }\n  return '\"[Circular]\"'\n}\n\nfunction getDeterministicOption (options) {\n  let value\n  if (hasOwnProperty.call(options, 'deterministic')) {\n    value = options.deterministic\n    if (typeof value !== 'boolean' && typeof value !== 'function') {\n      throw new TypeError('The \"deterministic\" argument must be of type boolean or comparator function')\n    }\n  }\n  return value === undefined ? true : value\n}\n\nfunction getBooleanOption (options, key) {\n  let value\n  if (hasOwnProperty.call(options, key)) {\n    value = options[key]\n    if (typeof value !== 'boolean') {\n      throw new TypeError(`The \"${key}\" argument must be of type boolean`)\n    }\n  }\n  return value === undefined ? true : value\n}\n\nfunction getPositiveIntegerOption (options, key) {\n  let value\n  if (hasOwnProperty.call(options, key)) {\n    value = options[key]\n    if (typeof value !== 'number') {\n      throw new TypeError(`The \"${key}\" argument must be of type number`)\n    }\n    if (!Number.isInteger(value)) {\n      throw new TypeError(`The \"${key}\" argument must be an integer`)\n    }\n    if (value < 1) {\n      throw new RangeError(`The \"${key}\" argument must be >= 1`)\n    }\n  }\n  return value === undefined ? Infinity : value\n}\n\nfunction getItemCount (number) {\n  if (number === 1) {\n    return '1 item'\n  }\n  return `${number} items`\n}\n\nfunction getUniqueReplacerSet (replacerArray) {\n  const replacerSet = new Set()\n  for (const value of replacerArray) {\n    if (typeof value === 'string' || typeof value === 'number') {\n      replacerSet.add(String(value))\n    }\n  }\n  return replacerSet\n}\n\nfunction getStrictOption (options) {\n  if (hasOwnProperty.call(options, 'strict')) {\n    const value = options.strict\n    if (typeof value !== 'boolean') {\n      throw new TypeError('The \"strict\" argument must be of type boolean')\n    }\n    if (value) {\n      return (value) => {\n        let message = `Object can not safely be stringified. Received type ${typeof value}`\n        if (typeof value !== 'function') message += ` (${value.toString()})`\n        throw new Error(message)\n      }\n    }\n  }\n}\n\nfunction configure (options) {\n  options = { ...options }\n  const fail = getStrictOption(options)\n  if (fail) {\n    if (options.bigint === undefined) {\n      options.bigint = false\n    }\n    if (!('circularValue' in options)) {\n      options.circularValue = Error\n    }\n  }\n  const circularValue = getCircularValueOption(options)\n  const bigint = getBooleanOption(options, 'bigint')\n  const deterministic = getDeterministicOption(options)\n  const comparator = typeof deterministic === 'function' ? deterministic : undefined\n  const maximumDepth = getPositiveIntegerOption(options, 'maximumDepth')\n  const maximumBreadth = getPositiveIntegerOption(options, 'maximumBreadth')\n\n  function stringifyFnReplacer (key, parent, stack, replacer, spacer, indentation) {\n    let value = parent[key]\n\n    if (typeof value === 'object' && value !== null && typeof value.toJSON === 'function') {\n      value = value.toJSON(key)\n    }\n    value = replacer.call(parent, key, value)\n\n    switch (typeof value) {\n      case 'string':\n        return strEscape(value)\n      case 'object': {\n        if (value === null) {\n          return 'null'\n        }\n        if (stack.indexOf(value) !== -1) {\n          return circularValue\n        }\n\n        let res = ''\n        let join = ','\n        const originalIndentation = indentation\n\n        if (Array.isArray(value)) {\n          if (value.length === 0) {\n            return '[]'\n          }\n          if (maximumDepth < stack.length + 1) {\n            return '\"[Array]\"'\n          }\n          stack.push(value)\n          if (spacer !== '') {\n            indentation += spacer\n            res += `\\n${indentation}`\n            join = `,\\n${indentation}`\n          }\n          const maximumValuesToStringify = Math.min(value.length, maximumBreadth)\n          let i = 0\n          for (; i < maximumValuesToStringify - 1; i++) {\n            const tmp = stringifyFnReplacer(String(i), value, stack, replacer, spacer, indentation)\n            res += tmp !== undefined ? tmp : 'null'\n            res += join\n          }\n          const tmp = stringifyFnReplacer(String(i), value, stack, replacer, spacer, indentation)\n          res += tmp !== undefined ? tmp : 'null'\n          if (value.length - 1 > maximumBreadth) {\n            const removedKeys = value.length - maximumBreadth - 1\n            res += `${join}\"... ${getItemCount(removedKeys)} not stringified\"`\n          }\n          if (spacer !== '') {\n            res += `\\n${originalIndentation}`\n          }\n          stack.pop()\n          return `[${res}]`\n        }\n\n        let keys = Object.keys(value)\n        const keyLength = keys.length\n        if (keyLength === 0) {\n          return '{}'\n        }\n        if (maximumDepth < stack.length + 1) {\n          return '\"[Object]\"'\n        }\n        let whitespace = ''\n        let separator = ''\n        if (spacer !== '') {\n          indentation += spacer\n          join = `,\\n${indentation}`\n          whitespace = ' '\n        }\n        const maximumPropertiesToStringify = Math.min(keyLength, maximumBreadth)\n        if (deterministic && !isTypedArrayWithEntries(value)) {\n          keys = sort(keys, comparator)\n        }\n        stack.push(value)\n        for (let i = 0; i < maximumPropertiesToStringify; i++) {\n          const key = keys[i]\n          const tmp = stringifyFnReplacer(key, value, stack, replacer, spacer, indentation)\n          if (tmp !== undefined) {\n            res += `${separator}${strEscape(key)}:${whitespace}${tmp}`\n            separator = join\n          }\n        }\n        if (keyLength > maximumBreadth) {\n          const removedKeys = keyLength - maximumBreadth\n          res += `${separator}\"...\":${whitespace}\"${getItemCount(removedKeys)} not stringified\"`\n          separator = join\n        }\n        if (spacer !== '' && separator.length > 1) {\n          res = `\\n${indentation}${res}\\n${originalIndentation}`\n        }\n        stack.pop()\n        return `{${res}}`\n      }\n      case 'number':\n        return isFinite(value) ? String(value) : fail ? fail(value) : 'null'\n      case 'boolean':\n        return value === true ? 'true' : 'false'\n      case 'undefined':\n        return undefined\n      case 'bigint':\n        if (bigint) {\n          return String(value)\n        }\n        // fallthrough\n      default:\n        return fail ? fail(value) : undefined\n    }\n  }\n\n  function stringifyArrayReplacer (key, value, stack, replacer, spacer, indentation) {\n    if (typeof value === 'object' && value !== null && typeof value.toJSON === 'function') {\n      value = value.toJSON(key)\n    }\n\n    switch (typeof value) {\n      case 'string':\n        return strEscape(value)\n      case 'object': {\n        if (value === null) {\n          return 'null'\n        }\n        if (stack.indexOf(value) !== -1) {\n          return circularValue\n        }\n\n        const originalIndentation = indentation\n        let res = ''\n        let join = ','\n\n        if (Array.isArray(value)) {\n          if (value.length === 0) {\n            return '[]'\n          }\n          if (maximumDepth < stack.length + 1) {\n            return '\"[Array]\"'\n          }\n          stack.push(value)\n          if (spacer !== '') {\n            indentation += spacer\n            res += `\\n${indentation}`\n            join = `,\\n${indentation}`\n          }\n          const maximumValuesToStringify = Math.min(value.length, maximumBreadth)\n          let i = 0\n          for (; i < maximumValuesToStringify - 1; i++) {\n            const tmp = stringifyArrayReplacer(String(i), value[i], stack, replacer, spacer, indentation)\n            res += tmp !== undefined ? tmp : 'null'\n            res += join\n          }\n          const tmp = stringifyArrayReplacer(String(i), value[i], stack, replacer, spacer, indentation)\n          res += tmp !== undefined ? tmp : 'null'\n          if (value.length - 1 > maximumBreadth) {\n            const removedKeys = value.length - maximumBreadth - 1\n            res += `${join}\"... ${getItemCount(removedKeys)} not stringified\"`\n          }\n          if (spacer !== '') {\n            res += `\\n${originalIndentation}`\n          }\n          stack.pop()\n          return `[${res}]`\n        }\n        stack.push(value)\n        let whitespace = ''\n        if (spacer !== '') {\n          indentation += spacer\n          join = `,\\n${indentation}`\n          whitespace = ' '\n        }\n        let separator = ''\n        for (const key of replacer) {\n          const tmp = stringifyArrayReplacer(key, value[key], stack, replacer, spacer, indentation)\n          if (tmp !== undefined) {\n            res += `${separator}${strEscape(key)}:${whitespace}${tmp}`\n            separator = join\n          }\n        }\n        if (spacer !== '' && separator.length > 1) {\n          res = `\\n${indentation}${res}\\n${originalIndentation}`\n        }\n        stack.pop()\n        return `{${res}}`\n      }\n      case 'number':\n        return isFinite(value) ? String(value) : fail ? fail(value) : 'null'\n      case 'boolean':\n        return value === true ? 'true' : 'false'\n      case 'undefined':\n        return undefined\n      case 'bigint':\n        if (bigint) {\n          return String(value)\n        }\n        // fallthrough\n      default:\n        return fail ? fail(value) : undefined\n    }\n  }\n\n  function stringifyIndent (key, value, stack, spacer, indentation) {\n    switch (typeof value) {\n      case 'string':\n        return strEscape(value)\n      case 'object': {\n        if (value === null) {\n          return 'null'\n        }\n        if (typeof value.toJSON === 'function') {\n          value = value.toJSON(key)\n          // Prevent calling `toJSON` again.\n          if (typeof value !== 'object') {\n            return stringifyIndent(key, value, stack, spacer, indentation)\n          }\n          if (value === null) {\n            return 'null'\n          }\n        }\n        if (stack.indexOf(value) !== -1) {\n          return circularValue\n        }\n        const originalIndentation = indentation\n\n        if (Array.isArray(value)) {\n          if (value.length === 0) {\n            return '[]'\n          }\n          if (maximumDepth < stack.length + 1) {\n            return '\"[Array]\"'\n          }\n          stack.push(value)\n          indentation += spacer\n          let res = `\\n${indentation}`\n          const join = `,\\n${indentation}`\n          const maximumValuesToStringify = Math.min(value.length, maximumBreadth)\n          let i = 0\n          for (; i < maximumValuesToStringify - 1; i++) {\n            const tmp = stringifyIndent(String(i), value[i], stack, spacer, indentation)\n            res += tmp !== undefined ? tmp : 'null'\n            res += join\n          }\n          const tmp = stringifyIndent(String(i), value[i], stack, spacer, indentation)\n          res += tmp !== undefined ? tmp : 'null'\n          if (value.length - 1 > maximumBreadth) {\n            const removedKeys = value.length - maximumBreadth - 1\n            res += `${join}\"... ${getItemCount(removedKeys)} not stringified\"`\n          }\n          res += `\\n${originalIndentation}`\n          stack.pop()\n          return `[${res}]`\n        }\n\n        let keys = Object.keys(value)\n        const keyLength = keys.length\n        if (keyLength === 0) {\n          return '{}'\n        }\n        if (maximumDepth < stack.length + 1) {\n          return '\"[Object]\"'\n        }\n        indentation += spacer\n        const join = `,\\n${indentation}`\n        let res = ''\n        let separator = ''\n        let maximumPropertiesToStringify = Math.min(keyLength, maximumBreadth)\n        if (isTypedArrayWithEntries(value)) {\n          res += stringifyTypedArray(value, join, maximumBreadth)\n          keys = keys.slice(value.length)\n          maximumPropertiesToStringify -= value.length\n          separator = join\n        }\n        if (deterministic) {\n          keys = sort(keys, comparator)\n        }\n        stack.push(value)\n        for (let i = 0; i < maximumPropertiesToStringify; i++) {\n          const key = keys[i]\n          const tmp = stringifyIndent(key, value[key], stack, spacer, indentation)\n          if (tmp !== undefined) {\n            res += `${separator}${strEscape(key)}: ${tmp}`\n            separator = join\n          }\n        }\n        if (keyLength > maximumBreadth) {\n          const removedKeys = keyLength - maximumBreadth\n          res += `${separator}\"...\": \"${getItemCount(removedKeys)} not stringified\"`\n          separator = join\n        }\n        if (separator !== '') {\n          res = `\\n${indentation}${res}\\n${originalIndentation}`\n        }\n        stack.pop()\n        return `{${res}}`\n      }\n      case 'number':\n        return isFinite(value) ? String(value) : fail ? fail(value) : 'null'\n      case 'boolean':\n        return value === true ? 'true' : 'false'\n      case 'undefined':\n        return undefined\n      case 'bigint':\n        if (bigint) {\n          return String(value)\n        }\n        // fallthrough\n      default:\n        return fail ? fail(value) : undefined\n    }\n  }\n\n  function stringifySimple (key, value, stack) {\n    switch (typeof value) {\n      case 'string':\n        return strEscape(value)\n      case 'object': {\n        if (value === null) {\n          return 'null'\n        }\n        if (typeof value.toJSON === 'function') {\n          value = value.toJSON(key)\n          // Prevent calling `toJSON` again\n          if (typeof value !== 'object') {\n            return stringifySimple(key, value, stack)\n          }\n          if (value === null) {\n            return 'null'\n          }\n        }\n        if (stack.indexOf(value) !== -1) {\n          return circularValue\n        }\n\n        let res = ''\n\n        const hasLength = value.length !== undefined\n        if (hasLength && Array.isArray(value)) {\n          if (value.length === 0) {\n            return '[]'\n          }\n          if (maximumDepth < stack.length + 1) {\n            return '\"[Array]\"'\n          }\n          stack.push(value)\n          const maximumValuesToStringify = Math.min(value.length, maximumBreadth)\n          let i = 0\n          for (; i < maximumValuesToStringify - 1; i++) {\n            const tmp = stringifySimple(String(i), value[i], stack)\n            res += tmp !== undefined ? tmp : 'null'\n            res += ','\n          }\n          const tmp = stringifySimple(String(i), value[i], stack)\n          res += tmp !== undefined ? tmp : 'null'\n          if (value.length - 1 > maximumBreadth) {\n            const removedKeys = value.length - maximumBreadth - 1\n            res += `,\"... ${getItemCount(removedKeys)} not stringified\"`\n          }\n          stack.pop()\n          return `[${res}]`\n        }\n\n        let keys = Object.keys(value)\n        const keyLength = keys.length\n        if (keyLength === 0) {\n          return '{}'\n        }\n        if (maximumDepth < stack.length + 1) {\n          return '\"[Object]\"'\n        }\n        let separator = ''\n        let maximumPropertiesToStringify = Math.min(keyLength, maximumBreadth)\n        if (hasLength && isTypedArrayWithEntries(value)) {\n          res += stringifyTypedArray(value, ',', maximumBreadth)\n          keys = keys.slice(value.length)\n          maximumPropertiesToStringify -= value.length\n          separator = ','\n        }\n        if (deterministic) {\n          keys = sort(keys, comparator)\n        }\n        stack.push(value)\n        for (let i = 0; i < maximumPropertiesToStringify; i++) {\n          const key = keys[i]\n          const tmp = stringifySimple(key, value[key], stack)\n          if (tmp !== undefined) {\n            res += `${separator}${strEscape(key)}:${tmp}`\n            separator = ','\n          }\n        }\n        if (keyLength > maximumBreadth) {\n          const removedKeys = keyLength - maximumBreadth\n          res += `${separator}\"...\":\"${getItemCount(removedKeys)} not stringified\"`\n        }\n        stack.pop()\n        return `{${res}}`\n      }\n      case 'number':\n        return isFinite(value) ? String(value) : fail ? fail(value) : 'null'\n      case 'boolean':\n        return value === true ? 'true' : 'false'\n      case 'undefined':\n        return undefined\n      case 'bigint':\n        if (bigint) {\n          return String(value)\n        }\n        // fallthrough\n      default:\n        return fail ? fail(value) : undefined\n    }\n  }\n\n  function stringify (value, replacer, space) {\n    if (arguments.length > 1) {\n      let spacer = ''\n      if (typeof space === 'number') {\n        spacer = ' '.repeat(Math.min(space, 10))\n      } else if (typeof space === 'string') {\n        spacer = space.slice(0, 10)\n      }\n      if (replacer != null) {\n        if (typeof replacer === 'function') {\n          return stringifyFnReplacer('', { '': value }, [], replacer, spacer, '')\n        }\n        if (Array.isArray(replacer)) {\n          return stringifyArrayReplacer('', value, [], getUniqueReplacerSet(replacer), spacer, '')\n        }\n      }\n      if (spacer.length !== 0) {\n        return stringifyIndent('', value, [], spacer, '')\n      }\n    }\n    return stringifySimple('', value, [])\n  }\n\n  return stringify\n}\n","import cjsModule from '../index.js'\n\nexport const configure = cjsModule.configure\n\nexport const stringify = cjsModule\nexport default cjsModule\n","'use strict'\n\nexports.byteLength = byteLength\nexports.toByteArray = toByteArray\nexports.fromByteArray = fromByteArray\n\nvar lookup = []\nvar revLookup = []\nvar Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array\n\nvar code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'\nfor (var i = 0, len = code.length; i < len; ++i) {\n  lookup[i] = code[i]\n  revLookup[code.charCodeAt(i)] = i\n}\n\n// Support decoding URL-safe base64 strings, as Node.js does.\n// See: https://en.wikipedia.org/wiki/Base64#URL_applications\nrevLookup['-'.charCodeAt(0)] = 62\nrevLookup['_'.charCodeAt(0)] = 63\n\nfunction getLens (b64) {\n  var len = b64.length\n\n  if (len % 4 > 0) {\n    throw new Error('Invalid string. Length must be a multiple of 4')\n  }\n\n  // Trim off extra bytes after placeholder bytes are found\n  // See: https://github.com/beatgammit/base64-js/issues/42\n  var validLen = b64.indexOf('=')\n  if (validLen === -1) validLen = len\n\n  var placeHoldersLen = validLen === len\n    ? 0\n    : 4 - (validLen % 4)\n\n  return [validLen, placeHoldersLen]\n}\n\n// base64 is 4/3 + up to two characters of the original data\nfunction byteLength (b64) {\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction _byteLength (b64, validLen, placeHoldersLen) {\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction toByteArray (b64) {\n  var tmp\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n\n  var arr = new Arr(_byteLength(b64, validLen, placeHoldersLen))\n\n  var curByte = 0\n\n  // if there are placeholders, only get up to the last complete 4 chars\n  var len = placeHoldersLen > 0\n    ? validLen - 4\n    : validLen\n\n  var i\n  for (i = 0; i < len; i += 4) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 18) |\n      (revLookup[b64.charCodeAt(i + 1)] << 12) |\n      (revLookup[b64.charCodeAt(i + 2)] << 6) |\n      revLookup[b64.charCodeAt(i + 3)]\n    arr[curByte++] = (tmp >> 16) & 0xFF\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 2) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 2) |\n      (revLookup[b64.charCodeAt(i + 1)] >> 4)\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 1) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 10) |\n      (revLookup[b64.charCodeAt(i + 1)] << 4) |\n      (revLookup[b64.charCodeAt(i + 2)] >> 2)\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  return arr\n}\n\nfunction tripletToBase64 (num) {\n  return lookup[num >> 18 & 0x3F] +\n    lookup[num >> 12 & 0x3F] +\n    lookup[num >> 6 & 0x3F] +\n    lookup[num & 0x3F]\n}\n\nfunction encodeChunk (uint8, start, end) {\n  var tmp\n  var output = []\n  for (var i = start; i < end; i += 3) {\n    tmp =\n      ((uint8[i] << 16) & 0xFF0000) +\n      ((uint8[i + 1] << 8) & 0xFF00) +\n      (uint8[i + 2] & 0xFF)\n    output.push(tripletToBase64(tmp))\n  }\n  return output.join('')\n}\n\nfunction fromByteArray (uint8) {\n  var tmp\n  var len = uint8.length\n  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes\n  var parts = []\n  var maxChunkLength = 16383 // must be multiple of 3\n\n  // go through the array every three bytes, we'll deal with trailing stuff later\n  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {\n    parts.push(encodeChunk(uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)))\n  }\n\n  // pad the end with zeros, but make sure to not forget the extra bytes\n  if (extraBytes === 1) {\n    tmp = uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 2] +\n      lookup[(tmp << 4) & 0x3F] +\n      '=='\n    )\n  } else if (extraBytes === 2) {\n    tmp = (uint8[len - 2] << 8) + uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 10] +\n      lookup[(tmp >> 4) & 0x3F] +\n      lookup[(tmp << 2) & 0x3F] +\n      '='\n    )\n  }\n\n  return parts.join('')\n}\n","/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */\nexports.read = function (buffer, offset, isLE, mLen, nBytes) {\n  var e, m\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var nBits = -7\n  var i = isLE ? (nBytes - 1) : 0\n  var d = isLE ? -1 : 1\n  var s = buffer[offset + i]\n\n  i += d\n\n  e = s & ((1 << (-nBits)) - 1)\n  s >>= (-nBits)\n  nBits += eLen\n  for (; nBits > 0; e = (e * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  m = e & ((1 << (-nBits)) - 1)\n  e >>= (-nBits)\n  nBits += mLen\n  for (; nBits > 0; m = (m * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  if (e === 0) {\n    e = 1 - eBias\n  } else if (e === eMax) {\n    return m ? NaN : ((s ? -1 : 1) * Infinity)\n  } else {\n    m = m + Math.pow(2, mLen)\n    e = e - eBias\n  }\n  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)\n}\n\nexports.write = function (buffer, value, offset, isLE, mLen, nBytes) {\n  var e, m, c\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)\n  var i = isLE ? 0 : (nBytes - 1)\n  var d = isLE ? 1 : -1\n  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0\n\n  value = Math.abs(value)\n\n  if (isNaN(value) || value === Infinity) {\n    m = isNaN(value) ? 1 : 0\n    e = eMax\n  } else {\n    e = Math.floor(Math.log(value) / Math.LN2)\n    if (value * (c = Math.pow(2, -e)) < 1) {\n      e--\n      c *= 2\n    }\n    if (e + eBias >= 1) {\n      value += rt / c\n    } else {\n      value += rt * Math.pow(2, 1 - eBias)\n    }\n    if (value * c >= 2) {\n      e++\n      c /= 2\n    }\n\n    if (e + eBias >= eMax) {\n      m = 0\n      e = eMax\n    } else if (e + eBias >= 1) {\n      m = ((value * c) - 1) * Math.pow(2, mLen)\n      e = e + eBias\n    } else {\n      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)\n      e = 0\n    }\n  }\n\n  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}\n\n  e = (e << mLen) | m\n  eLen += mLen\n  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}\n\n  buffer[offset + i - d] |= s * 128\n}\n","/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <https://feross.org>\n * @license  MIT\n */\n/* eslint-disable no-proto */\n\n'use strict'\n\nconst base64 = require('base64-js')\nconst ieee754 = require('ieee754')\nconst customInspectSymbol =\n  (typeof Symbol === 'function' && typeof Symbol['for'] === 'function') // eslint-disable-line dot-notation\n    ? Symbol['for']('nodejs.util.inspect.custom') // eslint-disable-line dot-notation\n    : null\n\nexports.Buffer = Buffer\nexports.SlowBuffer = SlowBuffer\nexports.INSPECT_MAX_BYTES = 50\n\nconst K_MAX_LENGTH = 0x7fffffff\nexports.kMaxLength = K_MAX_LENGTH\n\n/**\n * If `Buffer.TYPED_ARRAY_SUPPORT`:\n *   === true    Use Uint8Array implementation (fastest)\n *   === false   Print warning and recommend using `buffer` v4.x which has an Object\n *               implementation (most compatible, even IE6)\n *\n * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,\n * Opera 11.6+, iOS 4.2+.\n *\n * We report that the browser does not support typed arrays if the are not subclassable\n * using __proto__. Firefox 4-29 lacks support for adding new properties to `Uint8Array`\n * (See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438). IE 10 lacks support\n * for __proto__ and has a buggy typed array implementation.\n */\nBuffer.TYPED_ARRAY_SUPPORT = typedArraySupport()\n\nif (!Buffer.TYPED_ARRAY_SUPPORT && typeof console !== 'undefined' &&\n    typeof console.error === 'function') {\n  console.error(\n    'This browser lacks typed array (Uint8Array) support which is required by ' +\n    '`buffer` v5.x. Use `buffer` v4.x if you require old browser support.'\n  )\n}\n\nfunction typedArraySupport () {\n  // Can typed array instances can be augmented?\n  try {\n    const arr = new Uint8Array(1)\n    const proto = { foo: function () { return 42 } }\n    Object.setPrototypeOf(proto, Uint8Array.prototype)\n    Object.setPrototypeOf(arr, proto)\n    return arr.foo() === 42\n  } catch (e) {\n    return false\n  }\n}\n\nObject.defineProperty(Buffer.prototype, 'parent', {\n  enumerable: true,\n  get: function () {\n    if (!Buffer.isBuffer(this)) return undefined\n    return this.buffer\n  }\n})\n\nObject.defineProperty(Buffer.prototype, 'offset', {\n  enumerable: true,\n  get: function () {\n    if (!Buffer.isBuffer(this)) return undefined\n    return this.byteOffset\n  }\n})\n\nfunction createBuffer (length) {\n  if (length > K_MAX_LENGTH) {\n    throw new RangeError('The value \"' + length + '\" is invalid for option \"size\"')\n  }\n  // Return an augmented `Uint8Array` instance\n  const buf = new Uint8Array(length)\n  Object.setPrototypeOf(buf, Buffer.prototype)\n  return buf\n}\n\n/**\n * The Buffer constructor returns instances of `Uint8Array` that have their\n * prototype changed to `Buffer.prototype`. Furthermore, `Buffer` is a subclass of\n * `Uint8Array`, so the returned instances will have all the node `Buffer` methods\n * and the `Uint8Array` methods. Square bracket notation works as expected -- it\n * returns a single octet.\n *\n * The `Uint8Array` prototype remains unmodified.\n */\n\nfunction Buffer (arg, encodingOrOffset, length) {\n  // Common case.\n  if (typeof arg === 'number') {\n    if (typeof encodingOrOffset === 'string') {\n      throw new TypeError(\n        'The \"string\" argument must be of type string. Received type number'\n      )\n    }\n    return allocUnsafe(arg)\n  }\n  return from(arg, encodingOrOffset, length)\n}\n\nBuffer.poolSize = 8192 // not used by this implementation\n\nfunction from (value, encodingOrOffset, length) {\n  if (typeof value === 'string') {\n    return fromString(value, encodingOrOffset)\n  }\n\n  if (ArrayBuffer.isView(value)) {\n    return fromArrayView(value)\n  }\n\n  if (value == null) {\n    throw new TypeError(\n      'The first argument must be one of type string, Buffer, ArrayBuffer, Array, ' +\n      'or Array-like Object. Received type ' + (typeof value)\n    )\n  }\n\n  if (isInstance(value, ArrayBuffer) ||\n      (value && isInstance(value.buffer, ArrayBuffer))) {\n    return fromArrayBuffer(value, encodingOrOffset, length)\n  }\n\n  if (typeof SharedArrayBuffer !== 'undefined' &&\n      (isInstance(value, SharedArrayBuffer) ||\n      (value && isInstance(value.buffer, SharedArrayBuffer)))) {\n    return fromArrayBuffer(value, encodingOrOffset, length)\n  }\n\n  if (typeof value === 'number') {\n    throw new TypeError(\n      'The \"value\" argument must not be of type number. Received type number'\n    )\n  }\n\n  const valueOf = value.valueOf && value.valueOf()\n  if (valueOf != null && valueOf !== value) {\n    return Buffer.from(valueOf, encodingOrOffset, length)\n  }\n\n  const b = fromObject(value)\n  if (b) return b\n\n  if (typeof Symbol !== 'undefined' && Symbol.toPrimitive != null &&\n      typeof value[Symbol.toPrimitive] === 'function') {\n    return Buffer.from(value[Symbol.toPrimitive]('string'), encodingOrOffset, length)\n  }\n\n  throw new TypeError(\n    'The first argument must be one of type string, Buffer, ArrayBuffer, Array, ' +\n    'or Array-like Object. Received type ' + (typeof value)\n  )\n}\n\n/**\n * Functionally equivalent to Buffer(arg, encoding) but throws a TypeError\n * if value is a number.\n * Buffer.from(str[, encoding])\n * Buffer.from(array)\n * Buffer.from(buffer)\n * Buffer.from(arrayBuffer[, byteOffset[, length]])\n **/\nBuffer.from = function (value, encodingOrOffset, length) {\n  return from(value, encodingOrOffset, length)\n}\n\n// Note: Change prototype *after* Buffer.from is defined to workaround Chrome bug:\n// https://github.com/feross/buffer/pull/148\nObject.setPrototypeOf(Buffer.prototype, Uint8Array.prototype)\nObject.setPrototypeOf(Buffer, Uint8Array)\n\nfunction assertSize (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('\"size\" argument must be of type number')\n  } else if (size < 0) {\n    throw new RangeError('The value \"' + size + '\" is invalid for option \"size\"')\n  }\n}\n\nfunction alloc (size, fill, encoding) {\n  assertSize(size)\n  if (size <= 0) {\n    return createBuffer(size)\n  }\n  if (fill !== undefined) {\n    // Only pay attention to encoding if it's a string. This\n    // prevents accidentally sending in a number that would\n    // be interpreted as a start offset.\n    return typeof encoding === 'string'\n      ? createBuffer(size).fill(fill, encoding)\n      : createBuffer(size).fill(fill)\n  }\n  return createBuffer(size)\n}\n\n/**\n * Creates a new filled Buffer instance.\n * alloc(size[, fill[, encoding]])\n **/\nBuffer.alloc = function (size, fill, encoding) {\n  return alloc(size, fill, encoding)\n}\n\nfunction allocUnsafe (size) {\n  assertSize(size)\n  return createBuffer(size < 0 ? 0 : checked(size) | 0)\n}\n\n/**\n * Equivalent to Buffer(num), by default creates a non-zero-filled Buffer instance.\n * */\nBuffer.allocUnsafe = function (size) {\n  return allocUnsafe(size)\n}\n/**\n * Equivalent to SlowBuffer(num), by default creates a non-zero-filled Buffer instance.\n */\nBuffer.allocUnsafeSlow = function (size) {\n  return allocUnsafe(size)\n}\n\nfunction fromString (string, encoding) {\n  if (typeof encoding !== 'string' || encoding === '') {\n    encoding = 'utf8'\n  }\n\n  if (!Buffer.isEncoding(encoding)) {\n    throw new TypeError('Unknown encoding: ' + encoding)\n  }\n\n  const length = byteLength(string, encoding) | 0\n  let buf = createBuffer(length)\n\n  const actual = buf.write(string, encoding)\n\n  if (actual !== length) {\n    // Writing a hex string, for example, that contains invalid characters will\n    // cause everything after the first invalid character to be ignored. (e.g.\n    // 'abxxcd' will be treated as 'ab')\n    buf = buf.slice(0, actual)\n  }\n\n  return buf\n}\n\nfunction fromArrayLike (array) {\n  const length = array.length < 0 ? 0 : checked(array.length) | 0\n  const buf = createBuffer(length)\n  for (let i = 0; i < length; i += 1) {\n    buf[i] = array[i] & 255\n  }\n  return buf\n}\n\nfunction fromArrayView (arrayView) {\n  if (isInstance(arrayView, Uint8Array)) {\n    const copy = new Uint8Array(arrayView)\n    return fromArrayBuffer(copy.buffer, copy.byteOffset, copy.byteLength)\n  }\n  return fromArrayLike(arrayView)\n}\n\nfunction fromArrayBuffer (array, byteOffset, length) {\n  if (byteOffset < 0 || array.byteLength < byteOffset) {\n    throw new RangeError('\"offset\" is outside of buffer bounds')\n  }\n\n  if (array.byteLength < byteOffset + (length || 0)) {\n    throw new RangeError('\"length\" is outside of buffer bounds')\n  }\n\n  let buf\n  if (byteOffset === undefined && length === undefined) {\n    buf = new Uint8Array(array)\n  } else if (length === undefined) {\n    buf = new Uint8Array(array, byteOffset)\n  } else {\n    buf = new Uint8Array(array, byteOffset, length)\n  }\n\n  // Return an augmented `Uint8Array` instance\n  Object.setPrototypeOf(buf, Buffer.prototype)\n\n  return buf\n}\n\nfunction fromObject (obj) {\n  if (Buffer.isBuffer(obj)) {\n    const len = checked(obj.length) | 0\n    const buf = createBuffer(len)\n\n    if (buf.length === 0) {\n      return buf\n    }\n\n    obj.copy(buf, 0, 0, len)\n    return buf\n  }\n\n  if (obj.length !== undefined) {\n    if (typeof obj.length !== 'number' || numberIsNaN(obj.length)) {\n      return createBuffer(0)\n    }\n    return fromArrayLike(obj)\n  }\n\n  if (obj.type === 'Buffer' && Array.isArray(obj.data)) {\n    return fromArrayLike(obj.data)\n  }\n}\n\nfunction checked (length) {\n  // Note: cannot use `length < K_MAX_LENGTH` here because that fails when\n  // length is NaN (which is otherwise coerced to zero.)\n  if (length >= K_MAX_LENGTH) {\n    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +\n                         'size: 0x' + K_MAX_LENGTH.toString(16) + ' bytes')\n  }\n  return length | 0\n}\n\nfunction SlowBuffer (length) {\n  if (+length != length) { // eslint-disable-line eqeqeq\n    length = 0\n  }\n  return Buffer.alloc(+length)\n}\n\nBuffer.isBuffer = function isBuffer (b) {\n  return b != null && b._isBuffer === true &&\n    b !== Buffer.prototype // so Buffer.isBuffer(Buffer.prototype) will be false\n}\n\nBuffer.compare = function compare (a, b) {\n  if (isInstance(a, Uint8Array)) a = Buffer.from(a, a.offset, a.byteLength)\n  if (isInstance(b, Uint8Array)) b = Buffer.from(b, b.offset, b.byteLength)\n  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {\n    throw new TypeError(\n      'The \"buf1\", \"buf2\" arguments must be one of type Buffer or Uint8Array'\n    )\n  }\n\n  if (a === b) return 0\n\n  let x = a.length\n  let y = b.length\n\n  for (let i = 0, len = Math.min(x, y); i < len; ++i) {\n    if (a[i] !== b[i]) {\n      x = a[i]\n      y = b[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\nBuffer.isEncoding = function isEncoding (encoding) {\n  switch (String(encoding).toLowerCase()) {\n    case 'hex':\n    case 'utf8':\n    case 'utf-8':\n    case 'ascii':\n    case 'latin1':\n    case 'binary':\n    case 'base64':\n    case 'ucs2':\n    case 'ucs-2':\n    case 'utf16le':\n    case 'utf-16le':\n      return true\n    default:\n      return false\n  }\n}\n\nBuffer.concat = function concat (list, length) {\n  if (!Array.isArray(list)) {\n    throw new TypeError('\"list\" argument must be an Array of Buffers')\n  }\n\n  if (list.length === 0) {\n    return Buffer.alloc(0)\n  }\n\n  let i\n  if (length === undefined) {\n    length = 0\n    for (i = 0; i < list.length; ++i) {\n      length += list[i].length\n    }\n  }\n\n  const buffer = Buffer.allocUnsafe(length)\n  let pos = 0\n  for (i = 0; i < list.length; ++i) {\n    let buf = list[i]\n    if (isInstance(buf, Uint8Array)) {\n      if (pos + buf.length > buffer.length) {\n        if (!Buffer.isBuffer(buf)) buf = Buffer.from(buf)\n        buf.copy(buffer, pos)\n      } else {\n        Uint8Array.prototype.set.call(\n          buffer,\n          buf,\n          pos\n        )\n      }\n    } else if (!Buffer.isBuffer(buf)) {\n      throw new TypeError('\"list\" argument must be an Array of Buffers')\n    } else {\n      buf.copy(buffer, pos)\n    }\n    pos += buf.length\n  }\n  return buffer\n}\n\nfunction byteLength (string, encoding) {\n  if (Buffer.isBuffer(string)) {\n    return string.length\n  }\n  if (ArrayBuffer.isView(string) || isInstance(string, ArrayBuffer)) {\n    return string.byteLength\n  }\n  if (typeof string !== 'string') {\n    throw new TypeError(\n      'The \"string\" argument must be one of type string, Buffer, or ArrayBuffer. ' +\n      'Received type ' + typeof string\n    )\n  }\n\n  const len = string.length\n  const mustMatch = (arguments.length > 2 && arguments[2] === true)\n  if (!mustMatch && len === 0) return 0\n\n  // Use a for loop to avoid recursion\n  let loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'ascii':\n      case 'latin1':\n      case 'binary':\n        return len\n      case 'utf8':\n      case 'utf-8':\n        return utf8ToBytes(string).length\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return len * 2\n      case 'hex':\n        return len >>> 1\n      case 'base64':\n        return base64ToBytes(string).length\n      default:\n        if (loweredCase) {\n          return mustMatch ? -1 : utf8ToBytes(string).length // assume utf8\n        }\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\nBuffer.byteLength = byteLength\n\nfunction slowToString (encoding, start, end) {\n  let loweredCase = false\n\n  // No need to verify that \"this.length <= MAX_UINT32\" since it's a read-only\n  // property of a typed array.\n\n  // This behaves neither like String nor Uint8Array in that we set start/end\n  // to their upper/lower bounds if the value passed is out of range.\n  // undefined is handled specially as per ECMA-262 6th Edition,\n  // Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.\n  if (start === undefined || start < 0) {\n    start = 0\n  }\n  // Return early if start > this.length. Done here to prevent potential uint32\n  // coercion fail below.\n  if (start > this.length) {\n    return ''\n  }\n\n  if (end === undefined || end > this.length) {\n    end = this.length\n  }\n\n  if (end <= 0) {\n    return ''\n  }\n\n  // Force coercion to uint32. This will also coerce falsey/NaN values to 0.\n  end >>>= 0\n  start >>>= 0\n\n  if (end <= start) {\n    return ''\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  while (true) {\n    switch (encoding) {\n      case 'hex':\n        return hexSlice(this, start, end)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Slice(this, start, end)\n\n      case 'ascii':\n        return asciiSlice(this, start, end)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Slice(this, start, end)\n\n      case 'base64':\n        return base64Slice(this, start, end)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return utf16leSlice(this, start, end)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = (encoding + '').toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\n// This property is used by `Buffer.isBuffer` (and the `is-buffer` npm package)\n// to detect a Buffer instance. It's not possible to use `instanceof Buffer`\n// reliably in a browserify context because there could be multiple different\n// copies of the 'buffer' package in use. This method works even for Buffer\n// instances that were created from another copy of the `buffer` package.\n// See: https://github.com/feross/buffer/issues/154\nBuffer.prototype._isBuffer = true\n\nfunction swap (b, n, m) {\n  const i = b[n]\n  b[n] = b[m]\n  b[m] = i\n}\n\nBuffer.prototype.swap16 = function swap16 () {\n  const len = this.length\n  if (len % 2 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 16-bits')\n  }\n  for (let i = 0; i < len; i += 2) {\n    swap(this, i, i + 1)\n  }\n  return this\n}\n\nBuffer.prototype.swap32 = function swap32 () {\n  const len = this.length\n  if (len % 4 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 32-bits')\n  }\n  for (let i = 0; i < len; i += 4) {\n    swap(this, i, i + 3)\n    swap(this, i + 1, i + 2)\n  }\n  return this\n}\n\nBuffer.prototype.swap64 = function swap64 () {\n  const len = this.length\n  if (len % 8 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 64-bits')\n  }\n  for (let i = 0; i < len; i += 8) {\n    swap(this, i, i + 7)\n    swap(this, i + 1, i + 6)\n    swap(this, i + 2, i + 5)\n    swap(this, i + 3, i + 4)\n  }\n  return this\n}\n\nBuffer.prototype.toString = function toString () {\n  const length = this.length\n  if (length === 0) return ''\n  if (arguments.length === 0) return utf8Slice(this, 0, length)\n  return slowToString.apply(this, arguments)\n}\n\nBuffer.prototype.toLocaleString = Buffer.prototype.toString\n\nBuffer.prototype.equals = function equals (b) {\n  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')\n  if (this === b) return true\n  return Buffer.compare(this, b) === 0\n}\n\nBuffer.prototype.inspect = function inspect () {\n  let str = ''\n  const max = exports.INSPECT_MAX_BYTES\n  str = this.toString('hex', 0, max).replace(/(.{2})/g, '$1 ').trim()\n  if (this.length > max) str += ' ... '\n  return '<Buffer ' + str + '>'\n}\nif (customInspectSymbol) {\n  Buffer.prototype[customInspectSymbol] = Buffer.prototype.inspect\n}\n\nBuffer.prototype.compare = function compare (target, start, end, thisStart, thisEnd) {\n  if (isInstance(target, Uint8Array)) {\n    target = Buffer.from(target, target.offset, target.byteLength)\n  }\n  if (!Buffer.isBuffer(target)) {\n    throw new TypeError(\n      'The \"target\" argument must be one of type Buffer or Uint8Array. ' +\n      'Received type ' + (typeof target)\n    )\n  }\n\n  if (start === undefined) {\n    start = 0\n  }\n  if (end === undefined) {\n    end = target ? target.length : 0\n  }\n  if (thisStart === undefined) {\n    thisStart = 0\n  }\n  if (thisEnd === undefined) {\n    thisEnd = this.length\n  }\n\n  if (start < 0 || end > target.length || thisStart < 0 || thisEnd > this.length) {\n    throw new RangeError('out of range index')\n  }\n\n  if (thisStart >= thisEnd && start >= end) {\n    return 0\n  }\n  if (thisStart >= thisEnd) {\n    return -1\n  }\n  if (start >= end) {\n    return 1\n  }\n\n  start >>>= 0\n  end >>>= 0\n  thisStart >>>= 0\n  thisEnd >>>= 0\n\n  if (this === target) return 0\n\n  let x = thisEnd - thisStart\n  let y = end - start\n  const len = Math.min(x, y)\n\n  const thisCopy = this.slice(thisStart, thisEnd)\n  const targetCopy = target.slice(start, end)\n\n  for (let i = 0; i < len; ++i) {\n    if (thisCopy[i] !== targetCopy[i]) {\n      x = thisCopy[i]\n      y = targetCopy[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\n// Finds either the first index of `val` in `buffer` at offset >= `byteOffset`,\n// OR the last index of `val` in `buffer` at offset <= `byteOffset`.\n//\n// Arguments:\n// - buffer - a Buffer to search\n// - val - a string, Buffer, or number\n// - byteOffset - an index into `buffer`; will be clamped to an int32\n// - encoding - an optional encoding, relevant is val is a string\n// - dir - true for indexOf, false for lastIndexOf\nfunction bidirectionalIndexOf (buffer, val, byteOffset, encoding, dir) {\n  // Empty buffer means no match\n  if (buffer.length === 0) return -1\n\n  // Normalize byteOffset\n  if (typeof byteOffset === 'string') {\n    encoding = byteOffset\n    byteOffset = 0\n  } else if (byteOffset > 0x7fffffff) {\n    byteOffset = 0x7fffffff\n  } else if (byteOffset < -0x80000000) {\n    byteOffset = -0x80000000\n  }\n  byteOffset = +byteOffset // Coerce to Number.\n  if (numberIsNaN(byteOffset)) {\n    // byteOffset: it it's undefined, null, NaN, \"foo\", etc, search whole buffer\n    byteOffset = dir ? 0 : (buffer.length - 1)\n  }\n\n  // Normalize byteOffset: negative offsets start from the end of the buffer\n  if (byteOffset < 0) byteOffset = buffer.length + byteOffset\n  if (byteOffset >= buffer.length) {\n    if (dir) return -1\n    else byteOffset = buffer.length - 1\n  } else if (byteOffset < 0) {\n    if (dir) byteOffset = 0\n    else return -1\n  }\n\n  // Normalize val\n  if (typeof val === 'string') {\n    val = Buffer.from(val, encoding)\n  }\n\n  // Finally, search either indexOf (if dir is true) or lastIndexOf\n  if (Buffer.isBuffer(val)) {\n    // Special case: looking for empty string/buffer always fails\n    if (val.length === 0) {\n      return -1\n    }\n    return arrayIndexOf(buffer, val, byteOffset, encoding, dir)\n  } else if (typeof val === 'number') {\n    val = val & 0xFF // Search for a byte value [0-255]\n    if (typeof Uint8Array.prototype.indexOf === 'function') {\n      if (dir) {\n        return Uint8Array.prototype.indexOf.call(buffer, val, byteOffset)\n      } else {\n        return Uint8Array.prototype.lastIndexOf.call(buffer, val, byteOffset)\n      }\n    }\n    return arrayIndexOf(buffer, [val], byteOffset, encoding, dir)\n  }\n\n  throw new TypeError('val must be string, number or Buffer')\n}\n\nfunction arrayIndexOf (arr, val, byteOffset, encoding, dir) {\n  let indexSize = 1\n  let arrLength = arr.length\n  let valLength = val.length\n\n  if (encoding !== undefined) {\n    encoding = String(encoding).toLowerCase()\n    if (encoding === 'ucs2' || encoding === 'ucs-2' ||\n        encoding === 'utf16le' || encoding === 'utf-16le') {\n      if (arr.length < 2 || val.length < 2) {\n        return -1\n      }\n      indexSize = 2\n      arrLength /= 2\n      valLength /= 2\n      byteOffset /= 2\n    }\n  }\n\n  function read (buf, i) {\n    if (indexSize === 1) {\n      return buf[i]\n    } else {\n      return buf.readUInt16BE(i * indexSize)\n    }\n  }\n\n  let i\n  if (dir) {\n    let foundIndex = -1\n    for (i = byteOffset; i < arrLength; i++) {\n      if (read(arr, i) === read(val, foundIndex === -1 ? 0 : i - foundIndex)) {\n        if (foundIndex === -1) foundIndex = i\n        if (i - foundIndex + 1 === valLength) return foundIndex * indexSize\n      } else {\n        if (foundIndex !== -1) i -= i - foundIndex\n        foundIndex = -1\n      }\n    }\n  } else {\n    if (byteOffset + valLength > arrLength) byteOffset = arrLength - valLength\n    for (i = byteOffset; i >= 0; i--) {\n      let found = true\n      for (let j = 0; j < valLength; j++) {\n        if (read(arr, i + j) !== read(val, j)) {\n          found = false\n          break\n        }\n      }\n      if (found) return i\n    }\n  }\n\n  return -1\n}\n\nBuffer.prototype.includes = function includes (val, byteOffset, encoding) {\n  return this.indexOf(val, byteOffset, encoding) !== -1\n}\n\nBuffer.prototype.indexOf = function indexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, true)\n}\n\nBuffer.prototype.lastIndexOf = function lastIndexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, false)\n}\n\nfunction hexWrite (buf, string, offset, length) {\n  offset = Number(offset) || 0\n  const remaining = buf.length - offset\n  if (!length) {\n    length = remaining\n  } else {\n    length = Number(length)\n    if (length > remaining) {\n      length = remaining\n    }\n  }\n\n  const strLen = string.length\n\n  if (length > strLen / 2) {\n    length = strLen / 2\n  }\n  let i\n  for (i = 0; i < length; ++i) {\n    const parsed = parseInt(string.substr(i * 2, 2), 16)\n    if (numberIsNaN(parsed)) return i\n    buf[offset + i] = parsed\n  }\n  return i\n}\n\nfunction utf8Write (buf, string, offset, length) {\n  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nfunction asciiWrite (buf, string, offset, length) {\n  return blitBuffer(asciiToBytes(string), buf, offset, length)\n}\n\nfunction base64Write (buf, string, offset, length) {\n  return blitBuffer(base64ToBytes(string), buf, offset, length)\n}\n\nfunction ucs2Write (buf, string, offset, length) {\n  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nBuffer.prototype.write = function write (string, offset, length, encoding) {\n  // Buffer#write(string)\n  if (offset === undefined) {\n    encoding = 'utf8'\n    length = this.length\n    offset = 0\n  // Buffer#write(string, encoding)\n  } else if (length === undefined && typeof offset === 'string') {\n    encoding = offset\n    length = this.length\n    offset = 0\n  // Buffer#write(string, offset[, length][, encoding])\n  } else if (isFinite(offset)) {\n    offset = offset >>> 0\n    if (isFinite(length)) {\n      length = length >>> 0\n      if (encoding === undefined) encoding = 'utf8'\n    } else {\n      encoding = length\n      length = undefined\n    }\n  } else {\n    throw new Error(\n      'Buffer.write(string, encoding, offset[, length]) is no longer supported'\n    )\n  }\n\n  const remaining = this.length - offset\n  if (length === undefined || length > remaining) length = remaining\n\n  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {\n    throw new RangeError('Attempt to write outside buffer bounds')\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  let loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'hex':\n        return hexWrite(this, string, offset, length)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Write(this, string, offset, length)\n\n      case 'ascii':\n      case 'latin1':\n      case 'binary':\n        return asciiWrite(this, string, offset, length)\n\n      case 'base64':\n        // Warning: maxLength not taken into account in base64Write\n        return base64Write(this, string, offset, length)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return ucs2Write(this, string, offset, length)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\nBuffer.prototype.toJSON = function toJSON () {\n  return {\n    type: 'Buffer',\n    data: Array.prototype.slice.call(this._arr || this, 0)\n  }\n}\n\nfunction base64Slice (buf, start, end) {\n  if (start === 0 && end === buf.length) {\n    return base64.fromByteArray(buf)\n  } else {\n    return base64.fromByteArray(buf.slice(start, end))\n  }\n}\n\nfunction utf8Slice (buf, start, end) {\n  end = Math.min(buf.length, end)\n  const res = []\n\n  let i = start\n  while (i < end) {\n    const firstByte = buf[i]\n    let codePoint = null\n    let bytesPerSequence = (firstByte > 0xEF)\n      ? 4\n      : (firstByte > 0xDF)\n          ? 3\n          : (firstByte > 0xBF)\n              ? 2\n              : 1\n\n    if (i + bytesPerSequence <= end) {\n      let secondByte, thirdByte, fourthByte, tempCodePoint\n\n      switch (bytesPerSequence) {\n        case 1:\n          if (firstByte < 0x80) {\n            codePoint = firstByte\n          }\n          break\n        case 2:\n          secondByte = buf[i + 1]\n          if ((secondByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)\n            if (tempCodePoint > 0x7F) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 3:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)\n            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 4:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          fourthByte = buf[i + 3]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)\n            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {\n              codePoint = tempCodePoint\n            }\n          }\n      }\n    }\n\n    if (codePoint === null) {\n      // we did not generate a valid codePoint so insert a\n      // replacement char (U+FFFD) and advance only 1 byte\n      codePoint = 0xFFFD\n      bytesPerSequence = 1\n    } else if (codePoint > 0xFFFF) {\n      // encode to utf16 (surrogate pair dance)\n      codePoint -= 0x10000\n      res.push(codePoint >>> 10 & 0x3FF | 0xD800)\n      codePoint = 0xDC00 | codePoint & 0x3FF\n    }\n\n    res.push(codePoint)\n    i += bytesPerSequence\n  }\n\n  return decodeCodePointsArray(res)\n}\n\n// Based on http://stackoverflow.com/a/22747272/680742, the browser with\n// the lowest limit is Chrome, with 0x10000 args.\n// We go 1 magnitude less, for safety\nconst MAX_ARGUMENTS_LENGTH = 0x1000\n\nfunction decodeCodePointsArray (codePoints) {\n  const len = codePoints.length\n  if (len <= MAX_ARGUMENTS_LENGTH) {\n    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()\n  }\n\n  // Decode in chunks to avoid \"call stack size exceeded\".\n  let res = ''\n  let i = 0\n  while (i < len) {\n    res += String.fromCharCode.apply(\n      String,\n      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)\n    )\n  }\n  return res\n}\n\nfunction asciiSlice (buf, start, end) {\n  let ret = ''\n  end = Math.min(buf.length, end)\n\n  for (let i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i] & 0x7F)\n  }\n  return ret\n}\n\nfunction latin1Slice (buf, start, end) {\n  let ret = ''\n  end = Math.min(buf.length, end)\n\n  for (let i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i])\n  }\n  return ret\n}\n\nfunction hexSlice (buf, start, end) {\n  const len = buf.length\n\n  if (!start || start < 0) start = 0\n  if (!end || end < 0 || end > len) end = len\n\n  let out = ''\n  for (let i = start; i < end; ++i) {\n    out += hexSliceLookupTable[buf[i]]\n  }\n  return out\n}\n\nfunction utf16leSlice (buf, start, end) {\n  const bytes = buf.slice(start, end)\n  let res = ''\n  // If bytes.length is odd, the last 8 bits must be ignored (same as node.js)\n  for (let i = 0; i < bytes.length - 1; i += 2) {\n    res += String.fromCharCode(bytes[i] + (bytes[i + 1] * 256))\n  }\n  return res\n}\n\nBuffer.prototype.slice = function slice (start, end) {\n  const len = this.length\n  start = ~~start\n  end = end === undefined ? len : ~~end\n\n  if (start < 0) {\n    start += len\n    if (start < 0) start = 0\n  } else if (start > len) {\n    start = len\n  }\n\n  if (end < 0) {\n    end += len\n    if (end < 0) end = 0\n  } else if (end > len) {\n    end = len\n  }\n\n  if (end < start) end = start\n\n  const newBuf = this.subarray(start, end)\n  // Return an augmented `Uint8Array` instance\n  Object.setPrototypeOf(newBuf, Buffer.prototype)\n\n  return newBuf\n}\n\n/*\n * Need to make sure that buffer isn't trying to write out of bounds.\n */\nfunction checkOffset (offset, ext, length) {\n  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')\n  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')\n}\n\nBuffer.prototype.readUintLE =\nBuffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {\n  offset = offset >>> 0\n  byteLength = byteLength >>> 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  let val = this[offset]\n  let mul = 1\n  let i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUintBE =\nBuffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {\n  offset = offset >>> 0\n  byteLength = byteLength >>> 0\n  if (!noAssert) {\n    checkOffset(offset, byteLength, this.length)\n  }\n\n  let val = this[offset + --byteLength]\n  let mul = 1\n  while (byteLength > 0 && (mul *= 0x100)) {\n    val += this[offset + --byteLength] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUint8 =\nBuffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  return this[offset]\n}\n\nBuffer.prototype.readUint16LE =\nBuffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return this[offset] | (this[offset + 1] << 8)\n}\n\nBuffer.prototype.readUint16BE =\nBuffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return (this[offset] << 8) | this[offset + 1]\n}\n\nBuffer.prototype.readUint32LE =\nBuffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return ((this[offset]) |\n      (this[offset + 1] << 8) |\n      (this[offset + 2] << 16)) +\n      (this[offset + 3] * 0x1000000)\n}\n\nBuffer.prototype.readUint32BE =\nBuffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] * 0x1000000) +\n    ((this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    this[offset + 3])\n}\n\nBuffer.prototype.readBigUInt64LE = defineBigIntMethod(function readBigUInt64LE (offset) {\n  offset = offset >>> 0\n  validateNumber(offset, 'offset')\n  const first = this[offset]\n  const last = this[offset + 7]\n  if (first === undefined || last === undefined) {\n    boundsError(offset, this.length - 8)\n  }\n\n  const lo = first +\n    this[++offset] * 2 ** 8 +\n    this[++offset] * 2 ** 16 +\n    this[++offset] * 2 ** 24\n\n  const hi = this[++offset] +\n    this[++offset] * 2 ** 8 +\n    this[++offset] * 2 ** 16 +\n    last * 2 ** 24\n\n  return BigInt(lo) + (BigInt(hi) << BigInt(32))\n})\n\nBuffer.prototype.readBigUInt64BE = defineBigIntMethod(function readBigUInt64BE (offset) {\n  offset = offset >>> 0\n  validateNumber(offset, 'offset')\n  const first = this[offset]\n  const last = this[offset + 7]\n  if (first === undefined || last === undefined) {\n    boundsError(offset, this.length - 8)\n  }\n\n  const hi = first * 2 ** 24 +\n    this[++offset] * 2 ** 16 +\n    this[++offset] * 2 ** 8 +\n    this[++offset]\n\n  const lo = this[++offset] * 2 ** 24 +\n    this[++offset] * 2 ** 16 +\n    this[++offset] * 2 ** 8 +\n    last\n\n  return (BigInt(hi) << BigInt(32)) + BigInt(lo)\n})\n\nBuffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {\n  offset = offset >>> 0\n  byteLength = byteLength >>> 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  let val = this[offset]\n  let mul = 1\n  let i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {\n  offset = offset >>> 0\n  byteLength = byteLength >>> 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  let i = byteLength\n  let mul = 1\n  let val = this[offset + --i]\n  while (i > 0 && (mul *= 0x100)) {\n    val += this[offset + --i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readInt8 = function readInt8 (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  if (!(this[offset] & 0x80)) return (this[offset])\n  return ((0xff - this[offset] + 1) * -1)\n}\n\nBuffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  const val = this[offset] | (this[offset + 1] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  const val = this[offset + 1] | (this[offset] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset]) |\n    (this[offset + 1] << 8) |\n    (this[offset + 2] << 16) |\n    (this[offset + 3] << 24)\n}\n\nBuffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] << 24) |\n    (this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    (this[offset + 3])\n}\n\nBuffer.prototype.readBigInt64LE = defineBigIntMethod(function readBigInt64LE (offset) {\n  offset = offset >>> 0\n  validateNumber(offset, 'offset')\n  const first = this[offset]\n  const last = this[offset + 7]\n  if (first === undefined || last === undefined) {\n    boundsError(offset, this.length - 8)\n  }\n\n  const val = this[offset + 4] +\n    this[offset + 5] * 2 ** 8 +\n    this[offset + 6] * 2 ** 16 +\n    (last << 24) // Overflow\n\n  return (BigInt(val) << BigInt(32)) +\n    BigInt(first +\n    this[++offset] * 2 ** 8 +\n    this[++offset] * 2 ** 16 +\n    this[++offset] * 2 ** 24)\n})\n\nBuffer.prototype.readBigInt64BE = defineBigIntMethod(function readBigInt64BE (offset) {\n  offset = offset >>> 0\n  validateNumber(offset, 'offset')\n  const first = this[offset]\n  const last = this[offset + 7]\n  if (first === undefined || last === undefined) {\n    boundsError(offset, this.length - 8)\n  }\n\n  const val = (first << 24) + // Overflow\n    this[++offset] * 2 ** 16 +\n    this[++offset] * 2 ** 8 +\n    this[++offset]\n\n  return (BigInt(val) << BigInt(32)) +\n    BigInt(this[++offset] * 2 ** 24 +\n    this[++offset] * 2 ** 16 +\n    this[++offset] * 2 ** 8 +\n    last)\n})\n\nBuffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, true, 23, 4)\n}\n\nBuffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, false, 23, 4)\n}\n\nBuffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, true, 52, 8)\n}\n\nBuffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, false, 52, 8)\n}\n\nfunction checkInt (buf, value, offset, ext, max, min) {\n  if (!Buffer.isBuffer(buf)) throw new TypeError('\"buffer\" argument must be a Buffer instance')\n  if (value > max || value < min) throw new RangeError('\"value\" argument is out of bounds')\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n}\n\nBuffer.prototype.writeUintLE =\nBuffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  byteLength = byteLength >>> 0\n  if (!noAssert) {\n    const maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  let mul = 1\n  let i = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUintBE =\nBuffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  byteLength = byteLength >>> 0\n  if (!noAssert) {\n    const maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  let i = byteLength - 1\n  let mul = 1\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUint8 =\nBuffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nBuffer.prototype.writeUint16LE =\nBuffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  this[offset] = (value & 0xff)\n  this[offset + 1] = (value >>> 8)\n  return offset + 2\n}\n\nBuffer.prototype.writeUint16BE =\nBuffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  this[offset] = (value >>> 8)\n  this[offset + 1] = (value & 0xff)\n  return offset + 2\n}\n\nBuffer.prototype.writeUint32LE =\nBuffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  this[offset + 3] = (value >>> 24)\n  this[offset + 2] = (value >>> 16)\n  this[offset + 1] = (value >>> 8)\n  this[offset] = (value & 0xff)\n  return offset + 4\n}\n\nBuffer.prototype.writeUint32BE =\nBuffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  this[offset] = (value >>> 24)\n  this[offset + 1] = (value >>> 16)\n  this[offset + 2] = (value >>> 8)\n  this[offset + 3] = (value & 0xff)\n  return offset + 4\n}\n\nfunction wrtBigUInt64LE (buf, value, offset, min, max) {\n  checkIntBI(value, min, max, buf, offset, 7)\n\n  let lo = Number(value & BigInt(0xffffffff))\n  buf[offset++] = lo\n  lo = lo >> 8\n  buf[offset++] = lo\n  lo = lo >> 8\n  buf[offset++] = lo\n  lo = lo >> 8\n  buf[offset++] = lo\n  let hi = Number(value >> BigInt(32) & BigInt(0xffffffff))\n  buf[offset++] = hi\n  hi = hi >> 8\n  buf[offset++] = hi\n  hi = hi >> 8\n  buf[offset++] = hi\n  hi = hi >> 8\n  buf[offset++] = hi\n  return offset\n}\n\nfunction wrtBigUInt64BE (buf, value, offset, min, max) {\n  checkIntBI(value, min, max, buf, offset, 7)\n\n  let lo = Number(value & BigInt(0xffffffff))\n  buf[offset + 7] = lo\n  lo = lo >> 8\n  buf[offset + 6] = lo\n  lo = lo >> 8\n  buf[offset + 5] = lo\n  lo = lo >> 8\n  buf[offset + 4] = lo\n  let hi = Number(value >> BigInt(32) & BigInt(0xffffffff))\n  buf[offset + 3] = hi\n  hi = hi >> 8\n  buf[offset + 2] = hi\n  hi = hi >> 8\n  buf[offset + 1] = hi\n  hi = hi >> 8\n  buf[offset] = hi\n  return offset + 8\n}\n\nBuffer.prototype.writeBigUInt64LE = defineBigIntMethod(function writeBigUInt64LE (value, offset = 0) {\n  return wrtBigUInt64LE(this, value, offset, BigInt(0), BigInt('0xffffffffffffffff'))\n})\n\nBuffer.prototype.writeBigUInt64BE = defineBigIntMethod(function writeBigUInt64BE (value, offset = 0) {\n  return wrtBigUInt64BE(this, value, offset, BigInt(0), BigInt('0xffffffffffffffff'))\n})\n\nBuffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) {\n    const limit = Math.pow(2, (8 * byteLength) - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  let i = 0\n  let mul = 1\n  let sub = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i - 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) {\n    const limit = Math.pow(2, (8 * byteLength) - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  let i = byteLength - 1\n  let mul = 1\n  let sub = 0\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i + 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)\n  if (value < 0) value = 0xff + value + 1\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nBuffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  this[offset] = (value & 0xff)\n  this[offset + 1] = (value >>> 8)\n  return offset + 2\n}\n\nBuffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  this[offset] = (value >>> 8)\n  this[offset + 1] = (value & 0xff)\n  return offset + 2\n}\n\nBuffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  this[offset] = (value & 0xff)\n  this[offset + 1] = (value >>> 8)\n  this[offset + 2] = (value >>> 16)\n  this[offset + 3] = (value >>> 24)\n  return offset + 4\n}\n\nBuffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (value < 0) value = 0xffffffff + value + 1\n  this[offset] = (value >>> 24)\n  this[offset + 1] = (value >>> 16)\n  this[offset + 2] = (value >>> 8)\n  this[offset + 3] = (value & 0xff)\n  return offset + 4\n}\n\nBuffer.prototype.writeBigInt64LE = defineBigIntMethod(function writeBigInt64LE (value, offset = 0) {\n  return wrtBigUInt64LE(this, value, offset, -BigInt('0x8000000000000000'), BigInt('0x7fffffffffffffff'))\n})\n\nBuffer.prototype.writeBigInt64BE = defineBigIntMethod(function writeBigInt64BE (value, offset = 0) {\n  return wrtBigUInt64BE(this, value, offset, -BigInt('0x8000000000000000'), BigInt('0x7fffffffffffffff'))\n})\n\nfunction checkIEEE754 (buf, value, offset, ext, max, min) {\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n  if (offset < 0) throw new RangeError('Index out of range')\n}\n\nfunction writeFloat (buf, value, offset, littleEndian, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 23, 4)\n  return offset + 4\n}\n\nBuffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, false, noAssert)\n}\n\nfunction writeDouble (buf, value, offset, littleEndian, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 52, 8)\n  return offset + 8\n}\n\nBuffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, false, noAssert)\n}\n\n// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)\nBuffer.prototype.copy = function copy (target, targetStart, start, end) {\n  if (!Buffer.isBuffer(target)) throw new TypeError('argument should be a Buffer')\n  if (!start) start = 0\n  if (!end && end !== 0) end = this.length\n  if (targetStart >= target.length) targetStart = target.length\n  if (!targetStart) targetStart = 0\n  if (end > 0 && end < start) end = start\n\n  // Copy 0 bytes; we're done\n  if (end === start) return 0\n  if (target.length === 0 || this.length === 0) return 0\n\n  // Fatal error conditions\n  if (targetStart < 0) {\n    throw new RangeError('targetStart out of bounds')\n  }\n  if (start < 0 || start >= this.length) throw new RangeError('Index out of range')\n  if (end < 0) throw new RangeError('sourceEnd out of bounds')\n\n  // Are we oob?\n  if (end > this.length) end = this.length\n  if (target.length - targetStart < end - start) {\n    end = target.length - targetStart + start\n  }\n\n  const len = end - start\n\n  if (this === target && typeof Uint8Array.prototype.copyWithin === 'function') {\n    // Use built-in when available, missing from IE11\n    this.copyWithin(targetStart, start, end)\n  } else {\n    Uint8Array.prototype.set.call(\n      target,\n      this.subarray(start, end),\n      targetStart\n    )\n  }\n\n  return len\n}\n\n// Usage:\n//    buffer.fill(number[, offset[, end]])\n//    buffer.fill(buffer[, offset[, end]])\n//    buffer.fill(string[, offset[, end]][, encoding])\nBuffer.prototype.fill = function fill (val, start, end, encoding) {\n  // Handle string cases:\n  if (typeof val === 'string') {\n    if (typeof start === 'string') {\n      encoding = start\n      start = 0\n      end = this.length\n    } else if (typeof end === 'string') {\n      encoding = end\n      end = this.length\n    }\n    if (encoding !== undefined && typeof encoding !== 'string') {\n      throw new TypeError('encoding must be a string')\n    }\n    if (typeof encoding === 'string' && !Buffer.isEncoding(encoding)) {\n      throw new TypeError('Unknown encoding: ' + encoding)\n    }\n    if (val.length === 1) {\n      const code = val.charCodeAt(0)\n      if ((encoding === 'utf8' && code < 128) ||\n          encoding === 'latin1') {\n        // Fast path: If `val` fits into a single byte, use that numeric value.\n        val = code\n      }\n    }\n  } else if (typeof val === 'number') {\n    val = val & 255\n  } else if (typeof val === 'boolean') {\n    val = Number(val)\n  }\n\n  // Invalid ranges are not set to a default, so can range check early.\n  if (start < 0 || this.length < start || this.length < end) {\n    throw new RangeError('Out of range index')\n  }\n\n  if (end <= start) {\n    return this\n  }\n\n  start = start >>> 0\n  end = end === undefined ? this.length : end >>> 0\n\n  if (!val) val = 0\n\n  let i\n  if (typeof val === 'number') {\n    for (i = start; i < end; ++i) {\n      this[i] = val\n    }\n  } else {\n    const bytes = Buffer.isBuffer(val)\n      ? val\n      : Buffer.from(val, encoding)\n    const len = bytes.length\n    if (len === 0) {\n      throw new TypeError('The value \"' + val +\n        '\" is invalid for argument \"value\"')\n    }\n    for (i = 0; i < end - start; ++i) {\n      this[i + start] = bytes[i % len]\n    }\n  }\n\n  return this\n}\n\n// CUSTOM ERRORS\n// =============\n\n// Simplified versions from Node, changed for Buffer-only usage\nconst errors = {}\nfunction E (sym, getMessage, Base) {\n  errors[sym] = class NodeError extends Base {\n    constructor () {\n      super()\n\n      Object.defineProperty(this, 'message', {\n        value: getMessage.apply(this, arguments),\n        writable: true,\n        configurable: true\n      })\n\n      // Add the error code to the name to include it in the stack trace.\n      this.name = `${this.name} [${sym}]`\n      // Access the stack to generate the error message including the error code\n      // from the name.\n      this.stack // eslint-disable-line no-unused-expressions\n      // Reset the name to the actual name.\n      delete this.name\n    }\n\n    get code () {\n      return sym\n    }\n\n    set code (value) {\n      Object.defineProperty(this, 'code', {\n        configurable: true,\n        enumerable: true,\n        value,\n        writable: true\n      })\n    }\n\n    toString () {\n      return `${this.name} [${sym}]: ${this.message}`\n    }\n  }\n}\n\nE('ERR_BUFFER_OUT_OF_BOUNDS',\n  function (name) {\n    if (name) {\n      return `${name} is outside of buffer bounds`\n    }\n\n    return 'Attempt to access memory outside buffer bounds'\n  }, RangeError)\nE('ERR_INVALID_ARG_TYPE',\n  function (name, actual) {\n    return `The \"${name}\" argument must be of type number. Received type ${typeof actual}`\n  }, TypeError)\nE('ERR_OUT_OF_RANGE',\n  function (str, range, input) {\n    let msg = `The value of \"${str}\" is out of range.`\n    let received = input\n    if (Number.isInteger(input) && Math.abs(input) > 2 ** 32) {\n      received = addNumericalSeparator(String(input))\n    } else if (typeof input === 'bigint') {\n      received = String(input)\n      if (input > BigInt(2) ** BigInt(32) || input < -(BigInt(2) ** BigInt(32))) {\n        received = addNumericalSeparator(received)\n      }\n      received += 'n'\n    }\n    msg += ` It must be ${range}. Received ${received}`\n    return msg\n  }, RangeError)\n\nfunction addNumericalSeparator (val) {\n  let res = ''\n  let i = val.length\n  const start = val[0] === '-' ? 1 : 0\n  for (; i >= start + 4; i -= 3) {\n    res = `_${val.slice(i - 3, i)}${res}`\n  }\n  return `${val.slice(0, i)}${res}`\n}\n\n// CHECK FUNCTIONS\n// ===============\n\nfunction checkBounds (buf, offset, byteLength) {\n  validateNumber(offset, 'offset')\n  if (buf[offset] === undefined || buf[offset + byteLength] === undefined) {\n    boundsError(offset, buf.length - (byteLength + 1))\n  }\n}\n\nfunction checkIntBI (value, min, max, buf, offset, byteLength) {\n  if (value > max || value < min) {\n    const n = typeof min === 'bigint' ? 'n' : ''\n    let range\n    if (byteLength > 3) {\n      if (min === 0 || min === BigInt(0)) {\n        range = `>= 0${n} and < 2${n} ** ${(byteLength + 1) * 8}${n}`\n      } else {\n        range = `>= -(2${n} ** ${(byteLength + 1) * 8 - 1}${n}) and < 2 ** ` +\n                `${(byteLength + 1) * 8 - 1}${n}`\n      }\n    } else {\n      range = `>= ${min}${n} and <= ${max}${n}`\n    }\n    throw new errors.ERR_OUT_OF_RANGE('value', range, value)\n  }\n  checkBounds(buf, offset, byteLength)\n}\n\nfunction validateNumber (value, name) {\n  if (typeof value !== 'number') {\n    throw new errors.ERR_INVALID_ARG_TYPE(name, 'number', value)\n  }\n}\n\nfunction boundsError (value, length, type) {\n  if (Math.floor(value) !== value) {\n    validateNumber(value, type)\n    throw new errors.ERR_OUT_OF_RANGE(type || 'offset', 'an integer', value)\n  }\n\n  if (length < 0) {\n    throw new errors.ERR_BUFFER_OUT_OF_BOUNDS()\n  }\n\n  throw new errors.ERR_OUT_OF_RANGE(type || 'offset',\n                                    `>= ${type ? 1 : 0} and <= ${length}`,\n                                    value)\n}\n\n// HELPER FUNCTIONS\n// ================\n\nconst INVALID_BASE64_RE = /[^+/0-9A-Za-z-_]/g\n\nfunction base64clean (str) {\n  // Node takes equal signs as end of the Base64 encoding\n  str = str.split('=')[0]\n  // Node strips out invalid characters like \\n and \\t from the string, base64-js does not\n  str = str.trim().replace(INVALID_BASE64_RE, '')\n  // Node converts strings with length < 2 to ''\n  if (str.length < 2) return ''\n  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not\n  while (str.length % 4 !== 0) {\n    str = str + '='\n  }\n  return str\n}\n\nfunction utf8ToBytes (string, units) {\n  units = units || Infinity\n  let codePoint\n  const length = string.length\n  let leadSurrogate = null\n  const bytes = []\n\n  for (let i = 0; i < length; ++i) {\n    codePoint = string.charCodeAt(i)\n\n    // is surrogate component\n    if (codePoint > 0xD7FF && codePoint < 0xE000) {\n      // last char was a lead\n      if (!leadSurrogate) {\n        // no lead yet\n        if (codePoint > 0xDBFF) {\n          // unexpected trail\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        } else if (i + 1 === length) {\n          // unpaired lead\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        }\n\n        // valid lead\n        leadSurrogate = codePoint\n\n        continue\n      }\n\n      // 2 leads in a row\n      if (codePoint < 0xDC00) {\n        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n        leadSurrogate = codePoint\n        continue\n      }\n\n      // valid surrogate pair\n      codePoint = (leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00) + 0x10000\n    } else if (leadSurrogate) {\n      // valid bmp char, but last char was a lead\n      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n    }\n\n    leadSurrogate = null\n\n    // encode utf8\n    if (codePoint < 0x80) {\n      if ((units -= 1) < 0) break\n      bytes.push(codePoint)\n    } else if (codePoint < 0x800) {\n      if ((units -= 2) < 0) break\n      bytes.push(\n        codePoint >> 0x6 | 0xC0,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x10000) {\n      if ((units -= 3) < 0) break\n      bytes.push(\n        codePoint >> 0xC | 0xE0,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x110000) {\n      if ((units -= 4) < 0) break\n      bytes.push(\n        codePoint >> 0x12 | 0xF0,\n        codePoint >> 0xC & 0x3F | 0x80,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else {\n      throw new Error('Invalid code point')\n    }\n  }\n\n  return bytes\n}\n\nfunction asciiToBytes (str) {\n  const byteArray = []\n  for (let i = 0; i < str.length; ++i) {\n    // Node's code seems to be doing this and not & 0x7F..\n    byteArray.push(str.charCodeAt(i) & 0xFF)\n  }\n  return byteArray\n}\n\nfunction utf16leToBytes (str, units) {\n  let c, hi, lo\n  const byteArray = []\n  for (let i = 0; i < str.length; ++i) {\n    if ((units -= 2) < 0) break\n\n    c = str.charCodeAt(i)\n    hi = c >> 8\n    lo = c % 256\n    byteArray.push(lo)\n    byteArray.push(hi)\n  }\n\n  return byteArray\n}\n\nfunction base64ToBytes (str) {\n  return base64.toByteArray(base64clean(str))\n}\n\nfunction blitBuffer (src, dst, offset, length) {\n  let i\n  for (i = 0; i < length; ++i) {\n    if ((i + offset >= dst.length) || (i >= src.length)) break\n    dst[i + offset] = src[i]\n  }\n  return i\n}\n\n// ArrayBuffer or Uint8Array objects from other contexts (i.e. iframes) do not pass\n// the `instanceof` check but they should be treated as of that type.\n// See: https://github.com/feross/buffer/issues/166\nfunction isInstance (obj, type) {\n  return obj instanceof type ||\n    (obj != null && obj.constructor != null && obj.constructor.name != null &&\n      obj.constructor.name === type.name)\n}\nfunction numberIsNaN (obj) {\n  // For IE11 support\n  return obj !== obj // eslint-disable-line no-self-compare\n}\n\n// Create lookup table for `toString('hex')`\n// See: https://github.com/feross/buffer/issues/219\nconst hexSliceLookupTable = (function () {\n  const alphabet = '0123456789abcdef'\n  const table = new Array(256)\n  for (let i = 0; i < 16; ++i) {\n    const i16 = i * 16\n    for (let j = 0; j < 16; ++j) {\n      table[i16 + j] = alphabet[i] + alphabet[j]\n    }\n  }\n  return table\n})()\n\n// Return not function with Error if BigInt not supported\nfunction defineBigIntMethod (fn) {\n  return typeof BigInt === 'undefined' ? BufferBigIntNotDefined : fn\n}\n\nfunction BufferBigIntNotDefined () {\n  throw new Error('BigInt not supported')\n}\n","import { Buffer } from \"buffer\";\n\nexport type EncryptedAsymmetric<_T> = string & {\n  readonly __brand: unique symbol;\n};\nexport type EncryptedSymmetric<_T> = string & {\n  readonly __brand: unique symbol;\n};\n\nconst encryptAlgo = { name: \"RSA-OAEP\", hash: \"SHA-256\" };\nconst signAlgo = { name: \"RSASSA-PKCS1-v1_5\", hash: \"SHA-256\" };\nconst publicKeyFormat = \"spki\";\nconst privateKeyFormat = \"pkcs8\";\n\nconst aesAlgo = { name: \"AES-GCM\", length: 256 };\nconst ivLength = 12; // 96 bits, recommended for GCM\n\nconst base64ToUint8Array = (base64: string) => {\n  const binary = atob(base64);\n  const bytes = new Uint8Array(binary.length);\n  for (let i = 0; i < binary.length; i++) {\n    bytes[i] = binary.charCodeAt(i);\n  }\n  return bytes;\n};\n\nexport const decryptAsymmetric = async <T>(\n  privateKey: string,\n  data: EncryptedAsymmetric<T>,\n): Promise<T> =>\n  JSON.parse(new TextDecoder().decode(\n    await crypto.subtle.decrypt(\n      encryptAlgo,\n      await importKey(privateKey, \"decrypt\"),\n      base64ToUint8Array(data),\n    ),\n  ));\n\nconst importKey = (\n  key: string,\n  usage: \"encrypt\" | \"decrypt\" | \"sign\" | \"verify\",\n) =>\n  crypto.subtle.importKey(\n    usage === \"decrypt\" || usage === \"sign\"\n      ? privateKeyFormat\n      : publicKeyFormat,\n    Buffer.from(key, \"base64\"),\n    usage === \"decrypt\" || usage === \"encrypt\" ? encryptAlgo : signAlgo,\n    false,\n    [usage],\n  );\n\nconst importSymmetricKey = (key: string, usage: KeyUsage[]) =>\n  crypto.subtle.importKey(\n    \"raw\",\n    Buffer.from(key, \"base64\"),\n    aesAlgo,\n    false,\n    usage,\n  );\n\nexport const encryptAsymmetric = async <T>(publicKey: string, data: T) =>\n  Buffer.from(\n    await crypto.subtle.encrypt(\n      encryptAlgo,\n      await importKey(publicKey, \"encrypt\"),\n      new TextEncoder().encode(JSON.stringify(data)),\n    ),\n  ).toString(\"base64\") as EncryptedAsymmetric<T>;\n\nconst encodeKey = async (key: CryptoKey, format: \"spki\" | \"pkcs8\") =>\n  btoa(String.fromCharCode(\n    ...new Uint8Array(await crypto.subtle.exportKey(format, key)),\n  ));\n\nconst encodeKeys = async ({ publicKey, privateKey }: CryptoKeyPair) => ({\n  publicKey: await encodeKey(publicKey, publicKeyFormat),\n  privateKey: await encodeKey(privateKey, privateKeyFormat),\n});\n\nexport const generateKeyPair = async (usage: \"sign\" | \"encrypt\") =>\n  encodeKeys(\n    await crypto.subtle.generateKey(\n      {\n        ...usage === \"encrypt\" ? encryptAlgo : signAlgo,\n        modulusLength: 2048,\n        publicExponent: new Uint8Array([1, 0, 1]),\n      },\n      true,\n      usage === \"encrypt\" ? [\"encrypt\", \"decrypt\"] : [\"sign\", \"verify\"],\n    ),\n  );\n\nexport const sign = async (privateKey: string, data: string) =>\n  Buffer.from(\n    await crypto.subtle.sign(\n      signAlgo,\n      await importKey(privateKey, \"sign\"),\n      new TextEncoder().encode(data),\n    ),\n  ).toString(\"base64\");\n\nexport const verify = async (\n  signature: string,\n  publicKey: string,\n  data: string,\n) =>\n  crypto.subtle.verify(\n    signAlgo,\n    await importKey(publicKey, \"verify\"),\n    Buffer.from(signature, \"base64\"),\n    new TextEncoder().encode(data),\n  );\n\nexport const encryptSymmetric = async <T>(\n  key: string,\n  data: T,\n): Promise<EncryptedSymmetric<T>> => {\n  const iv = crypto.getRandomValues(new Uint8Array(ivLength));\n  const cryptoKey = await importSymmetricKey(key, [\"encrypt\"]);\n  const encoded = new TextEncoder().encode(JSON.stringify(data));\n  const ciphertext = new Uint8Array(\n    await crypto.subtle.encrypt(\n      { ...aesAlgo, iv },\n      cryptoKey,\n      encoded,\n    ),\n  );\n  // Prepend IV to ciphertext\n  const combined = new Uint8Array(iv.length + ciphertext.length);\n  combined.set(iv, 0);\n  combined.set(ciphertext, iv.length);\n  return Buffer.from(combined).toString(\"base64\") as EncryptedSymmetric<T>;\n};\n\nexport const decryptSymmetric = async <T>(\n  key: string,\n  data: EncryptedSymmetric<T>,\n): Promise<T> => {\n  const raw = Buffer.from(data, \"base64\");\n  const iv = raw.subarray(0, ivLength);\n  const ciphertext = raw.subarray(ivLength);\n  const cryptoKey = await importSymmetricKey(key, [\"decrypt\"]);\n  const decrypted = await crypto.subtle.decrypt(\n    { ...aesAlgo, iv },\n    cryptoKey,\n    ciphertext,\n  );\n  return JSON.parse(new TextDecoder().decode(decrypted));\n};\n\nexport const generateSymmetricKey = async (): Promise<string> => {\n  const key = await crypto.subtle.generateKey(aesAlgo, true, [\n    \"encrypt\",\n    \"decrypt\",\n  ]);\n  const raw = await crypto.subtle.exportKey(\"raw\", key);\n  return Buffer.from(new Uint8Array(raw)).toString(\"base64\");\n};\n","import type { InstaQLEntity } from \"@instantdb/core\";\nimport type { InstantReactWebDatabase } from \"@instantdb/react\";\nimport { map, pipe } from \"gamla\";\nimport stringify from \"safe-stable-stringify\";\nimport {\n  apiClient,\n  type CreateConversationOutput,\n} from \"../../backend/src/api.ts\";\nimport type schema from \"../../instant.schema.ts\";\nimport {\n  encryptAsymmetric,\n  generateKeyPair,\n  generateSymmetricKey,\n} from \"../../protocol/src/crypto.ts\";\nimport {\n  decryptAsymmetric,\n  decryptSymmetric,\n  type EncryptedAsymmetric,\n  type EncryptedSymmetric,\n  encryptSymmetric,\n  sign,\n  verify,\n} from \"./crypto.ts\";\n\nexport const instantAppId = \"8f3bebac-da7b-44ab-9cf5-46a6cc11557e\";\n\ntype InternalMessage = { type: \"text\"; text: string };\n\nexport type WebhookUpdate = {\n  payload: EncryptedMessage;\n  timestamp: number;\n  conversationId: string;\n};\n\ntype SignedPayload<T> = {\n  publicSignKey: string;\n  signature: string;\n  payload: T;\n};\n\nexport type EncryptedMessage = EncryptedSymmetric<\n  SignedPayload<InternalMessage>\n>;\n\nconst msgToStr = stringify;\n\nexport type EncryptedConversationKey = EncryptedAsymmetric<string>;\n\ntype SendMessageParams = {\n  conversationKey: string;\n  credentials: Credentials;\n  message: InternalMessage;\n  conversation: string;\n};\n\nexport const sendMessage = async (\n  {\n    conversationKey,\n    conversation,\n    credentials: { privateSignKey, publicSignKey },\n    message,\n  }: SendMessageParams,\n) => {\n  const encryptedMessage = await encryptSymmetric(\n    conversationKey,\n    {\n      payload: message,\n      publicSignKey,\n      signature: await sign(privateSignKey, msgToStr(message)),\n    },\n  );\n  return apiClient({\n    endpoint: \"sendMessage\",\n    payload: { conversation, encryptedMessage },\n  });\n};\n\ntype DbMessage = InstaQLEntity<typeof schema, \"messages\">;\n\nconst getConversationKeyForWebhookHandling = async (\n  credentials: Credentials,\n  conversation: string,\n) => {\n  const result = await apiClient({\n    endpoint: \"conversationKey\",\n    payload: {\n      conversationId: conversation,\n      publicSignKey: credentials.publicSignKey,\n    },\n  });\n  if (\"error\" in result) {\n    throw new Error(\"No keys found for conversation\");\n  }\n  return await decryptAsymmetric<string>(\n    credentials.privateEncryptKey,\n    result.conversationKey as EncryptedAsymmetric<string>,\n  );\n};\n\nexport const handleWebhookUpdate = async (\n  whUpdate: WebhookUpdate,\n  credentials: Credentials,\n) => {\n  const key = await getConversationKeyForWebhookHandling(\n    credentials,\n    whUpdate.conversationId,\n  );\n  return {\n    conversationId: whUpdate.conversationId,\n    message: await decryptMessage(key)(whUpdate),\n    conversationKey: key,\n  };\n};\n\nexport type DecipheredMessage =\n  & { publicSignKey: string; timestamp: number }\n  & InternalMessage;\n\nexport const decryptMessage =\n  (conversationSymmetricKey: string) =>\n  async (dbMsg: Omit<DbMessage, \"id\">): Promise<DecipheredMessage> => {\n    const decrypted = await decryptSymmetric<SignedPayload<InternalMessage>>(\n      conversationSymmetricKey,\n      dbMsg.payload,\n    );\n    if (!decrypted) throw new Error(\"Failed to decrypt message\");\n    const isValid = await verify(\n      decrypted.signature,\n      decrypted.publicSignKey,\n      msgToStr(decrypted.payload),\n    );\n    if (!isValid) throw new Error(\"Invalid signature\");\n    return {\n      publicSignKey: decrypted.publicSignKey,\n      timestamp: dbMsg.timestamp,\n      ...decrypted.payload,\n    };\n  };\n\n// deno-lint-ignore ban-types\ntype Identity = InstaQLEntity<typeof schema, \"identities\", { account: {} }>;\n\nexport const createConversation = (\n  db: () => InstantReactWebDatabase<typeof schema>,\n) =>\nasync (\n  publicSignKeys: string[],\n  conversationTitle: string,\n): Promise<CreateConversationOutput> => {\n  const { data: { identities } } = await db().queryOnce({\n    identities: {\n      account: {},\n      $: { where: { publicSignKey: { $in: publicSignKeys } } },\n    },\n  });\n  if (identities.length !== publicSignKeys.length) {\n    return { error: \"invalid-participants\" };\n  }\n  const signKeyToEncrypionKey = pipe(\n    map(({ publicSignKey, publicEncryptKey }: Identity) =>\n      [publicSignKey, publicEncryptKey] as const\n    ),\n    Object.fromEntries<string>,\n  )(identities);\n  const symmetricKey = await generateSymmetricKey();\n  return pipe(\n    map(async (\n      publicSignKey: string,\n    ): Promise<[string, EncryptedConversationKey]> => [\n      publicSignKey,\n      await encryptAsymmetric(\n        signKeyToEncrypionKey[publicSignKey],\n        symmetricKey,\n      ),\n    ]),\n    Object.fromEntries<EncryptedConversationKey>,\n    (publicSignKeyToEncryptedSymmetricKey) =>\n      apiClient({\n        endpoint: \"createConversation\",\n        payload: {\n          publicSignKeyToEncryptedSymmetricKey,\n          title: conversationTitle,\n        },\n      }),\n  )(publicSignKeys);\n};\n\nexport type Credentials = {\n  publicSignKey: string;\n  privateSignKey: string;\n  privateEncryptKey: string;\n};\n\nexport const createIdentity = async (name: string): Promise<Credentials> => {\n  const signKey = await generateKeyPair(\"sign\");\n  const encryptKey = await generateKeyPair(\"encrypt\");\n  await apiClient({\n    endpoint: \"createAnonymousIdentity\",\n    payload: {\n      name,\n      publicSignKey: signKey.publicKey,\n      publicEncryptKey: encryptKey.publicKey,\n    },\n  });\n  return {\n    publicSignKey: signKey.publicKey,\n    privateSignKey: signKey.privateKey,\n    privateEncryptKey: encryptKey.privateKey,\n  };\n};\n","export const isDarkMode = () =>\n  typeof globalThis !== \"undefined\" &&\n  \"matchMedia\" in globalThis &&\n  globalThis.matchMedia(\"(prefers-color-scheme: dark)\").matches;\n\nexport const chatContainerStyle = {\n  border: \"1px solid #ccc\",\n  padding: 8,\n  background: isDarkMode() ? \"#1a202c\" : \"#fff\",\n  color: isDarkMode() ? \"#f3f4f6\" : \"#222\",\n  borderColor: isDarkMode() ? \"#374151\" : \"#ccc\",\n  transition: \"background 0.2s, color 0.2s, border-color 0.2s\",\n};\nexport const messageContainerStyle = {\n  height: 700,\n  width: 400,\n  overflowY: \"auto\",\n  marginBottom: 8,\n  gap: 8,\n  display: \"flex\",\n  flexDirection: \"column-reverse\",\n  background: isDarkMode() ? \"#111827\" : \"#f9fafb\",\n  transition: \"background 0.2s\",\n};\n\nexport const loadingStyle = { fontSize: 12, color: \"#bbb\" };\n\nexport const waitingStyle = { color: \"red\", fontSize: 12 };\n\nexport const stringToColor = (str: string) => {\n  let hash = 0;\n  for (let i = 0; i < str.length; i++) {\n    hash = str.charCodeAt(i) + ((hash << 5) - hash);\n  }\n  const h = Math.abs(hash) % 360;\n  const lightness = isDarkMode() ? 32 : 70;\n  return `hsl(${h}, 60%, ${lightness}%)`;\n};\n\nexport const isLightColor = (hsl: string) => {\n  const match = hsl.match(/hsl\\(\\d+, *\\d+%, *(\\d+)%\\)/);\n  if (!match) return false;\n  const lightness = parseInt(match[1], 10);\n  return lightness > 60;\n};\n\nexport const bubbleStyle = (\n  { bubbleColor, textColor, isOwn, showAvatar, align }: {\n    bubbleColor: string;\n    textColor: string;\n    isOwn: boolean;\n    showAvatar: boolean;\n    align: \"flex-start\" | \"flex-end\";\n  },\n) => ({\n  background: bubbleColor,\n  color: textColor,\n  borderRadius: 16,\n  padding: \"6px 12px\",\n  maxWidth: 220,\n  marginLeft: isOwn ? 0 : (!isOwn && showAvatar ? 0 : 36),\n  marginRight: isOwn ? (showAvatar ? 0 : 36) : 0,\n  alignSelf: align,\n});\n","import { useEffect, useRef, useState } from \"preact/hooks\";\nimport { timeAgo } from \"time-ago\";\nimport {\n  bubbleStyle,\n  chatContainerStyle,\n  isDarkMode,\n  isLightColor,\n  loadingStyle,\n  messageContainerStyle,\n  stringToColor,\n} from \"./design.tsx\";\n\nconst Message = (\n  { msg: { authorId, authorName, authorAvatar, text, timestamp }, next, isOwn }:\n    {\n      msg: AbstracChatMessage;\n      next: AbstracChatMessage | undefined;\n      isOwn: boolean;\n    },\n) => {\n  const isFirstOfSequence = !next || next.authorId !== authorId;\n  const bubbleColor = stringToColor(authorId);\n  const showAvatar = isFirstOfSequence;\n  // In dark mode, use light text; in light mode, use dark text\n  const textColor = isLightColor(bubbleColor) ? (isDarkMode() ? \"#fff\" : \"#222\") : (isDarkMode() ? \"#fff\" : \"#fff\");\n  return (\n    <div\n      style={{\n        display: \"flex\",\n        gap: 4,\n        flexDirection: isOwn ? \"row-reverse\" : \"row\",\n      }}\n    >\n      {showAvatar && (\n        <div\n          style={{\n            width: 28,\n            height: 28,\n            borderRadius: \"50%\",\n            marginRight: 8,\n            background: bubbleColor,\n            display: \"flex\",\n            alignItems: \"center\",\n            justifyContent: \"center\",\n            overflow: \"hidden\",\n          }}\n        >\n          {authorAvatar\n            ? (\n              <img\n                src={authorAvatar}\n                alt={authorName}\n                style={{\n                  width: 28,\n                  height: 28,\n                  objectFit: \"cover\",\n                  borderRadius: \"50%\",\n                }}\n              />\n            )\n            : (\n              <span\n                style={{\n                  color: isLightColor(bubbleColor) ? (isDarkMode() ? \"#fff\" : \"#222\") : (isDarkMode() ? \"#fff\" : \"#fff\"),\n                  fontWeight: 700,\n                  fontSize: 14,\n                }}\n              >\n                {authorName.slice(0, 2).toUpperCase()}\n              </span>\n            )}\n        </div>\n      )}\n      <div\n        style={bubbleStyle({\n          textColor,\n          bubbleColor,\n          isOwn,\n          showAvatar,\n          align: isOwn ? \"flex-end\" : \"flex-start\",\n        })}\n      >\n        <b style={{ fontSize: 11 }}>{authorName}</b>\n        <div style={{ whiteSpace: \"pre-wrap\", wordBreak: \"break-word\" }}>\n          {text}\n        </div>\n        <span\n          style={{\n            color: isDarkMode() ? \"#bbb\" : (textColor === \"#222\" ? \"#555\" : \"#eee\"),\n            fontSize: 10,\n            float: \"right\",\n          }}\n        >\n          {timeAgo(timestamp)}\n        </span>\n      </div>\n    </div>\n  );\n};\n\nexport type AbstracChatMessage = {\n  authorId: string;\n  authorName: string;\n  authorAvatar?: string;\n  text: string;\n  timestamp: number;\n};\n\nconst CloseButton = ({ onClose }: { onClose: () => void }) => {\n  const dark = isDarkMode();\n  const baseBg = dark ? \"#23272f\" : \"#f3f4f6\";\n  const hoverBg = dark ? \"#374151\" : \"#e5e7eb\";\n  const color = dark ? \"#eee\" : \"#222\";\n  return (\n    <button\n      type=\"button\"\n      onClick={onClose}\n      title=\"Close chat\"\n      style={{\n        position: \"absolute\",\n        top: 8,\n        right: 8,\n        background: baseBg,\n        border: \"none\",\n        borderRadius: \"50%\",\n        width: 28,\n        height: 28,\n        display: \"flex\",\n        alignItems: \"center\",\n        justifyContent: \"center\",\n        boxShadow: \"0 1px 4px rgba(0,0,0,0.07)\",\n        cursor: \"pointer\",\n        fontSize: 22,\n        color,\n        zIndex: 10,\n        transition: \"background 0.2s, color 0.2s\",\n        padding: 0,\n        fontWeight: 700,\n        lineHeight: 1,\n      }}\n      onMouseOver={(e) => (e.currentTarget.style.background = hoverBg)}\n      onMouseOut={(e) => (e.currentTarget.style.background = baseBg)}\n    >\n      <span style={{ fontSize: 22, fontWeight: 700, lineHeight: 1, color }}>\n        Ã—\n      </span>\n    </button>\n  );\n};\n\nexport const AbstractChatBox = (\n  { limit, loadMore, userId, onSend, messages, onClose }: {\n    userId: string;\n    onSend: (input: string) => void;\n    messages: AbstracChatMessage[];\n    limit: number;\n    loadMore: () => void;\n    onClose?: () => void;\n  },\n) => {\n  const [fetchingMore, setFetchingMore] = useState(false);\n  const messagesEndRef = useRef<HTMLDivElement>(null);\n  const [input, setInput] = useState(\"\");\n  const inputRef = useRef<HTMLInputElement>(null);\n  const messagesContainerRef = useRef<HTMLDivElement>(null);\n  const handleScroll = () => {\n    if (\n      messagesContainerRef.current &&\n      !fetchingMore &&\n      messagesContainerRef.current.scrollTop === 0 &&\n      messages.length === limit\n    ) {\n      setFetchingMore(true);\n      loadMore();\n      setFetchingMore(false);\n    }\n  };\n  useEffect(() => {\n    if (messagesContainerRef.current) {\n      messagesContainerRef.current.addEventListener(\"scroll\", handleScroll);\n      return () =>\n        messagesContainerRef.current?.removeEventListener(\n          \"scroll\",\n          handleScroll,\n        );\n    }\n  }, [limit, messages, fetchingMore]);\n  return (\n    <div style={{ ...chatContainerStyle, position: \"relative\" }}>\n      {onClose && <CloseButton onClose={onClose} />}\n      <div\n        ref={messagesContainerRef}\n        style={messageContainerStyle}\n      >\n        {messages.map((msg, i) => (\n          <Message\n            key={i}\n            isOwn={msg.authorId === userId}\n            msg={msg}\n            next={messages[i + 1]}\n          />\n        ))}\n        <div ref={messagesEndRef} />\n      </div>\n      <div className=\"flex items-center mt-2 gap-2\">\n        <input\n          ref={inputRef}\n          value={input}\n          onChange={(e) => setInput(e.currentTarget.value)}\n          onKeyDown={(e) => {\n            if (e.key !== \"Enter\") {\n              return;\n            }\n            if (input.trim()) {\n              onSend(input.trim());\n              setInput(\"\");\n            }\n          }}\n          placeholder=\"Type a message...\"\n          className=\"flex-grow p-2 border rounded-md \n                     bg-gray-50 dark:bg-gray-700 \n                     border-gray-300 dark:border-gray-600 \n                     text-gray-900 dark:text-white \n                     placeholder-gray-500 dark:placeholder-gray-400\n                     focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500\"\n        />\n        <button\n          type=\"button\"\n          disabled={!input.trim()}\n          onClick={() => {\n            setInput(\"\");\n            onSend(input.trim());\n          }}\n          className=\"p-2 border border-blue-500 rounded-md \n                     bg-blue-500 hover:bg-blue-600 \n                     text-white \n                     focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 \n                     disabled:opacity-50 disabled:cursor-not-allowed\"\n        >\n          Send\n        </button>\n      </div>\n      {fetchingMore && <div style={loadingStyle}>Loading more...</div>}\n    </div>\n  );\n};\n","import type { InstantReactWebDatabase } from \"@instantdb/react\";\nimport { map, pipe } from \"gamla\";\nimport { useEffect, useState } from \"preact/hooks\";\nimport type schema from \"../../../instant.schema.ts\";\nimport {\n  type Credentials,\n  type DecipheredMessage,\n  decryptMessage,\n  sendMessage,\n} from \"../../../protocol/src/api.ts\";\nimport { decryptAsymmetric } from \"../../../protocol/src/crypto.ts\";\nimport {\n  type AbstracChatMessage,\n  AbstractChatBox,\n} from \"./abstractChatBox.tsx\";\n\nexport type ChatProps = {\n  credentials: Credentials;\n  onClose?: () => void;\n  conversationId: string;\n};\n\nconst msgToUIMessage =\n  (details: Record<string, { name: string; avatar?: string }>) =>\n  (msg: DecipheredMessage): AbstracChatMessage => ({\n    authorId: msg.publicSignKey,\n    authorName: details[msg.publicSignKey]?.name ||\n      msg.publicSignKey,\n    authorAvatar: details[msg.publicSignKey]?.avatar,\n    text: msg.text,\n    timestamp: msg.timestamp,\n  });\n\nconst useDecryptedMessages = (\n  db: InstantReactWebDatabase<typeof schema>,\n  limit: number,\n  conversationKey: string | null,\n  conversationId: string,\n) => {\n  const [messages, setMessages] = useState<DecipheredMessage[]>([]);\n  const { data, error } = db.useQuery({\n    messages: {\n      conversation: {},\n      $: {\n        where: { conversation: conversationId },\n        order: { timestamp: \"desc\" },\n        limit,\n      },\n    },\n  });\n  if (error) console.error(\"error fetching alice and bot messages\", error);\n  const encryptedMessages = data?.messages;\n  useEffect(() => {\n    if (conversationKey && encryptedMessages) {\n      const sorted = [...encryptedMessages].sort((a, b) =>\n        b.timestamp - a.timestamp\n      );\n      pipe(map(decryptMessage(conversationKey)), setMessages)(sorted);\n    }\n  }, [conversationKey, encryptedMessages]);\n  const { data: identitiesData } = db.useQuery({\n    identities: {\n      $: {\n        where: {\n          publicSignKey: { $in: messages.map((msg) => msg.publicSignKey) },\n        },\n      },\n    },\n  });\n  const details = Object.fromEntries(\n    (identitiesData?.identities ?? []).map((identity) => [\n      identity.publicSignKey,\n      {\n        name: identity.name || identity.publicSignKey,\n        avatar: identity.avatar,\n      },\n    ]),\n  );\n  return messages.map(msgToUIMessage(details));\n};\n\nexport const Chat =\n  (db: () => InstantReactWebDatabase<typeof schema>) =>\n  ({ credentials, conversationId, onClose }: ChatProps) => {\n    const convoKey = useConversationKey(db())(conversationId, credentials);\n    const [limit, setLimit] = useState(100);\n    return (\n      <AbstractChatBox\n        onClose={onClose}\n        limit={limit}\n        loadMore={() => {\n          setLimit(limit + 100);\n        }}\n        userId={credentials.publicSignKey}\n        messages={useDecryptedMessages(db(), limit, convoKey, conversationId)}\n        onSend={(input: string) => {\n          if (!convoKey) return null;\n          sendMessage({\n            conversationKey: convoKey,\n            credentials,\n            message: { type: \"text\", text: input },\n            conversation: conversationId,\n          }).catch((err) => {\n            console.error(\"Failed to send message\", err);\n          });\n        }}\n      />\n    );\n  };\n\nconst useConversationKey = (\n  { useQuery }: Pick<InstantReactWebDatabase<typeof schema>, \"useQuery\">,\n) =>\n(\n  conversation: string,\n  { publicSignKey, privateEncryptKey }: Credentials,\n): string | null => {\n  const [key, setKey] = useState<string | null>(null);\n  const { isLoading, error, data } = useQuery(\n    {\n      keys: {\n        $: { where: { \"owner.publicSignKey\": publicSignKey, conversation } },\n      },\n    },\n  );\n  if (error) {\n    console.error(\"Failed to fetch conversation key\", error);\n    return null;\n  }\n  if (isLoading) return null;\n  useEffect(() => {\n    if (!data.keys[0]?.key) return;\n    if (data.keys.length > 1) throw new Error(\"Multiple keys found\");\n    decryptAsymmetric<string>(privateEncryptKey, data.keys[0].key)\n      .then((key: string) => {\n        setKey(key);\n      });\n  }, [data.keys[0]?.key, privateEncryptKey]);\n  return key;\n};\n","import { i } from \"@instantdb/core\";\nimport type {\n  EncryptedConversationKey,\n  EncryptedMessage,\n} from \"./protocol/src/api.ts\";\n\nconst _schema = i.schema({\n  entities: {\n    $files: i.entity({\n      path: i.string().unique().indexed(),\n      url: i.any(),\n    }),\n    $users: i.entity({\n      email: i.string().unique().indexed(),\n    }),\n    accounts: i.entity({\n      email: i.string().unique().indexed().optional(),\n      accessToken: i.string().optional().unique().indexed(),\n    }),\n    messages: i.entity({\n      payload: i.json<EncryptedMessage>(),\n      timestamp: i.number().indexed(),\n    }),\n    identities: i.entity({\n      name: i.string().optional(),\n      avatar: i.string().optional(),\n      publicEncryptKey: i.string().unique().indexed(),\n      publicSignKey: i.string().unique().indexed(),\n      webhook: i.string().indexed().optional(),\n    }),\n    conversations: i.entity({ title: i.string() }),\n    keys: i.entity({ key: i.json<EncryptedConversationKey>() }),\n  },\n  links: {\n    conversationMessages: {\n      forward: { on: \"conversations\", label: \"messages\", has: \"many\" },\n      reverse: { on: \"messages\", label: \"conversation\", has: \"one\" },\n    },\n    accountIdentities: {\n      forward: { on: \"accounts\", label: \"identities\", has: \"many\" },\n      reverse: { on: \"identities\", label: \"account\", has: \"one\" },\n    },\n    conversationKeys: {\n      forward: { on: \"conversations\", label: \"keys\", has: \"many\" },\n      reverse: { on: \"keys\", label: \"conversation\", has: \"one\" },\n    },\n    identityKeys: {\n      forward: { on: \"identities\", label: \"keys\", has: \"many\" },\n      reverse: { on: \"keys\", label: \"owner\", has: \"one\" },\n    },\n    conversationParent: {\n      forward: { on: \"conversations\", label: \"parent\", has: \"one\" },\n      reverse: { on: \"conversations\", label: \"child\", has: \"one\" },\n    },\n    conversationParticipants: {\n      forward: { on: \"conversations\", label: \"participants\", has: \"many\" },\n      reverse: { on: \"identities\", label: \"conversations\", has: \"many\" },\n    },\n    conversationAdmins: {\n      forward: { on: \"conversations\", label: \"admins\", has: \"many\" },\n      reverse: { on: \"identities\", label: \"managedConversations\", has: \"many\" },\n    },\n  },\n  rooms: {},\n});\n\ntype _AppSchema = typeof _schema;\ninterface AppSchema extends _AppSchema {}\nconst schema: AppSchema = _schema;\n\nexport type { AppSchema };\nexport default schema;\n","import { init } from \"@instantdb/react\";\nimport type { InstantReactWebDatabase } from \"@instantdb/react\";\nimport {\n\n  apiClient,\n  type CreateConversationOutput,\n  type SetWebhookOutput,\n} from \"./backend/src/api.ts\";\nimport { useConversations as useConversationsNoDb } from \"./clients/react/src/hooks.ts\";\nimport { Chat as ChatNoDb } from \"./clients/react/src/main.tsx\";\nimport schema from \"./instant.schema.ts\";\nimport {\n  createConversation as createConversationNoDb,\n  type Credentials,\n  instantAppId,\n} from \"./protocol/src/api.ts\";\n\nexport {\n  createIdentity,\n  type Credentials,\n  handleWebhookUpdate,\n  sendMessage,\n  type WebhookUpdate,\n} from \"./protocol/src/api.ts\";\n\nlet db: InstantReactWebDatabase <typeof schema>| null = null;\n\nconst accessDb = () => {\n  if (!db) {\n     db = init({ appId: instantAppId, schema, devtool: false });\n  }\n  return db;\n};\n\nexport const useConversations = useConversationsNoDb(accessDb);\nexport const Chat = ChatNoDb(accessDb);\n\nexport const createConversation: (\n  publicSignKeys: string[],\n  conversationTitle: string,\n) => Promise<CreateConversationOutput> = createConversationNoDb(accessDb);\n\nexport const setWebhook = (\n  { url, credentials: { publicSignKey } }: {\n    url: string;\n    credentials: Credentials;\n  },\n): Promise<SetWebhookOutput> =>\n  apiClient({ endpoint: \"setWebhook\", payload: { url, publicSignKey } });\n","import { useEffect, useState } from \"preact/hooks\";\nimport {\n  Chat,\n  createConversation,\n  createIdentity,\n  type Credentials,\n  useConversations,\n} from \"../../mod.ts\";\n\nconst useGetOrCreateConversation = (creds: Credentials, otherSide: string) => {\n  const [conversation, setConversation] = useState<string | null>(null);\n  const conversations = useConversations(creds);\n  useEffect(() => {\n    if (conversation) return;\n    const existingConversation = conversations.find(({ participants }) =>\n      participants.some(({ publicSignKey }) => publicSignKey === otherSide)\n    );\n    if (existingConversation) {\n      setConversation(existingConversation.id);\n      return;\n    }\n    createConversation([creds.publicSignKey, otherSide], \"Chat\");\n  }, [conversation, conversations]);\n  return conversation;\n};\n\nconst useCredentials = (name: string | null) => {\n  const [credentials, setCredentials] = useState<Credentials | null>(null);\n  useEffect(() => {\n    const existingCredentials = localStorage.getItem(\"aliceAndBotCredentials\");\n    if (existingCredentials) {\n      setCredentials(JSON.parse(existingCredentials));\n      return;\n    }\n    if (!name) return;\n    createIdentity(name).then((newCredentials) => {\n      setCredentials(newCredentials);\n      localStorage.setItem(\n        \"aliceAndBotCredentials\",\n        JSON.stringify(newCredentials),\n      );\n    });\n  }, [name]);\n  return credentials;\n};\n\nconst InternalWidget = ({ dialTo }: { dialTo: string }) => {\n  const [chatOpen, setChatOpen] = useState(false);\n  const [name, setName] = useState<string | null>(null);\n  const credentials = useCredentials(name);\n  const conversation = chatOpen && credentials &&\n    useGetOrCreateConversation(credentials, dialTo);\n  if (chatOpen) {\n    if (conversation) {\n      return (\n        <Chat\n          onClose={() => {\n            setChatOpen(false);\n          }}\n          credentials={credentials}\n          conversationId={conversation}\n        />\n      );\n    }\n    if (credentials) {\n      return (\n        <div>\n          <p>Getting/creating conversation...</p>\n        </div>\n      );\n    }\n    return (\n      <div>\n        <p>Loading credentials...</p>\n      </div>\n    );\n  }\n\n  if (!chatOpen) {\n    if (conversation) {\n      return (\n        <div>\n          <button type=\"button\" onClick={() => setChatOpen(true)}>\n            Open Chat\n          </button>\n        </div>\n      );\n    }\n    if (!credentials) {\n      return (\n        <div>\n          <button\n            type=\"button\"\n            onClick={() => {\n              const userName = prompt(\"Enter your name:\");\n              if (userName) {\n                setName(userName);\n                setChatOpen(true);\n              } else {\n                alert(\"Name is required to start a chat.\");\n              }\n            }}\n          >\n            Start Chat\n          </button>\n        </div>\n      );\n    }\n    return (\n      <div>\n        <button\n          type=\"button\"\n          onClick={() => {\n            setChatOpen(true);\n          }}\n        >\n          Start Chat\n        </button>\n      </div>\n    );\n  }\n\n  return null;\n};\n\nexport const Widget = ({ dialTo }: { dialTo: string }) => (\n  <div\n    style={{\n      position: \"fixed\",\n      bottom: 24,\n      right: 24,\n      zIndex: 10000,\n    }}\n  >\n    <InternalWidget dialTo={dialTo} />\n  </div>\n);\n","import { Widget } from \"./widget.tsx\";\nimport { render } from \"preact\";\n\nconst elementId = \"alice-and-bot-widget-root\";\n\nexport const loadChatWidget = ({ dialingTo }: { dialingTo: string }) => {\n  const existing = document.getElementById(elementId);\n  if (existing) return;\n  const div = document.createElement(\"div\");\n  div.id = elementId;\n  document.body.appendChild(div);\n  render(<Widget dialTo={dialingTo} />, div);\n};\n"],"names":["n","l","u","i","r","o","e","f","c","s","a","p","y","v","w","d","g","_","t","m","k","x","S","C","M","$","O","z","I","h","P","q","A","L","B","H","T","j","F","b","D","N","V","E","weakHash","input","hash","elementHash","keys","key","keyHash","valueHash","Operation","PROXY_DRAFT","RAW_RETURN_SYMBOL","iteratorSymbol","dataTypes","internal","has","target","getDescriptor","prototype","descriptor","isBaseSetInstance","obj","isBaseMapInstance","latest","proxyDraft","_a","isDraft","getProxyDraft","value","getValue","isDraftable","options","markResult","getPath","path","parentCopy","get","isSet","resolvePath","getType","set","peek","state","isEqual","revokeProxy","escapePath","pathAsArray","_item","item","base","index","strictCopy","copy","desc","propIsEnum","shallowCopy","original","SubClass","ensureShallowCopy","deepClone","iterable","cloneIfNeeded","markChanged","throwFrozenError","deepFreeze","subKey","updatedValues","stack","parent","name","forEach","iter","type","entry","handleValue","handledSet","setMap","updatedValue","values","finalizeAssigned","finalizeSetValue","finalizePatches","generatePatches","patches","inversePatches","basePath","markFinalization","generateArrayPatches","proxyState","assignedMap","_path","arrayLengthAssignment","generatePatchesFromAssigned","assignedValue","originalValue","op","generateSetPatches","checkReadable","ignoreCheckDraftable","mapHandler","source","callback","thisArg","_value","_key","_b","mutable","draft","iterator","result","mapHandlerKeys","getNextIterator","isValuesIterator","currentDraft","proxy","setHandler","valueProxyDraft","other","setHandlerKeys","draftsCache","proxyHandler","receiver","handle","createDraft","subProxyDraft","current","currentProxyDraft","createDraftOptions","parentDraft","finalities","revoke","oldProxyDraft","finalizeDraft","returnedValue","enableAutoFreeze","hasReturnedValue","draftify","baseState","finalizedState","finalizedPatches","finalizedInversePatches","handleReturnValue","rootDraft","useRawReturn","isRoot","currentValue","arr","getCurrent","newValue","create","arg","arg0","arg1","arg2","_c","args","mutate","mark","types","enablePatches","strict","_options","finalize","error","returnValue","rawReturnValue","returnedProxyDraft","areObjectKeysEqual","ak","bk","areObjectsShallowEqual","obj1","obj2","areObjectsDeepEqual","immutableRemoveUndefined","isObject","immutableDeepMerge","areBothObjects","val","insertInMutative","assocInMutative","dissocInMutative","restPath","isEmpty","hasEA","attr","isRef","isBlob","getAttr","attrs","attrId","getInMap","acc","deleteInMap","head","tail","setInMap","nextM","createTripleIndexes","triples","eav","aev","vae","triple","eid","aid","createAttrIndexes","blobAttrs","primaryKeys","forwardIdents","revIdents","fwdIdent","fwdEtype","fwdLabel","revIdent","revEtype","revLabel","toJSON","store","allMapValues","fromJSON","storeJSON","createStore","resetAttrIndexes","enableCardinalityInference","linkIndex","resolveLookupRefs","eMaps","lookupV","_e","_v","rest","retractTriple","rawTriple","_seed","getCreatedAt","createdAt","addTriple","existingTriple","enhancedTriple","mergeTriple","update","eavValuesMap","currentTriple","deleteEntity","lookup","etype","id","eMap","vaeTriples","resetIndexMap","newTriples","newIndexMap","addAttr","getAllTriples","deleteAttr","updateAttr","partialAttr","applyTxStep","txStep","action","level","res","triplesByValue","candidate","isNull","reverse","vMap","isValNull","aMap","whichIdx","getTriples","getAsObject","label","getAttrByFwdIdentName","inputEtype","inputLabel","getAttrByReverseIdentName","getBlobAttrs","getPrimaryKeyAttr","fromPrimary","transact","txSteps","isVariable","matchVariable","variable","triplePart","context","bound","matchPart","matchExact","patternPart","matcherForPatternPart","validArgMapProps","isArgsMap","prop","matchPattern","pattern","idx","querySingle","relevantTriples","queryPattern","contexts","patterns","queryWhere","actualize","find","findPart","query","where","getRandomValues","rnds8","rng","byteToHex","unsafeStringify","offset","native","v4","buf","rnds","uuidToByteArray","uuid","hex","bytes","compareByteArrays","uuidCompare","uuid_a","uuid_b","wildcard","friendlyName","makeVarImpl","AttrNotFoundError","message","idAttr","ns","s.getPrimaryKeyAttr","defaultWhere","makeVar","eidWhere","replaceInAttrPat","attrPat","needle","refAttrPat","fwdAttr","s.getAttrByFwdIdentName","revAttr","s.getAttrByReverseIdentName","_f","_r","nextLevel","makeLikeMatcher","caseSensitive","regexPattern","regex","parseValue","isDate","matcher","valueAttrPat","valueEtype","valueLevel","valueLabel","refAttrPats","refsPath","lastEtype","lastLevel","attrPats","nextEtype","whereCondAttrPats","refPats","valuePat","withJoin","join","isOrClauses","isAndClauses","genMakeVar","baseMakeVar","joinSym","orIdx","lvl","parseWhereClauses","clauseType","whereValue","makeNamespacedVar","parseWhere","growPath","ret","whereCondAttrPatsForNullIsTrue","notPats","nilPats","makeWhere","makeFind","makeJoin","pat","isForward","actualized","extendObjects","form","objects","childQueries","isSingular","childrenArray","queryOne","childOrChildren","child","compareOrder","id_a","v_a","id_b","v_b","comparableDate","isBefore","startCursor","orderAttr","direction","idVec","c_e","_c_a","c_v","c_t","compareVal","v_new","c_v_new","orderAttrFromCursor","cursor","cursorAttrId","orderAttrFromOrder","order","getOrderAttr","objectAttrs","dq","s.getBlobAttrs","field","s.isBlob","runDataloadAndReturnObjects","pageInfo","idVecs","datalogQuery","_d","s.getAsObject","determineOrder","orderOpts","resolveObjects","_g","_h","_j","_k","limit","before","after","fields","objs","entries","guardedResolveObjects","opts","formatPageInfo","aggregate","getAllTransactionChunkKeys","_dummy","allTransactionChunkKeys","transactionChunk","prevOps","_target","cmd","isLookup","parseLookup","attribute","vJSON","etypeChunk","txInit","getOps","rewriteStep","attrMapping","attrIdMap","refSwapAttrIds","rewritten","part","tmp","inputIdentName","_id","explodeLookupRef","isRefLookupIdent","identName","extractRefLookupFwdName","fwdName","idIdent","lookupIdentToAttr","refAttr","lookupPairOfEid","extractLookup","lookupPair","withIdAttrForLookup","eidA","expandLink","addTriples","eidOrEids","eids","eidB","expandUnlink","retractTriples","expandUpdate","obj_","expandDelete","expandDeepMerge","attrTuples","expandRuleParams","ruleParams","removeIdFromArgs","step","newObj","toTxSteps","checkedDataTypeOfValueType","valueType","objectPropsFromSchema","schema","unique","indexed","checkedDataType","createObjectAttr","props","schemaObjectProps","findSchemaLink","refPropsFromSchema","found","forward","createRefAttr","schemaRefProps","OBJ_ACTIONS","REF_ACTIONS","UPDATE_ACTIONS","SUPPORTS_LOOKUP_ACTIONS","lookupProps","refLookupProps","lookupPairsOfOp","eidLookupPair","linkEid","linkEidLookupPair","createMissingAttrs","existingAttrs","ops","addedIds","addOps","addUnsynced","addForRef","linkLabel","linkEtype","labels","transform","ctx","inputChunks","tx","newAttrs","addAttrTxSteps","__awaiter","_arguments","generator","adopt","resolve","reject","fulfilled","rejected","IndexedDBStorage","dbName","request","event","db","_event","WindowNetworkListener","onOnline","onOffline","InstantAPIError","actualProto","jsonFetch","init","json","sendMagicCode","apiURI","appId","email","verifyMagicCode","code","verifyRefreshToken","refreshToken","exchangeCodeForToken","codeVerifier","signInWithIdToken","nonce","idToken","clientName","signOut","uploadFile","file","contentType","contentDisposition","headers","deleteFile","data","getSignedUploadUrl","fileName","metadata","upload","presignedUrl","getDownloadUrl","devBackend","instantLogs","devtoolLocalDashboard","pick","buildPresenceSlice","userPeerId","slice","user","shouldIncludeAllPeers","isPeerIncluded","peer","hasPresenceResponseChanged","Deferred","reason","PersistedObject","persister","defaultValue","onMerge","saveThrottleMs","fromStorage","cb","sub","_extractTriplesHelper","idNodes","idNode","datalogResult","joinRows","rows","extractTriples","createLinkIndex","link","version","createLogger","isEnabled","STATUS","QUERY_ONCE_TIMEOUT","WS_CONNECTING_STATUS","WS_OPEN_STATUS","defaultConfig","OAUTH_REDIRECT_PARAM","currentUserKey","_wsId","createWebSocket","uri","ws","isClient","ignoreLogging","querySubsFromJSON","str","parsed","s.fromJSON","querySubsToJSON","querySubs","jsonSubs","jsonSub","s.toJSON","Reactor","config","Storage","NetworkListener","versions","_storageSubs","inMemorySubs","storageSubs","querySub","storageResult","memoryResult","storageMuts","inMemoryMuts","mut","cbs","prevData","dfds","chunks","instaml.transform","eventId","mutation","prev","dfd","targetWs","resp","room","flags.devBackend","flags.instantLogs","isOnline","status","clientId","errDetails","ok","err","roomId","enqueuedUserPresence","enqueuedBroadcasts","topic","roomType","wsId","msg","s.createStore","computations","updates","txId","prevMutation","txStepsToApply","newStore","s.transact","_args","_action","loadingRoomId","joinedRoom","errorRoomId","errorRoom","errorMessage","errorObj","prevResult","muts","findExistingAttr","instaml.getAttrByFwdIdentName","findReverseAttr","instaml.getAttrByReverseIdentName","mapping","rewriteTxSteps","retTxSteps","existing","newTxStep","instaml.rewriteStep","pendingMutationSteps","deletedAttrIds","_attr","pendingAttrs","fullAttr","attrsWithoutDeleted","querySubVersion","pendingMutationsVersion","pendingMutations","cached","instaql","timeoutMs","prevWs","newId","url","startUrl","newPath","ran","listener","params","authAPI.exchangeCodeForToken","currUserCached","unsubbed","oas","oauthResp","errorV","userV","newUser","oldUser","newV","authAPI.sendMagicCode","authAPI.verifyMagicCode","authToken","authAPI.verifyRefreshToken","currentUser","authAPI\n            .signOut","redirectURL","authAPI.signInWithIdToken","initialData","isConnected","presence","partialData","leaveRoom","handler","edits","peers","sessions","newSessions","StorageApi.uploadFile","StorageApi.deleteFile","StorageApi.getSignedUploadUrl","StorageApi.upload","StorageApi.getDownloadUrl","DataAttrDef","required","EntityDef","links","InstantSchemaDef","entities","rooms","graph","enrichEntitiesWithLinks","entity","string","number","boolean","date","any","linksIndex","linkDef","def","linksDef","roomsDef","currentDevtool","createDevtool","iframeContrainer","createIframeContainer","toggler","createToggler","toggleView","iframe","createIframe","getSrc","onPostMessage","onKeyDown","isToggleShortcut","isEsc","dispose","flags.devtoolLocalDashboard","src","element","onClick","logoSVG","cssPositionForToggler","position","cssPositionForIframeContainer","isVisible","initSchemaHashStore","initGlobalInstantCoreStore","reactorKey","adminToken","globalInstantCoreStore","schemaHashStore","Auth","token","pathname","coerceQuery","InstantCoreDatabase","reactor","onEvent","onChange","schemaHash","schemaChanged","existingClient","newSchema","client","handleDevtool","devtool","U","W","G","J","K","Q","X","en","rn","un","on","cn","fn","an","sn","stateForResult","useQueryInternal","_core","_query","_opts","queryHash","resultCacheRef","useRef","subscribe","useCallback","useSyncExternalStore","useTimeout","timeoutRef","useEffect","clear","delay","defaultActivityStopTimeout","useTopicEffect","usePublishTopic","usePresence","setState","useState","publishPresence","useMemo","useSyncPresence","deps","useTypingIndicator","inputName","timeout","observedPresence","active","presenceSnapshot","setActive","isActive","onBlur","inputProps","InstantReactRoom","InstantReactAbstractDatabase","localId","setLocalId","auth","statusRef","newStatus","core_init","InstantReactWebDatabase","util","assertIs","_arg","assertNever","_x","items","validKeys","filtered","object","checker","joinValues","array","separator","objectUtil","first","second","ZodParsedType","getParsedType","ZodIssueCode","quotelessJson","ZodError","issues","subs","_mapper","mapper","issue","fieldErrors","processError","curr","el","formErrors","errorMap","_ctx","overrideErrorMap","setErrorMap","map","getErrorMap","makeIssue","errorMaps","issueData","fullPath","fullIssue","maps","EMPTY_PATH","addIssueToContext","ParseStatus","results","arrayValue","INVALID","pairs","syncPairs","pair","finalObject","DIRTY","OK","isAborted","isDirty","isValid","isAsync","errorUtil","ParseInputLazyPath","handleResult","processCreateParams","invalid_type_error","required_error","description","iss","ZodType","maybeAsyncResult","check","getIssueProperties","setError","refinementData","refinement","ZodEffects","ZodFirstPartyTypeKind","ZodOptional","ZodNullable","ZodArray","ZodPromise","option","ZodUnion","incoming","ZodIntersection","defaultValueFunc","ZodDefault","ZodBranded","catchValueFunc","ZodCatch","This","ZodPipeline","ZodReadonly","cuidRegex","cuid2Regex","ulidRegex","uuidRegex","emailRegex","_emojiRegex","emojiRegex","ipv4Regex","ipv6Regex","datetimeRegex","isValidIP","ip","ZodString","tooBig","tooSmall","validation","minLength","maxLength","len","ch","min","max","floatSafeRemainder","valDecCount","stepDecCount","decCount","valInt","stepInt","ZodNumber","kind","inclusive","ZodBigInt","ZodBoolean","ZodDate","minDate","maxDate","ZodSymbol","ZodUndefined","ZodNull","ZodAny","ZodUnknown","ZodNever","ZodVoid","deepPartialify","ZodObject","newShape","fieldSchema","ZodTuple","shape","shapeKeys","extraKeys","keyValidator","unknownKeys","catchall","defaultError","augmentation","merging","mask","newField","createZodEnum","handleResults","unionErrors","childCtx","dirty","getDiscriminator","ZodLazy","ZodLiteral","ZodEnum","ZodNativeEnum","ZodDiscriminatedUnion","discriminator","discriminatorValue","optionsMap","discriminatorValues","mergeValues","aType","bType","bKeys","sharedKeys","sharedValue","newArray","itemA","itemB","handleParsed","parsedLeft","parsedRight","merged","left","right","itemIndex","schemas","ZodRecord","keyType","third","ZodMap","finalMap","ZodSet","finalizeSet","elements","parsedSet","minSize","maxSize","size","ZodFunction","makeArgsIssue","makeReturnsIssue","returns","me","parsedArgs","parsedReturns","returnType","func","getter","expectedValues","enumValues","opt","nativeEnumValues","promisified","effect","checkCtx","processed","executeRefinement","inner","preprocess","newCtx","ZodNaN","BRAND","inResult","custom","fatal","_fatal","p2","late","instanceOfType","cls","stringType","numberType","nanType","bigIntType","booleanType","dateType","symbolType","undefinedType","nullType","anyType","unknownType","neverType","voidType","arrayType","objectType","strictObjectType","unionType","discriminatedUnionType","intersectionType","tupleType","recordType","mapType","setType","functionType","lazyType","literalType","enumType","nativeEnumType","promiseType","effectsType","optionalType","nullableType","preprocessType","pipelineType","endpoint","apiClient","apiClientMaker","httpCommunication","useConversations","publicSignKey","isPromise","wrapArray","reduceHelper","reducer","xs","firstIndex","reduce","initial","frameToString","line","column","parseStackLine","stackLine","matches","parseStackTrace","trace","picker","currentLocation","depth","pipeWithoutStack","fs","augmentAndRethrowException","location","augmentError","errorBoundry","pipe","identity","mapWithoutStack","juxt","anyAsync","pairRight","filter","alphabet","rAlphabet","byte","groupByManyReduce","it","destination","onEntries","transformation","hasOwnProperty","stringify","configure","exports","module","strEscapeSequencesRegExp","strEscape","sort","comparator","typedArrayPrototypeGetSymbolToStringTag","isTypedArrayWithEntries","stringifyTypedArray","maximumBreadth","whitespace","getCircularValueOption","circularValue","getDeterministicOption","getBooleanOption","getPositiveIntegerOption","getItemCount","getUniqueReplacerSet","replacerArray","replacerSet","getStrictOption","fail","bigint","deterministic","maximumDepth","stringifyFnReplacer","replacer","spacer","indentation","originalIndentation","maximumValuesToStringify","removedKeys","keyLength","maximumPropertiesToStringify","stringifyArrayReplacer","stringifyIndent","stringifySimple","hasLength","space","cjsModule","base64Js","byteLength","toByteArray","fromByteArray","revLookup","Arr","getLens","b64","validLen","placeHoldersLen","lens","_byteLength","curByte","tripletToBase64","num","encodeChunk","uint8","start","end","output","extraBytes","parts","maxChunkLength","len2","ieee754","buffer","isLE","mLen","nBytes","eLen","eMax","eBias","nBits","rt","base64","require$$0","require$$1","customInspectSymbol","Buffer","SlowBuffer","K_MAX_LENGTH","typedArraySupport","proto","createBuffer","length","encodingOrOffset","allocUnsafe","from","fromString","fromArrayView","isInstance","fromArrayBuffer","valueOf","fromObject","assertSize","alloc","fill","encoding","checked","actual","fromArrayLike","arrayView","byteOffset","numberIsNaN","list","pos","mustMatch","loweredCase","utf8ToBytes","base64ToBytes","slowToString","hexSlice","utf8Slice","asciiSlice","latin1Slice","base64Slice","utf16leSlice","swap","thisStart","thisEnd","thisCopy","targetCopy","bidirectionalIndexOf","dir","arrayIndexOf","indexSize","arrLength","valLength","read","foundIndex","hexWrite","remaining","strLen","utf8Write","blitBuffer","asciiWrite","asciiToBytes","base64Write","ucs2Write","utf16leToBytes","firstByte","codePoint","bytesPerSequence","secondByte","thirdByte","fourthByte","tempCodePoint","decodeCodePointsArray","MAX_ARGUMENTS_LENGTH","codePoints","out","hexSliceLookupTable","newBuf","checkOffset","ext","noAssert","mul","defineBigIntMethod","validateNumber","last","boundsError","lo","hi","checkInt","maxBytes","wrtBigUInt64LE","checkIntBI","wrtBigUInt64BE","checkIEEE754","writeFloat","littleEndian","writeDouble","targetStart","errors","sym","getMessage","Base","range","received","addNumericalSeparator","checkBounds","INVALID_BASE64_RE","base64clean","units","leadSurrogate","byteArray","dst","table","i16","BufferBigIntNotDefined","encryptAlgo","signAlgo","publicKeyFormat","privateKeyFormat","aesAlgo","ivLength","base64ToUint8Array","binary","decryptAsymmetric","privateKey","importKey","usage","importSymmetricKey","encryptAsymmetric","publicKey","encodeKey","format","encodeKeys","generateKeyPair","sign","verify","signature","encryptSymmetric","iv","cryptoKey","encoded","ciphertext","combined","decryptSymmetric","raw","decrypted","generateSymmetricKey","instantAppId","msgToStr","sendMessage","conversationKey","conversation","privateSignKey","encryptedMessage","decryptMessage","conversationSymmetricKey","dbMsg","createConversation","publicSignKeys","conversationTitle","identities","signKeyToEncrypionKey","publicEncryptKey","symmetricKey","publicSignKeyToEncryptedSymmetricKey","createIdentity","signKey","encryptKey","isDarkMode","chatContainerStyle","messageContainerStyle","loadingStyle","stringToColor","lightness","isLightColor","hsl","match","bubbleStyle","bubbleColor","textColor","isOwn","showAvatar","align","Message","authorId","authorName","authorAvatar","text","timestamp","next","isFirstOfSequence","jsxs","jsx","CloseButton","onClose","dark","baseBg","hoverBg","color","AbstractChatBox","loadMore","userId","onSend","messages","fetchingMore","setFetchingMore","messagesEndRef","setInput","inputRef","messagesContainerRef","handleScroll","msgToUIMessage","details","useDecryptedMessages","conversationId","setMessages","encryptedMessages","sorted","identitiesData","Chat","credentials","convoKey","useConversationKey","setLimit","useQuery","privateEncryptKey","setKey","isLoading","accessDb","useConversationsNoDb","ChatNoDb","createConversationNoDb","useGetOrCreateConversation","creds","otherSide","setConversation","conversations","existingConversation","participants","useCredentials","setCredentials","existingCredentials","newCredentials","InternalWidget","dialTo","chatOpen","setChatOpen","setName","userName","Widget","elementId","loadChatWidget","dialingTo","div","render"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62]}